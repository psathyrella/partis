[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results-slow/test/parameters/data --n-max-queries -1 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/324854/meta.yaml
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/324854 --input-metafname /tmp/dralph/hmms/324854/meta.yaml
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/324854/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   49 / 100 v annotations (51 failed) with 28 v genes in 0.1 sec
    igk:   40 / 100 v annotations (60 failed) with 18 v genes in 0.1 sec
    igl:   15 / 100 v annotations (85 failed) with 12 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/324854/
  igh: 48 to 324854/igh.fa
  igk: 37 to 324854/igk.fa
  igl: 15 to 324854/igl.fa
writing to paired subdirs
    igh+igk:
      igh: 36 / 48 to igh+igk/igh.fa
      igk: 35 / 37 to igh+igk/igk.fa
    igh+igl:
      igh: 15 / 48 to igh+igl/igh.fa
      igl: 15 / 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/324854/igh.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/324854/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/324854/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 27 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/sw (2.3 sec)
    water time: 2.6  (ig-sw 2.5  processing 0.1)
  writing hmms     removed 13 genes from glfo (leaving v 23  d 19  j 6)
(0.2 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/hmm (2.3 sec)
         infra time: 2.4
      hmm step time: 2.8
  writing hmms     removed 1  genes from glfo (leaving v 23  d 18  j 6)
(0.2 sec)
      total time: 6.4
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/324854/igk.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/324854/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/324854/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/sw (1.6 sec)
    water time: 1.8  (ig-sw 1.7  processing 0.1)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 1.9
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 4.4
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/324854/igl.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/324854/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/324854/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/sw (1.0 sec)
    water time: 1.2  (ig-sw 1.1  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/hmm (1.0 sec)
         infra time: 1.0
      hmm step time: 1.2
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
      total time: 3.0
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/324854/: failed.fa
      total time: 16.8
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/test/simu --indel-frequency 0.2
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu
    cleaning paired files in test/paired/new-results-slow/test/simu/
[94migh+igk[0m: simulating 134 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 134 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igk/trees
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 134 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 134 trees:   depth 0.02436   leaves 5.16
    writing trees to test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
      total time: 1.8
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igk/igh
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-0/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-0.nwk
    made 13 events with 63 seqs in 2.8s (2.4s of which was running bppseqgen)
      total time: 2.9

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-1/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-1.nwk
    made 13 events with 54 seqs in 2.4s (2.0s of which was running bppseqgen)
      total time: 2.4

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-2/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-2.nwk
    made 13 events with 67 seqs in 2.6s (2.2s of which was running bppseqgen)
      total time: 2.6

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-3/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-3.nwk
    made 13 events with 51 seqs in 2.7s (2.1s of which was running bppseqgen)
      total time: 2.7

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-4/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-4.nwk
    made 13 events with 74 seqs in 2.5s (2.1s of which was running bppseqgen)
      total time: 2.5

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-5/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-5.nwk
    made 13 events with 41 seqs in 2.5s (2.0s of which was running bppseqgen)
      total time: 2.5

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-6/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-6.nwk
    made 13 events with 94 seqs in 3.1s (2.7s of which was running bppseqgen)
      total time: 3.1

      --> proc 7
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-7/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-7.nwk
    made 13 events with 56 seqs in 2.7s (2.1s of which was running bppseqgen)
      total time: 2.8

      --> proc 8
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-8/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/512040/trees-sub-8.nwk
    made 13 events with 79 seqs in 3.1s (2.6s of which was running bppseqgen)
      total time: 3.1

      --> proc 9
  note: set tree inference outdir to /tmp/dralph/hmms/512040/sub-9/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/512040/trees-sub-9.nwk
    made 17 events with 112 seqs in 3.8s (3.3s of which was running bppseqgen)
      total time: 3.9

   read 134 events with 691 seqs from 10 .yaml files
      total time: 5.2
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2077655082 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igk/igk
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-0/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-0.nwk
    made 13 events with 63 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.5

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-1/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-1.nwk
    made 13 events with 54 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.2

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-2/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-2.nwk
    made 13 events with 67 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.4

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-3/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-3.nwk
    made 13 events with 51 seqs in 2.3s (1.9s of which was running bppseqgen)
      total time: 2.3

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-4/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-4.nwk
    made 13 events with 74 seqs in 2.2s (1.8s of which was running bppseqgen)
      total time: 2.2

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-5/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-5.nwk
    made 13 events with 41 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.3

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-6/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-6.nwk
    made 13 events with 94 seqs in 2.5s (2.2s of which was running bppseqgen)
      total time: 2.5

      --> proc 7
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-7/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-7.nwk
    made 13 events with 56 seqs in 2.0s (1.7s of which was running bppseqgen)
      total time: 2.1

      --> proc 8
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-8/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/18905/trees-sub-8.nwk
    made 13 events with 79 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.4

      --> proc 9
  note: set tree inference outdir to /tmp/dralph/hmms/18905/sub-9/igk
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/18905/trees-sub-9.nwk
    made 17 events with 112 seqs in 3.3s (2.9s of which was running bppseqgen)
      total time: 3.3

   read 134 events with 691 seqs from 10 .yaml files
      total time: 4.6
[94migh+igl[0m: simulating 66 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 66 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igl/trees
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 66 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 66 trees:   depth 0.02617   leaves 4.85
    writing trees to test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
      total time: 1.6
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igl/igh
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-0/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-0.nwk
    made 6 events with 35 seqs in 1.3s (1.2s of which was running bppseqgen)
      total time: 1.4

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-1/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-1.nwk
    made 6 events with 31 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.1

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-2/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-2.nwk
    made 6 events with 39 seqs in 1.4s (1.3s of which was running bppseqgen)
      total time: 1.5

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-3/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-3.nwk
    made 6 events with 16 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.1

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-4/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-4.nwk
    made 6 events with 28 seqs in 1.3s (1.0s of which was running bppseqgen)
      total time: 1.3

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-5/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-5.nwk
    made 6 events with 28 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.3

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-6/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-6.nwk
    made 6 events with 25 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.1

      --> proc 7
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-7/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-7.nwk
    made 6 events with 26 seqs in 1.2s (0.9s of which was running bppseqgen)
      total time: 1.2

      --> proc 8
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-8/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/703409/trees-sub-8.nwk
    made 6 events with 52 seqs in 1.6s (1.4s of which was running bppseqgen)
      total time: 1.6

      --> proc 9
  note: set tree inference outdir to /tmp/dralph/hmms/703409/sub-9/igh
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/703409/trees-sub-9.nwk
    made 12 events with 40 seqs in 2.3s (1.9s of which was running bppseqgen)
      total time: 2.3

   read 66 events with 320 seqs from 10 .yaml files
      total time: 3.7
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1083609742 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/test/simu/igh+igl/igl
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-0/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-0.nwk
    made 6 events with 35 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.1

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-1/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-1.nwk
    made 6 events with 31 seqs in 0.9s (0.8s of which was running bppseqgen)
      total time: 1.0

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-2/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-2.nwk
    made 6 events with 39 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.2

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-3/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-3.nwk
    made 6 events with 16 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.0

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-4/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-4.nwk
    made 6 events with 28 seqs in 0.9s (0.8s of which was running bppseqgen)
      total time: 0.9

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-5/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-5.nwk
    made 6 events with 28 seqs in 0.9s (0.8s of which was running bppseqgen)
      total time: 1.0

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-6/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-6.nwk
    made 6 events with 25 seqs in 1.0s (0.8s of which was running bppseqgen)
      total time: 1.0

      --> proc 7
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-7/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-7.nwk
    made 6 events with 26 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.1

      --> proc 8
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-8/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/721312/trees-sub-8.nwk
    made 6 events with 52 seqs in 1.3s (1.2s of which was running bppseqgen)
      total time: 1.3

      --> proc 9
  note: set tree inference outdir to /tmp/dralph/hmms/721312/sub-9/igl
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/721312/trees-sub-9.nwk
    made 12 events with 40 seqs in 1.8s (1.6s of which was running bppseqgen)
      total time: 1.9

   read 66 events with 320 seqs from 10 .yaml files
      total time: 3.3
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igl/
  concatenating heavy chain loci:
      [94mh[0m added 66 annotations (320 seqs) for total 134 (691)
    finished with:
     [94mh[0m: 200 annotations (6800 seqs)
  apportioned 2022 seqs among 808 droplets (mean/2 1.3): 2 4 2 4 2 2 4 2 4 2 2 4 4 4 2 2 4 4 4 2 2 2 2 2 4 4 4 2 2 2 2 4 2 2 4 4 2 4 4 2 4 2 2 2 2 2 4 2 2 2 2 2 2 2 4 4 2 2 2 4 4 2 2 2 2 4 4 4 2 4 4 2 2 2 2 2 4 2 4 2 2 4 2 2 2 2 2 4 4 2 2 4 2 2 2 2 2 4 2 4 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 4 2 2 2 2 2 2 2 2 2 4 4 4 2 2 2 2 2 2 2 4 2 2 4 2 4 2 2 2 2 4 4 4 2 2 2 4 2 2 4 2 2 2 4 2 4 2 4 2 4 2 2 4 2 2 2 2 2 2 4 2 2 2 2 4 4 4 2 2 2 4 2 4 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 4 2 4 4 2 2 2 2 4 2 4 2 2 2 2 4 2 2 4 2 4 2 2 2 4 2 2 2 2 2 2 4 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 4 4 4 4 4 2 2 4 2 2 4 2 2 2 4 2 2 2 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 4 2 4 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 4 2 4 2 2 2 4 2 2 2 4 2 2 4 2 4 2 4 2 2 2 2 2 2 4 2 2 4 4 2 4 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 4 4 2 2 4 4 2 4 2 2 2 2 4 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 4 2 2 2 2 2 4 2 2 2 2 2 4 4 2 2 2 4 2 2 2 2 2 2 2 2 2 4 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 4 4 2 2 4 2 2 2 2 2 2 4 4 2 2 2 2 2 4 4 4 2 4 2 2 4 2 2 2 4 2 2 2 4 2 2 2 4 4 2 4 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 4 2 2 2 2 2 2 2 4 2 4 4 4 2 2 4 2 2 4 2 2 2 4 4 2 2 2 2 2 2 2 2 2 4 2 4 2 4 2 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 4 2 4 4 2 2 2 2 2 2 2 2 4 2 2 4 2 2 2 2 2 2 2 2 2 2 4 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 2 4 2 4 2 4 2 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 4 2 2 2 2 4 2 2 2 2 2 2 4 2 4 4 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 4 2 2 2
  removed 303 / 2022 = 0.15 seqs from outfos (leaving 161 / 1719 unpaired)
    writing combined h/l info to fasta and meta files in test/paired/new-results-slow/test/simu
      total time: 26.5
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 864 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 864 / 864 v annotations (0 failed) with 32 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 864 / 864 v annotations (0 failed) with 23 v genes in 0.2 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 864 seqs
    running 11 procs for 20 seqs
      info for 864 / 864 = 1.000   (removed: 0 failed)
      kept 254 (0.294) unproductive
    water time: 1.2  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 864 / 864 v annotations (0 failed) with 23 v genes in 0.2 sec
    running 10 procs for 864 seqs
    running 11 procs for 20 seqs
      info for 864 / 864 = 1.000   (removed: 0 failed)
      kept 254 (0.294) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/sw (2.2 sec)
    water time: 3.9  (ig-sw 2.6  processing 0.2)
  writing hmms     removed 3  genes from glfo (leaving v 23  d 29  j 6)
(0.2 sec)
hmm
    reading output
        read 864 hmm output lines with 864 sequences in 864 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/hmm (2.1 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/true (2.1 sec)
         infra time: 5.3
      hmm step time: 7.0
  writing hmms     removed 5  genes from glfo (leaving v 23  d 24  j 6)
(0.2 sec)
      total time: 13.7
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 586 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 586 / 586 v annotations (0 failed) with 18 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.2 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 586 seqs
    running 12 procs for 18 seqs
      info for 585 / 586 = 0.998   (removed: 1 failed)
      kept 110 (0.188) unproductive
    water time: 0.7  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.2 sec
    running 10 procs for 585 seqs
    running 12 procs for 17 seqs
      info for 585 / 586 = 0.998   (removed: 1 failed)
      kept 110 (0.188) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/sw (1.5 sec)
    water time: 2.5  (ig-sw 1.8  processing 0.2)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 585 hmm output lines with 583 sequences in 583 events  (2 failures)
          [91mwarning[0m no valid paths: 7307ea6392-igk 81925c05ab-igk
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/hmm (1.4 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/true (1.5 sec)
         infra time: 3.9
      hmm step time: 4.8
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 9.1
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 269 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 269 / 269 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    running 10 procs for 269 seqs
    running 11 procs for 6 seqs
      info for 269 / 269 = 1.000   (removed: 0 failed)
      kept 85 (0.316) unproductive
    water time: 0.4  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 269 seqs
    running 11 procs for 6 seqs
      info for 269 / 269 = 1.000   (removed: 0 failed)
      kept 85 (0.316) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/sw (0.9 sec)
    water time: 1.4  (ig-sw 1.1  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.2 sec)
hmm
    reading output
        read 269 hmm output lines with 269 sequences in 269 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/hmm (0.9 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/true (0.9 sec)
         infra time: 2.2
      hmm step time: 2.8
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.2 sec)
      total time: 5.5
      total time: 30.5
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igh.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/single-chain/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 864 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 864 / 864 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 864 / 864 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 254 (0.294) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: db63559ea9-igh d81bd3655b-igh f6b26be73e-igh 1e3be4feb9-igh bc0e4d7a98-igh ac93dacab5-igh 8a8accb2dc-igh 0eeba122c1-igh 5818dcdbbb-igh 0e548085bb-igh 91676ac70f-igh d4aca00bb8-igh a3bb3ca569-igh e584ac1505-igh a4e1836067-igh 838ccffbce-igh 207c08bd32-igh a536c77952-igh 35ca9d2511-igh 9e15f0b796-igh 55ee088bc2-igh 35ff731a60-igh 01cc8ef8c2-igh 44d27aca77-igh ea35eb897b-igh 95990d823f-igh bd308dd7bf-igh dd88da13cb-igh 0baf317e46-igh aba7da7343-igh 627425bdbe-igh
(0.0 sec)
        water time: 0.6
hmm
  caching all 864 naive sequences (1.7s)
    collapsed 864 queries into 360 clusters with identical naive seqs (0.0 sec)
  360 clusters with 10 procs (1.8s)
   311 clusters with 7 procs (1.6s)
   281 clusters with 5 procs (1.8s)
   245 clusters with 3 procs (2.2s)
   225 clusters with 2 procs (2.7s)
   203 clusters with 2 procs (2.2s)
   188 clusters with 2 procs (1.4s)
   182 clusters with 1 proc (2.5s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 16.2
getting annotations for final partition
  subcluster annotating 179 clusters with steps:  (1.6s) (0.8s) (0.3s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: ea35eb897b-igh 207c08bd32-igh dd88da13cb-igh 01cc8ef8c2-igh 0baf317e46-igh 0e548085bb-igh 0eeba122c1-igh 1e3be4feb9-igh 35ca9d2511-igh 35ff731a60-igh 44d27aca77-igh 55ee088bc2-igh 5818dcdbbb-igh 627425bdbe-igh 838ccffbce-igh 8a8accb2dc-igh 91676ac70f-igh 95990d823f-igh 9e15f0b796-igh a3bb3ca569-igh a4e1836067-igh a536c77952-igh aba7da7343-igh ac93dacab5-igh bc0e4d7a98-igh bd308dd7bf-igh d4aca00bb8-igh d81bd3655b-igh db63559ea9-igh e584ac1505-igh f6b26be73e-igh
(0.0 sec)

    subcluster annotation time 3.6
      total time: 22.7
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igk.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/single-chain/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 586 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 585 / 586 = 0.998   (removed: 1 failed, 0 duplicates [removed when cache file was written])
      kept 110 (0.188) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 17 queries with different true and inferred net shm indel lengths: c738e72450-igk 44b03dcfc3-igk 2464510a36-igk c772a368e2-igk 49b98d803a-igk 65a28e40fb-igk 9c5f4ab5e1-igk e82c2853d6-igk 85430008df-igk c47eea84c4-igk 41548f26c9-igk 81925c05ab-igk 7a02cad1e8-igk 7307ea6392-igk a536c77952-igk 3d19bd28fd-igk da0b397897-igk
(0.0 sec)
        water time: 0.4
hmm
  caching all 585 naive sequences (1.0s)
     [93mwarning:[0m missing 2/585 queries from hmm cache file (using sw naive sequence instead): 7307ea6392-igk 81925c05ab-igk
   collapsed 585 queries into 57 clusters with identical naive seqs (0.0 sec)
  57 clusters with 10 procs (0.5s)
   53 clusters with 7 procs (0.3s)
   52 clusters with 5 procs (0.3s)
   50 clusters with 3 procs (0.4s)
   47 clusters with 2 procs (0.4s)
   44 clusters with 1 proc (0.9s)
   [93mnote[0m not merging entire cpath history
  [93mwarning[0m all 11 partitions in cluster path have log prob -inf, so setting last (best) to zero
      partition loop time: 2.9
getting annotations for final partition
  subcluster annotating 43 clusters with steps:            [91mwarning[0m no valid paths: 7307ea6392-igk 81925c05ab-igk
(1.1s)     missing 2 annotations
      removing missing cluster from clusters_still_to_do: 7307ea6392-igk
      removing missing cluster from clusters_still_to_do: 81925c05ab-igk
(0.5s) (0.3s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 15 queries with different true and inferred net shm indel lengths: 2464510a36-igk 7a02cad1e8-igk e82c2853d6-igk c772a368e2-igk 49b98d803a-igk 44b03dcfc3-igk 3d19bd28fd-igk 41548f26c9-igk 65a28e40fb-igk 85430008df-igk 9c5f4ab5e1-igk a536c77952-igk c47eea84c4-igk c738e72450-igk da0b397897-igk
(0.0 sec)

    subcluster annotation time 2.6
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
    [93mwarning[0m added 1 / 586 missing ids as singletons to inferred partition, to match ids in true partition
      total time: 7.1
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igl.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/single-chain/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 269 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 269 / 269 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 85 (0.316) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 10 queries with different true and inferred net shm indel lengths: a51f8fd065-igl 071c033964-igl f877c11c70-igl 24874450e7-igl e8ba97562f-igl 1936ca7664-igl 18003d0839-igl 6d4a8668f0-igl 9e8f0f5941-igl 219799f5d8-igl
(0.0 sec)
        water time: 0.2
hmm
  caching all 269 naive sequences (0.6s)
    collapsed 269 queries into 32 clusters with identical naive seqs (0.0 sec)
  32 clusters with 10 procs (0.3s)
   32 clusters with 7 procs (0.2s)
   28 clusters with 5 procs (0.3s)
   25 clusters with 3 procs (0.2s)
   24 clusters with 2 procs (0.2s)
   20 clusters with 1 proc (0.6s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 1.9
getting annotations for final partition
  subcluster annotating 18 clusters with steps:  (0.7s) (0.3s) (0.2s) (0.1s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 10 queries with different true and inferred net shm indel lengths: a51f8fd065-igl 24874450e7-igl 9e8f0f5941-igl 071c033964-igl 18003d0839-igl 1936ca7664-igl 219799f5d8-igl 6d4a8668f0-igl e8ba97562f-igl f877c11c70-igl
(0.0 sec)

    subcluster annotation time 1.5
      total time: 4.5
[44mcombining[0m chains
      removed 2 failed queries when reading partition: 7307ea6392-igk 81925c05ab-igk
cleaning pair info for 1716 seqs
   3/1716 (0.00) missing uids when cleaning pair info
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 14 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 190 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 98  [95mk[0m 92
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 42 total unpaired (in families with no (well-)paired seqs): [94mh[0m 42  [95mk[0m 0
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m  125 --> 163  [91m+38[0m
        [95mk[0m   41 --> 163  [91m+122[0m
    re-added unpaired seqs ([94mh[0m 98, [95mk[0m 92) to give total seqs in joint partitions: [94mh[0m 589  [95mk[0m 583
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0          98
       [95mk[0m            0           0          92
    [93mwarning[0m removed 26/581 uids (leaving 555) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 16 / 589 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 18 / 589 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.757  0.916
       joint   0.935  0.892
    [93mwarning[0m removed 3/586 uids (leaving 583) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 3/586 uids (leaving 583) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.349  0.974
       joint   0.870  0.773
  merge time 0.1
  need to get annotations for 102/163 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 589 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 589 sequences in 163 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 589 / 589 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 589 / 589 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 173 (0.294) unproductive
        water time: 0.2
hmm
  subcluster annotating 163 clusters with steps:  (1.3s) (0.6s) (0.2s) 
    subcluster annotation time 2.2
      total time: 2.6
  need to get annotations for 151/163 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 583 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 583 sequences in 163 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 583 / 583 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 583 / 583 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 108 (0.185) unproductive
        water time: 0.1
hmm
  [93mwarning[0m split apart 1 cluster that contained multiple cdr3 lengths (total clusters: 163 --> 164)
      cluster splits:   3 --> 2 1
  subcluster annotating 164 clusters with steps:  (1.1s) (0.5s) (0.2s) 
    subcluster annotation time 1.9
      total time: 2.3
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 96 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 61  [92ml[0m 35
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 80 total unpaired (in families with no (well-)paired seqs): [94mh[0m 79  [92ml[0m 1
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   61 --> 80   [91m+19[0m
        [92ml[0m   17 --> 80   [91m+63[0m
    re-added unpaired seqs ([94mh[0m 61, [92ml[0m 35) to give total seqs in joint partitions: [94mh[0m 294  [92ml[0m 268
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0          61
       [92ml[0m            0           0          35
    [93mwarning[0m removed 28/283 uids (leaving 255) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 27 / 294 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 12 / 294 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.757  0.916
       joint   0.854  0.889
    [93mwarning[0m removed 1/269 uids (leaving 268) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [92ml[0m ccfs:     purity  completeness
      single   0.253  0.960
       joint   0.865  0.791
  merge time 0.0
  need to get annotations for 55/80 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 294 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 294 sequences in 80 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 294 / 294 v annotations (0 failed) with 18 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 294 / 294 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 86 (0.293) unproductive
        water time: 0.1
hmm
  subcluster annotating 80 clusters with steps:  (0.8s) (0.5s) (0.2s) 
    subcluster annotation time 1.6
      total time: 1.8
  need to get annotations for 73/80 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 268 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml: loci paired-uids
  --input-partition-fname: read best partition with 268 sequences in 80 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 268 / 268 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 268 / 268 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 84 (0.313) unproductive
        water time: 0.1
hmm
  [93mwarning[0m split apart 3 clusters that contained multiple cdr3 lengths (total clusters: 80 --> 83)
      cluster splits:   3 --> 2 1,   2 --> 1 1,   3 --> 2 1
  subcluster annotating 83 clusters with steps:  (0.7s) (0.3s) (0.1s) 
    subcluster annotation time 1.1
      total time: 1.3
/home/dralph/work/partis/python/plotting.py:1378: MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. In future versions, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = copy.copy(mpl.cm.get_cmap("viridis"))
  cmap.set_under('w')
  concatenating heavy chain loci:
      [94mh[0m added 80 annotations (294 seqs) for total 163 (589)
    finished with:
     [94mh[0m: 243 annotations (9231 seqs)
    [93mwarning[0m added 19 / 864 missing ids as singletons to inferred partition, to match ids in true partition
   N clusters with all seqs:
        [94mh[0m  179 --> 243  [91m+64[0m
        [95mk[0m   41 --> 163  [91m+122[0m
        [92ml[0m   18 --> 80   [91m+62[0m
      total time: 50.3
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id b1db196920-igh:b1db196920-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/seed-partition-new-simu
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m      864      491       348    16       17      26   0.030    [91m2[0m
             [95mk[0m      585      212       348    16       15      24   0.041    [91m2[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      26      26     52    0.060
             [95mk[0m      24       9     33    0.056
             [92ml[0m       0      21     21    0.078
      taken 50, paired with taken 56 (total 106)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 11 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 22 (0.423) unproductive
        water time: 0.0
hmm
  caching all 52 naive sequences (0.4s)
    collapsed 52 queries into 30 clusters with identical naive seqs (0.0 sec)
  30 clusters with 10 procs (0.3s)
   28 clusters with 7 procs (0.3s)
   28 clusters with 5 procs (0.3s)
   27 clusters with 3 procs (0.5s)
   26 clusters with 2 procs (0.3s)
   24 clusters with 1 proc (0.8s)
       partition loop time: 2.6
getting annotations for final partition
  subcluster annotating 23 clusters with steps:  (0.4s) (0.2s) (0.1s) 
    subcluster annotation time 0.6
      total time: 3.7
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 33 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 33 / 33 v annotations (0 failed) with 6 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 33 / 33 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 4 (0.121) unproductive
        water time: 0.0
hmm
  caching all 33 naive sequences (0.2s)
    collapsed 33 queries into 9 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 9
  9 clusters with 9 procs (0.2s)
   9 clusters with 6 procs (0.2s)
   9 clusters with 4 procs (0.2s)
   8 clusters with 3 procs (0.2s)
   7 clusters with 2 procs (0.1s)
   7 clusters with 1 proc (0.3s)
       partition loop time: 1.0
getting annotations for final partition
  subcluster annotating 7 clusters with steps:  (0.2s) (0.1s) (0.1s) 
    subcluster annotation time 0.4
      total time: 1.8
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 3 (0.143) unproductive
        water time: 0.0
hmm
  caching all 21 naive sequences (0.2s)
    collapsed 21 queries into 5 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 5
  5 clusters with 5 procs (0.1s)
   5 clusters with 3 procs (0.1s)
   5 clusters with 2 procs (0.2s)
   5 clusters with 1 proc (0.3s)
       partition loop time: 0.7
getting annotations for final partition
  subcluster annotating 5 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 1.3
[44mcombining[0m chains
cleaning pair info for 106 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 2 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [95mk[0m 1
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 7 total unpaired (in families with no (well-)paired seqs): [94mh[0m 6  [95mk[0m 1
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    9 --> 11   [91m+2[0m
        [95mk[0m    6 --> 11   [91m+5[0m
    re-added unpaired seqs ([94mh[0m 1, [95mk[0m 1) to give total seqs in joint partitions: [94mh[0m 32  [95mk[0m 32
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [95mk[0m            0           0           1
    [93mwarning[0m removed 812/864 uids (leaving 52) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 556/581 uids (leaving 25) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 1 / 32 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 6 / 32 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.933  1.000
       joint   1.000  1.000
    [93mwarning[0m removed 553/586 uids (leaving 33) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 554/586 uids (leaving 32) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.625  1.000
       joint   1.000  0.933
  merge time 0.0
     removed 10 unseeded clusters (of 11 total, leaving 1) from igh joint partition
  need to get annotations for 1/1 joint igh clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id b1db196920-igh:b1db196920-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 2 (0.143) unproductive
        water time: 0.1
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) (0.1s) 
    subcluster annotation time 0.4
      total time: 0.5
     removed 10 unseeded clusters (of 11 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id b1db196920-igh:b1db196920-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (0.071) unproductive
        water time: 0.0
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.4
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 8 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [92ml[0m 7
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 6 total unpaired (in families with no (well-)paired seqs): [94mh[0m 6  [92ml[0m 0
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   10 --> 10  
        [92ml[0m    5 --> 10   [91m+5[0m
    re-added unpaired seqs ([94mh[0m 1, [92ml[0m 7) to give total seqs in joint partitions: [94mh[0m 15  [92ml[0m 21
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [92ml[0m            0           0           7
  merge time 0.0
     removed 10 unseeded clusters (of 10 total, leaving 0) from igh joint partition
     removed 10 unseeded clusters (of 10 total, leaving 0) from igl joint partition
  concatenating heavy chain loci:
    finished with:
     [94mh[0m: 1 annotations (37 seqs)
   N clusters with all seqs:
        [94mh[0m   23 --> 1    [91m-22[0m
        [95mk[0m    7 --> 1    [91m-6[0m
      total time: 12.1
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 11 clusters with sizes 19 18 13 12 11 11 11 10 10 10 10
      skipped 152 smaller than 10 (controlled by --min-selection-metric-cluster-size)
    getting trees for 11 clusters with sizes: 19 18 13 12 11 11 11 10 10 10 10
      starting 11 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-2/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-3/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-4/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-4/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-5/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-5/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-6/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-6/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-7/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-7/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-8/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-8/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-9/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-9/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-10/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-10/input-seqs.fa
      made 11 fasttree trees (0.6s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 11 ran fasttree
      setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 7/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: cik ivy mpy
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 2/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: hix
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 2/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: den
                [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 2/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.014  mfreq 0.012  diff 0.002  abs(frac diff) 18%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
          10 with highest+lowest ratios:
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 11/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: aop atv gpx kxz pwz
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 2/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dqs
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.8
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 10 clusters with sizes 20 19 17 15 12 12 11 11 10 10
      skipped 154 smaller than 10 (controlled by --min-selection-metric-cluster-size)
    getting trees for 10 clusters with sizes: 20 19 17 15 12 12 11 11 10 10
      starting 10 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-2/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-3/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-4/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-4/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-5/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-5/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-6/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-6/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-7/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-7/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-8/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-8/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-9/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-9/input-seqs.fa
      made 10 fasttree trees (0.6s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 10 ran fasttree
      setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0029
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0029
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
                [94miclust 4: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 9/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.004  mfreq 0.003  diff 0.001  abs(frac diff) 35%  ratio 1.3
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0043    0.0031       1.4     0.0011     0d7575234a-igk
              0.0043    0.0031       1.4     0.0011     021cc021e5-igk
              0.0043    0.0031       1.4     0.0011     84daff550c-igk
              0.0042    0.0031       1.4     0.0011     6aaf9f116a-igk
              0.0042    0.0031       1.4     0.0011     b7acf21689-igk
              0.0042    0.0031       1.4     0.0011     df22339d53-igk
              0.0042    0.0031       1.4     0.0011     1de385032c-igk
              0.0042    0.0031       1.4     0.0011     67694388de-igk
              0.0042    0.0031       1.4     0.0011     fb5177cbe1-igk
          10 with highest+lowest ratios:
              0.0043    0.0031       1.4     0.0011     0d7575234a-igk
              0.0043    0.0031       1.4     0.0011     021cc021e5-igk
              0.0043    0.0031       1.4     0.0011     84daff550c-igk
              0.0042    0.0031       1.4     0.0011     6aaf9f116a-igk
              0.0042    0.0031       1.4     0.0011     b7acf21689-igk
              0.0042    0.0031       1.4     0.0011     b7acf21689-igk
              0.0042    0.0031       1.4     0.0011     df22339d53-igk
              0.0042    0.0031       1.4     0.0011     1de385032c-igk
              0.0042    0.0031       1.4     0.0011     67694388de-igk
              0.0042    0.0031       1.4     0.0011     fb5177cbe1-igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 7/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bcr itz nsu
                [94miclust 7: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.078  mfreq 0.047  diff 0.031  abs(frac diff) 35%  ratio 1.4
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.8459    0.5045       1.7     0.3414     71720a68f7-igk
          10 with highest+lowest ratios:
              0.8459    0.5045       1.7     0.3414     71720a68f7-igk
              0.8459    0.5045       1.7     0.3414     71720a68f7-igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 3/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: den
                [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 6/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.007  mfreq 0.004  diff 0.002  abs(frac diff) 75%  ratio 1.8
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0065    0.0030       2.2     0.0035     14e8eeed84-igk
              0.0065    0.0030       2.2     0.0035     61e0b487e5-igk
              0.0065    0.0030       2.2     0.0035     8e1e4d352b-igk
              0.0065    0.0030       2.2     0.0035     8ed52d6154-igk
              0.0065    0.0030       2.2     0.0035     f445266d7b-igk
              0.0065    0.0030       2.2     0.0035     1871cdbc54-igk
          10 with highest+lowest ratios:
              0.0065    0.0030       2.2     0.0035     14e8eeed84-igk
              0.0065    0.0030       2.2     0.0035     61e0b487e5-igk
              0.0065    0.0030       2.2     0.0035     8e1e4d352b-igk
              0.0065    0.0030       2.2     0.0035     8ed52d6154-igk
              0.0065    0.0030       2.2     0.0035     f445266d7b-igk
              0.0065    0.0030       2.2     0.0035     61e0b487e5-igk
              0.0065    0.0030       2.2     0.0035     8e1e4d352b-igk
              0.0065    0.0030       2.2     0.0035     8ed52d6154-igk
              0.0065    0.0030       2.2     0.0035     f445266d7b-igk
              0.0065    0.0030       2.2     0.0035     1871cdbc54-igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 3/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: atv
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ars bvx dqs hil hux inp lmw msz
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.8
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 16 12 11 11 10
      skipped 75 smaller than 10 (controlled by --min-selection-metric-cluster-size)
    getting trees for 5 clusters with sizes: 16 12 11 11 10
      starting 5 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-2/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-3/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-4/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-4/input-seqs.fa
      made 5 fasttree trees (0.3s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 5 ran fasttree
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
                [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 6/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.112  mfreq 0.090  diff 0.022  abs(frac diff) 25%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.1378    0.1037       1.3     0.0341     a2238f4e9a-igh
              0.1149    0.0878       1.3     0.0272     9ed10b6475-igh
              0.1067    0.0798       1.3     0.0269     aa25e6c0ce-igh
              0.1243    0.0984       1.3     0.0259     d5ddf0c2ec-igh
              0.1071    0.0851       1.3     0.0220     8d79fca804-igh
              0.0944    0.0745       1.3     0.0199     7588f09c07-igh
          10 with highest+lowest ratios:
              0.1067    0.0798       1.3     0.0269     aa25e6c0ce-igh
              0.1378    0.1037       1.3     0.0341     a2238f4e9a-igh
              0.1149    0.0878       1.3     0.0272     9ed10b6475-igh
              0.0944    0.0745       1.3     0.0199     7588f09c07-igh
              0.1243    0.0984       1.3     0.0259     d5ddf0c2ec-igh
              0.1378    0.1037       1.3     0.0341     a2238f4e9a-igh
              0.1149    0.0878       1.3     0.0272     9ed10b6475-igh
              0.0944    0.0745       1.3     0.0199     7588f09c07-igh
              0.1243    0.0984       1.3     0.0259     d5ddf0c2ec-igh
              0.1071    0.0851       1.3     0.0220     8d79fca804-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bez blu bvw cik fpy gno hiq ivy jks mpy
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.4
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 15 14 13 13 10
      skipped 78 smaller than 10 (controlled by --min-selection-metric-cluster-size)
    getting trees for 5 clusters with sizes: 15 14 13 13 10
      starting 5 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-2/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-3/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-4/fasttree.out /home/dralph/work/partis/test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-4/input-seqs.fa
      made 5 fasttree trees (0.3s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 5 ran fasttree
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 20/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: apr bft dhq dij eyz fnv nox svz uvx
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 22/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bez blu bvw cik fpy gno hiq ivy jks lry
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.4
[44mgetting combined h/l selection metrics[0m
    [93mwarning[0m check_concordance_of_cpath_and_annotations(): missing annotations for 1/163 clusters in best partition with size: 3
        2 extra annotations (i.e. they're for clusters not in best partition) with sizes: 2 1
          missing 'best' cluster with size 3 overlaps with the following (overlap/size): 2/2  1/1
          extra annotation with size 2 overlaps with the following best clusters (overlap/size): 2/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/3
      [93mwarning[0m missing annotation for light chain (size 3, paired with size 3) when finding cluster pairs 9e32905b5c-igk:c05a24b10c-igk:cbafc4a334-igk 3cda733e75-igh:c63849ce98-igh:cbafc4a334-igh
    igh+igk: 154 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 154 annotations with N h or l ids < 10 (controlled by --min-paired-cluster-size-to-read) (keeping 8 annotation pairs)
    [93mwarning[0m check_concordance_of_cpath_and_annotations(): missing annotations for 3/80 clusters in best partition with sizes: 3, 3, 2
        6 extra annotations (i.e. they're for clusters not in best partition) with sizes: 2 1 1 1 2 1
          missing 'best' cluster with size 3 overlaps with the following (overlap/size): 2/2  1/1
          missing 'best' cluster with size 2 overlaps with the following (overlap/size): 1/1  1/1
          missing 'best' cluster with size 3 overlaps with the following (overlap/size): 2/2  1/1
          extra annotation with size 2 overlaps with the following best clusters (overlap/size): 2/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 2 overlaps with the following best clusters (overlap/size): 2/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/3
      [93mwarning[0m missing annotation for light chain (size 3, paired with size 5) when finding cluster pairs 90d4aedf32-igl:af23ee196e-igl:0d422c5013-igl 90d4aedf32-igh:af23ee196e-igh:fe20cab695-igh:83d3e14e07-igh:d4a0ff330d-igh
      [93mwarning[0m missing annotation for light chain (size 3, paired with size 4) when finding cluster pairs 14da0288b1-igl:e3e75f4e21-igl:b3402431a8-igl 14da0288b1-igh:8fc745fa98-igh:a8efa7f387-igh:5cfe402b65-igh
      [93mwarning[0m missing annotation for light chain (size 2, paired with size 2) when finding cluster pairs 876cc850ea-igl:c1b6806008-igl 6ecce767df-igh:d3640bf028-igh
    igh+igl: 72 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 72 annotations with N h or l ids < 10 (controlled by --min-paired-cluster-size-to-read) (keeping 5 annotation pairs)
           using observed cons seq
          [93mwarning[0m chose 8 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 54b5b47250-igk 59190a0e56-igk 66a593d241-igh 7f7672816a-igk 92415943d5-igk a78bcbaa64-igk b0fb8c4d8b-igh c84fe529c2-igk
           using observed cons seq
          [93mwarning[0m chose 4 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 1d3b5e99a7-igh 404bd2c1db-igh 6110c1b238-igk ac8201e16b-igh
           using observed cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 6385edc10e-igh 6385edc10e-igk 7be03be402-igh 85b221334a-igk
           using observed cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 35fc655801-igk 6c897f6d54-igk a4197ef4d6-igh
           cons seq not observed
           less than 0.75 (3 / 16 = 0.19) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (2 / 13 = 0.15) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 5 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 0e3b465730-igl 63112ea43c-igh 80580253c2-igh 9709bc5aa6-igl eda479fd55-igh
           using observed cons seq
          [93mwarning[0m chose 5 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 3b42129944-igh 45356d892b-igh 4c638ce0a0-igl bd4dba64ce-igl fd9f69874c-igl
           using observed cons seq
          [93mwarning[0m chose 2 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 3204353335-igh e0a0ffec99-igh e0a0ffec99-igk
           using observed cons seq
          [93mwarning[0m chose 1 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 771472b9c9-igh
           cons seq not observed
           less than 0.75 (3 / 11 = 0.27) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (1 / 13 = 0.08) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: a2238f4e9a-igh b1e56e40a1-igh ddcf0ca433-igl
           using observed cons seq
          [93mwarning[0m chose 2 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: c1ead9832e-igk cfe3b29587-igh cfe3b29587-igk
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 10 clusters with sizes 15 12 12 11 11 11 11 10 10 10
      skipped 3 smaller than 10 (controlled by --min-selection-metric-cluster-size)
    getting trees for 10 clusters with sizes: 15 12 12 11 11 11 11 10 10 10
      starting 10 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-0/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-1/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-2/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-3/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-4/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-4/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-5/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-5/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-6/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-6/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-7/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-7/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-8/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-8/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-9/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-9/input-seqs.fa
      made 10 fasttree trees (0.6s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 10 ran fasttree
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
                [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 4/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.010  mfreq 0.008  diff 0.002  abs(frac diff) 23%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0110    0.0084       1.3     0.0026     0073304adc_contig_igh+igl
              0.0071    0.0056       1.3     0.0015     0e3b465730_contig_igh+igl
              0.0056    0.0042       1.3     0.0014     7f7af1e5d9_contig_igh+igl
              0.0036    0.0028       1.3     0.0007     ce237bd415_contig_igh+igl
          10 with highest+lowest ratios:
              0.0056    0.0042       1.3     0.0014     7f7af1e5d9_contig_igh+igl
              0.0110    0.0084       1.3     0.0026     0073304adc_contig_igh+igl
              0.0036    0.0028       1.3     0.0007     ce237bd415_contig_igh+igl
              0.0071    0.0056       1.3     0.0015     0e3b465730_contig_igh+igl
              0.0071    0.0056       1.3     0.0015     0e3b465730_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 20/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ajy apr bft dhq dij eyz nox svz twx
                [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 10/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.036  mfreq 0.028  diff 0.008  abs(frac diff) 36%  ratio 1.4
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.3370    0.2596       1.3     0.0774     71720a68f7_contig_igh+igk
              0.0056    0.0043       1.3     0.0013     4ef071ea7c-igh+dcc6a48450-igk
              0.0020    0.0014       1.4     0.0006     577773b57d_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7230f7a64a_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7d4166ae48_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     b374f7dd77_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     c1ead9832e_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     cfe3b29587_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     dc78cbb7af_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     f7eddbba3a_contig_igh+igk
          10 with highest+lowest ratios:
              0.0020    0.0014       1.4     0.0006     577773b57d_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7230f7a64a_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7d4166ae48_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     b374f7dd77_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     c1ead9832e_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     cfe3b29587_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     dc78cbb7af_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     f7eddbba3a_contig_igh+igk
              0.0056    0.0043       1.3     0.0013     4ef071ea7c-igh+dcc6a48450-igk
              0.3370    0.2596       1.3     0.0774     71720a68f7_contig_igh+igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 7/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bny ckv hmy
                [94miclust 6: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 9/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.002  mfreq 0.001  diff 0.001  abs(frac diff) 80%  ratio 1.8
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0040    0.0028       1.4     0.0012     657c6a602d_contig_igh+igk
              0.0026    0.0014       1.9     0.0012     6aaf9f116a_contig_igh+igk
              0.0026    0.0014       1.9     0.0012     b7acf21689_contig_igh+igk
              0.0026    0.0014       1.9     0.0012     df22339d53_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     84daff550c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     1de385032c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     67694388de_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     fb5177cbe1_contig_igh+igk
          10 with highest+lowest ratios:
              0.0026    0.0014       1.9     0.0012     6aaf9f116a_contig_igh+igk
              0.0026    0.0014       1.9     0.0012     b7acf21689_contig_igh+igk
              0.0026    0.0014       1.9     0.0012     df22339d53_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     84daff550c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     1de385032c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     67694388de_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     fb5177cbe1_contig_igh+igk
              0.0040    0.0028       1.4     0.0012     657c6a602d_contig_igh+igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 7/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: agt cku hix
                [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 4/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.072  mfreq 0.058  diff 0.013  abs(frac diff) 23%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0816    0.0636       1.3     0.0180     a2238f4e9a_contig_igh+igl
              0.0780    0.0622       1.3     0.0158     d5ddf0c2ec_contig_igh+igl
              0.0707    0.0553       1.3     0.0154     aa25e6c0ce_contig_igh+igl
              0.0702    0.0553       1.3     0.0149     9ed10b6475_contig_igh+igl
          10 with highest+lowest ratios:
              0.0816    0.0636       1.3     0.0180     a2238f4e9a_contig_igh+igl
              0.0707    0.0553       1.3     0.0154     aa25e6c0ce_contig_igh+igl
              0.0702    0.0553       1.3     0.0149     9ed10b6475_contig_igh+igl
              0.0780    0.0622       1.3     0.0158     d5ddf0c2ec_contig_igh+igl
              0.0780    0.0622       1.3     0.0158     d5ddf0c2ec_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: aft aop atv gpx hks kxz lor ouz pwz
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/selection-metrics.yaml
      writing 52 chosen abs to test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 6.6
