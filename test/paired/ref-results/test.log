[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results/test/parameters/data --n-max-queries 100 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/674271/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/674271 --input-metafname /tmp/dralph/hmms/674271/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/674271/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   49 / 100 v annotations (51 failed) with 28 v genes in 0.1 sec
    igk:   40 / 100 v annotations (60 failed) with 18 v genes in 0.1 sec
    igl:   15 / 100 v annotations (85 failed) with 12 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/674271/
  igh: 48 to 674271/igh.fa
  igk: 37 to 674271/igk.fa
  igl: 15 to 674271/igl.fa
writing to paired subdirs
    igh+igk:
      igh: 36 / 48 to igh+igk/igh.fa
      igk: 35 / 37 to igh+igk/igk.fa
    igh+igl:
      igh: 15 / 48 to igh+igl/igh.fa
      igl: 15 / 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/674271/igh.fa --parameter-dir test/paired/new-results/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/674271/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/674271/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 27 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igh/sw (2.4 sec)
    water time: 2.6  (ig-sw 2.5  processing 0.1)
  writing hmms     removed 13 genes from glfo (leaving v 23  d 19  j 6)
(0.2 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igh/hmm (2.3 sec)
         infra time: 2.4
      hmm step time: 2.9
  writing hmms     removed 1  genes from glfo (leaving v 23  d 18  j 6)
(0.2 sec)
      total time: 6.4
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/674271/igk.fa --parameter-dir test/paired/new-results/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/674271/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/674271/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igk/sw (1.7 sec)
    water time: 1.9  (ig-sw 1.8  processing 0.1)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igk/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 1.9
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 4.5
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/674271/igl.fa --parameter-dir test/paired/new-results/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/674271/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/674271/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igl/sw (1.0 sec)
    water time: 1.2  (ig-sw 1.1  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igl/hmm (1.0 sec)
         infra time: 1.0
      hmm step time: 1.2
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
      total time: 3.0
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/674271/: failed.fa
      total time: 17.0
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results/test/parameters/data --n-sim-events 10 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/test/simu --indel-frequency 0.2
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu
[94migh+igk[0m: simulating 7 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 7 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igk/trees
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 7 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 7 trees:   depth 0.01927   leaves 5.57
    writing trees to test/paired/new-results/test/simu/igh+igk/trees.nwk
      total time: 1.3
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igk/igh
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-0/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-0.nwk
    made 1 event with 12 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.3

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-1/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-2/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-2.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-3/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-3.nwk
    made 1 event with 2 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-4/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-4.nwk
    made 1 event with 2 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-5/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-5.nwk
    made 1 event with 9 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.3

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/133042/sub-6/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/133042/trees-sub-6.nwk
    made 1 event with 8 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.2

   read 7 events with 39 seqs from 7 .yaml files
      total time: 1.4
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igk --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2077655082 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igk/igk
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-0/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-0.nwk
    made 1 event with 12 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.3

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-1/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.1

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-2/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-2.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 3
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-3/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-3.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.1

      --> proc 4
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-4/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-4.nwk
    made 1 event with 2 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 5
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-5/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-5.nwk
    made 1 event with 9 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.2

      --> proc 6
  note: set tree inference outdir to /tmp/dralph/hmms/941020/sub-6/igk
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/941020/trees-sub-6.nwk
    made 1 event with 8 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.2

   read 7 events with 39 seqs from 7 .yaml files
      total time: 1.3
[94migh+igl[0m: simulating 3 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 3 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igl/trees
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 3 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 3 trees:   depth 0.04762   leaves 9.00
    writing trees to test/paired/new-results/test/simu/igh+igl/trees.nwk
      total time: 1.3
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igl/igh
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/679852/sub-0/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/679852/trees-sub-0.nwk
    made 1 event with 14 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.3

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/679852/sub-1/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/679852/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/679852/sub-2/igh
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/679852/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.2

   read 3 events with 27 seqs from 3 .yaml files
      total time: 1.2
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igl --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1083609742 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/test/simu/igh+igl/igl
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
  note: set tree inference outdir to /tmp/dralph/hmms/335793/sub-0/igl
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/335793/trees-sub-0.nwk
    made 1 event with 14 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.3

      --> proc 1
  note: set tree inference outdir to /tmp/dralph/hmms/335793/sub-1/igl
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/335793/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.2

      --> proc 2
  note: set tree inference outdir to /tmp/dralph/hmms/335793/sub-2/igl
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/335793/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.2

   read 3 events with 27 seqs from 3 .yaml files
      total time: 1.2
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igl/
  concatenating heavy chain loci:
      [94mh[0m added 3 annotations (27 seqs) for total 7 (39)
    finished with:
     [94mh[0m: 10 annotations (340 seqs)
  apportioned 132 seqs among 52 droplets (mean/2 1.3): 4 2 2 2 2 4 2 2 2 2 2 2 4 2 2 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 4 2 4 2 2 2 2 2 2 2 2 2 4 4 2 4 2 2 2 4 4 2
  removed 19 / 132 = 0.14 seqs from outfos (leaving 7 / 113 unpaired)
    writing combined h/l info to fasta and meta files in test/paired/new-results/test/simu
      total time: 12.2
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 56 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 56 / 56 v annotations (0 failed) with 9 v genes in 0.1 sec
    keeping 6 / 198 v genes
    [91mmissing[0m 17 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m11[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
    water time: 0.2  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igh/sw (0.7 sec)
    water time: 0.9  (ig-sw 0.8  processing 0.1)
  writing hmms     removed 16 genes from glfo (leaving v 6  d 18  j 4)
(0.1 sec)
hmm
    reading output
        read 56 hmm output lines with 56 sequences in 56 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/hmm (0.6 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/true (0.6 sec)
         infra time: 1.3
      hmm step time: 1.7
  writing hmms     removed 3  genes from glfo (leaving v 6  d 15  j 4)
(0.1 sec)
      total time: 3.3
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 36 / 36 v annotations (0 failed) with 6 v genes in 0.0 sec
    keeping 5 / 64 v genes
    [91mmissing[0m 11 simulation genes (counts): [95mk[0m[91mv[0m[95m1[0m[95m-12[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-27[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-5[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-8[0m[93m03[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-9[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1D[0m[95m-39[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2[0m[95m-24[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2D[0m[95m-28[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m4[0m[95m-1[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m6[0m[95m-21[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igk/sw (0.6 sec)
    water time: 0.9  (ig-sw 0.6  processing 0.1)
  writing hmms     removed 2  genes from glfo (leaving v 5  d 1  j 5)
(0.1 sec)
hmm
    reading output
        read 36 hmm output lines with 36 sequences in 36 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/hmm (0.5 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/true (0.5 sec)
         infra time: 1.2
      hmm step time: 1.4
  writing hmms     removed 0  genes from glfo (leaving v 5  d 1  j 5)
(0.1 sec)
      total time: 3.0
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
hash seed: '0'
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.0 sec
    keeping 3 / 80 v genes
    [91mmissing[0m 7 simulation genes (counts): [95ml[0m[91mv[0m[95m1[0m[95m-51[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-1[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-19[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-27[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m4[0m[95m-60[0m[93m03[0m 0  [95ml[0m[91mv[0m[95m7[0m[95m-46[0m[93m04[0m 0  [95ml[0m[91mv[0m[95m8[0m[95m-61[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.0 sec
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igl/sw (0.4 sec)
    water time: 0.5  (ig-sw 0.4  processing 0.1)
  writing hmms     removed 7  genes from glfo (leaving v 3  d 1  j 2)
(0.1 sec)
hmm
    reading output
        read 21 hmm output lines with 21 sequences in 21 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/hmm (0.3 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/true (0.3 sec)
         infra time: 0.7
      hmm step time: 0.9
  writing hmms     removed 0  genes from glfo (leaving v 3  d 1  j 2)
(0.1 sec)
      total time: 1.9
      total time: 10.4
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igh.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/single-chain/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 56 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 56 / 56 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 25 (0.446) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)
        water time: 0.1
hmm
  caching all 56 naive sequences (0.4s)
    collapsed 56 queries into 50 clusters with identical naive seqs (0.0 sec)
  50 clusters with 10 procs (0.4s)
   44 clusters with 7 procs (0.5s)
   36 clusters with 5 procs (0.4s)
   31 clusters with 3 procs (0.3s)
   29 clusters with 2 procs (0.6s)
   23 clusters with 1 proc (0.8s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 3.1
getting annotations for final partition
  subcluster annotating 20 clusters with steps:  (0.4s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)

    subcluster annotation time 0.6
      total time: 4.3
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igk.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/single-chain/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
  plotting performance (0.0 sec)
        water time: 0.1
hmm
  caching all 36 naive sequences (0.2s)
    collapsed 36 queries into 7 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 7
  7 clusters with 7 procs (0.2s)
   7 clusters with 5 procs (0.2s)
   7 clusters with 3 procs (0.2s)
   7 clusters with 2 procs (0.2s)
   6 clusters with 1 proc (0.3s)
       partition loop time: 0.9
getting annotations for final partition
  subcluster annotating 6 clusters with steps:  (0.2s) (0.1s) (0.1s)   plotting performance (0.0 sec)

    subcluster annotation time 0.5
      total time: 1.8
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igl.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/single-chain/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
  plotting performance (0.0 sec)
        water time: 0.1
hmm
  caching all 21 naive sequences (0.2s)
    collapsed 21 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.1s)
   3 clusters with 2 procs (0.1s)
   3 clusters with 1 proc (0.2s)
       partition loop time: 0.4
getting annotations for final partition
  subcluster annotating 3 clusters with steps:  (0.2s) (0.1s) (0.1s)   plotting performance (0.0 sec)

    subcluster annotation time 0.4
      total time: 1.2
[44mcombining[0m chains
cleaning pair info for 113 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 13 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 8 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 4  [95mk[0m 4
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 3 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [95mk[0m 0
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   14 --> 15   [91m+1[0m
        [95mk[0m    6 --> 15   [91m+9[0m
    re-added unpaired seqs ([94mh[0m 4, [95mk[0m 4) to give total seqs in joint partitions: [94mh[0m 36  [95mk[0m 36
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           4
       [95mk[0m            0           0           4
    [93mwarning[0m removed 3/34 uids (leaving 31) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 5 / 36 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.663
       joint   0.907  0.740
  [95mk[0m ccfs:     purity  completeness
      single   0.949  1.000
       joint   0.963  0.594
  merge time 0.0
  need to get annotations for 7/15 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 36 sequences in 15 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 13 (0.361) unproductive
        water time: 0.0
hmm
  subcluster annotating 15 clusters with steps:  (0.2s) (0.2s) 
    subcluster annotation time 0.4
      total time: 0.5
  need to get annotations for 13/15 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 36 sequences in 15 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
        water time: 0.0
hmm
  subcluster annotating 15 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.4
      total time: 0.5
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 7 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 3  [92ml[0m 4
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 4 total unpaired (in families with no (well-)paired seqs): [94mh[0m 4  [92ml[0m 0
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    7 --> 8    [91m+1[0m
        [92ml[0m    3 --> 8    [91m+5[0m
    re-added unpaired seqs ([94mh[0m 3, [92ml[0m 4) to give total seqs in joint partitions: [94mh[0m 20  [92ml[0m 21
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           3
       [92ml[0m            0           0           4
    [93mwarning[0m removed 5/22 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 1 / 20 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 2 / 20 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.663
       joint   0.950  0.625
  [92ml[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.611
  merge time 0.0
  need to get annotations for 5/8 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 20 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 20 sequences in 8 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 20 / 20 v annotations (0 failed) with 4 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 20 / 20 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 12 (0.600) unproductive
        water time: 0.0
hmm
  subcluster annotating 8 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.4
  need to get annotations for 8/8 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml: loci paired-uids
  --input-partition-fname: read best partition with 21 sequences in 8 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
        water time: 0.0
hmm
  subcluster annotating 8 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.4
/home/dralph/work/partis/python/plotting.py:1378: MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. In future versions, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = copy.copy(mpl.cm.get_cmap("viridis"))
  cmap.set_under('w')
  concatenating heavy chain loci:
      [94mh[0m added 8 annotations (20 seqs) for total 15 (36)
    finished with:
     [94mh[0m: 23 annotations (861 seqs)
    [93mwarning[0m added 1 / 56 missing ids as singletons to inferred partition, to match ids in true partition
   N clusters with all seqs:
        [94mh[0m   20 --> 23   [91m+3[0m
        [95mk[0m    6 --> 15   [91m+9[0m
        [92ml[0m    3 --> 8    [91m+5[0m
      total time: 16.3
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/seed-partition-new-simu
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m       56       32        18     0        5      11   0.196    [91m2[0m
             [95mk[0m       36       12        18     0        5      11   0.306    [91m2[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      11       6     17    0.304
             [95mk[0m      11       1     12    0.333
             [92ml[0m       0       4      4    0.190
      taken 22, paired with taken 11 (total 33)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 17 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 17 / 17 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 17 / 17 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 8 (0.471) unproductive
        water time: 0.0
hmm
  caching all 17 naive sequences (0.2s)
    collapsed 17 queries into 17 clusters with identical naive seqs (0.0 sec)
  17 clusters with 10 procs (0.3s)
   17 clusters with 7 procs (0.2s)
   17 clusters with 5 procs (0.2s)
   17 clusters with 3 procs (0.3s)
   14 clusters with 2 procs (0.3s)
   14 clusters with 1 proc (0.4s)
       partition loop time: 1.8
getting annotations for final partition
    reading output
        read 12 hmm output lines with 17 sequences in 12 events  (0 failures)
      hmm step time: 0.2
      total time: 2.3
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 12 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 12 / 12 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 12 / 12 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 7 (0.583) unproductive
        water time: 0.0
hmm
  caching all 12 naive sequences (0.2s)
    collapsed 12 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.1s)
   3 clusters with 2 procs (0.1s)
   3 clusters with 1 proc (0.1s)
       partition loop time: 0.3
getting annotations for final partition
  subcluster annotating 2 clusters with steps:  (0.2s) (0.1s) (0.1s) 
    subcluster annotation time 0.4
      total time: 0.9
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igl
hash seed: '0'
  --input-metafnames: added meta info for 4 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 4
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 4 / 4 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
  caching all 4 naive sequences (0.1s)
    collapsed 4 queries into 2 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 4 --> 2
  2 clusters with 2 procs (0.1s)
   2 clusters with 1 proc (0.1s)
       partition loop time: 0.2
getting annotations for final partition
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.1
      total time: 0.5
[44mcombining[0m chains
cleaning pair info for 33 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 1 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [95mk[0m 0
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 4 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [95mk[0m 1
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    8 --> 8   
        [95mk[0m    1 --> 8    [91m+7[0m
    re-added unpaired seqs ([94mh[0m 1, [95mk[0m 0) to give total seqs in joint partitions: [94mh[0m 12  [95mk[0m 11
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [95mk[0m            0           0           0
    [93mwarning[0m removed 39/56 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 26/34 uids (leaving 8) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 1 / 12 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 3 / 12 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   1.000  0.100
       joint   1.000  0.125
    [93mwarning[0m removed 24/36 uids (leaving 12) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 25/36 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.909  1.000
       joint   1.000  0.100
  merge time 0.0
     removed 7 unseeded clusters (of 8 total, leaving 1) from igh joint partition
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh
hash seed: '0'
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
     removed 7 unseeded clusters (of 8 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk
hash seed: '0'
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (1.000) unproductive
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
      total time: 0.1
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 1 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [92ml[0m 0
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 5 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [92ml[0m 2
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    2 --> 2   
        [92ml[0m    1 --> 2    [91m+1[0m
    re-added unpaired seqs ([94mh[0m 1, [92ml[0m 0) to give total seqs in joint partitions: [94mh[0m 3  [92ml[0m 2
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [92ml[0m            0           0           0
  merge time 0.0
     removed 2 unseeded clusters (of 2 total, leaving 0) from igh joint partition
     removed 2 unseeded clusters (of 2 total, leaving 0) from igl joint partition
  concatenating heavy chain loci:
    finished with:
     [94mh[0m: 1 annotations (37 seqs)
   N clusters with all seqs:
        [94mh[0m   12 --> 1    [91m-11[0m
        [95mk[0m    2 --> 1    [91m-1[0m
      total time: 7.9
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 7 6 3 3 3
      skipped 10 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 7 6
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.1s)
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 2 ran fasttree
    skipped 3/5 clusters smaller than 4
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bnw bop dkn ikm psx
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 9/11 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dst eov ily npq
    skipped 3/5 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 4 clusters with sizes 7 7 3 3
      skipped 11 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 7 7
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.1s)
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 2 ran fasttree
    skipped 2/4 clusters smaller than 4
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 3/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
    skipped 2/4 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 2 clusters with sizes 8 3
      skipped 6 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 1 cluster with size: 8
      starting 1 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/input-seqs.fa
      made 1 fasttree trees (0.1s)
      collapsing zero length leaves
    tree origins: 1 ran fasttree
    skipped 1/2 clusters smaller than 4
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev bnw bop dkn ikm
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
    skipped 1/2 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml
  note: set tree inference outdir to /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl
hash seed: '0'
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 2 clusters with sizes 8 6
      skipped 6 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 8 6
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/fasttree.out /home/dralph/work/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.1s)
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 2 ran fasttree
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 10/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev dkn ikm
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.2
[44mgetting combined h/l selection metrics[0m
    igh+igk: 13 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 13 annotations with N h or l ids < 3 (controlled by --min-paired-cluster-size-to-read) (keeping 2 annotation pairs)
    igh+igl: 6 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 6 annotations with N h or l ids < 3 (controlled by --min-paired-cluster-size-to-read) (keeping 2 annotation pairs)
           cons seq not observed
           less than 0.75 (3 / 8 = 0.38) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: a2238f4e9a-igh b02ee7754a-igh b1e56e40a1-igh
           cons seq not observed
           less than 0.75 (1 / 7 = 0.14) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (2 / 7 = 0.29) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 1 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 665985d2d1-igk
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 4 clusters with sizes 7 7 5 3
      skipped 0 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 3 clusters with sizes: 7 7 5
      starting 3 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-0/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-1/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-2/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-2/input-seqs.fa
      made 3 fasttree trees (0.2s)
      collapsing zero length leaves
      collapsing zero length leaves
      collapsing zero length leaves
    tree origins: 3 ran fasttree
    skipped 1/4 clusters smaller than 4
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bnw bop dkn ikm psx
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: doq dst eov flx ily npq
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 9/10 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dhq eyz fnv uvx
    skipped 1/4 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/selection-metrics.yaml
      writing 10 chosen abs to test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 4.0
