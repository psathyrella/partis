TEST              annotate-ref-simu   ./bin/partis.py --action run-viterbi --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --plotdir test/_new-results/simu-ref-performance --plot-performance --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-ref-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/460549/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           992             129              0                          53              52              24               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/460549/germline-sets (using 26 genes)
           129               8              4                           0               4               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/460549/germline-sets (using 26 genes)
    skipping performance evaluation of -5204308891749217752 because of indels
    skipping performance evaluation of -3307202274477556678 because of indels
    skipping performance evaluation of -679373505634261555 because of indels
    skipping performance evaluation of 1387915176058769153 because of indels
             8               4              0                           0               4               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/460549/germline-sets (using 26 genes)
/usr/lib/pymodules/python2.7/matplotlib/pyplot.py:412: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_num_figures`).
  max_open_warning, RuntimeWarning)
             4               2              0                           0               2               0               0               0             increasing mismatch score (3 --> 4) and rerunning them
  v_gene
    correct up to allele:  922 / 986  = 0.9351 (-0.927, +0.942)
  d_gene
    correct up to allele:  787 / 986  = 0.7982 (-0.785, +0.810)
  j_gene
    correct up to allele:  874 / 986  = 0.8864 (-0.876, +0.895)
      info for 990      (skipped 0 / 992 = 0.000 unproductive    2 / 992 = 0.002 other ) 
   [91mwarning[0m 2 missing annotations (-54313333789159748:-9161614439565092097)
hmm
    writing input
    running
      hmm run time: 18.167
    time to merge csv files: 0.030
    read output
    skipping performance evaluation of -679373505634261555 because of indels
    skipping performance evaluation of -5204308891749217752 because of indels
    skipping performance evaluation of 1387915176058769153 because of indels
    skipping performance evaluation of -3307202274477556678 because of indels
  v_gene
    correct up to allele:  841 / 985  = 0.8538 (-0.842, +0.864)
  d_gene
    correct up to allele:  811 / 985  = 0.8234 (-0.811, +0.834)
  j_gene
    correct up to allele:  914 / 985  = 0.9279 (-0.919, +0.935)
    processed 989 sequences in 989 events (1 invalid events)
      1 boundary errors
missing 3 input keys
      total time: 45.162
TEST             partition-ref-simu   ./bin/partis.py --action partition --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --persistent-cachefname test/_new-results/cache-ref-partition.csv --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/partition-ref-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/750414/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/750414/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/750414/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/750414/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 16.730
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 58.1536
        calculated   vtb 250    fwd 250   hamming merged 0    naive hfracs 0
      hmm run time: 58.300
--> 250 clusters with 10 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 1
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 225   small lratios: 6   total: 231
        time 3.28528
        calculated   vtb 2    fwd 10   hamming merged 3    naive hfracs 343

      --> proc 3
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 222   small lratios: 9   total: 231
        time 3.92602
        calculated   vtb 1    fwd 12   hamming merged 3    naive hfracs 321

      --> proc 5
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 203   small lratios: 7   total: 210
        time 3.3709
        calculated   vtb 2    fwd 12   hamming merged 4    naive hfracs 341

      --> proc 9
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 206   small lratios: 4   total: 210
        time 3.26992
        calculated   vtb 3    fwd 9   hamming merged 4    naive hfracs 363

      --> proc 8
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 204   small lratios: 6   total: 210
        time 4.4571
        calculated   vtb 3    fwd 12   hamming merged 2    naive hfracs 363

      --> proc 4
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 244   small lratios: 9   total: 253
        time 4.99561
        calculated   vtb 1    fwd 13   hamming merged 2    naive hfracs 322

      --> proc 6
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 221   small lratios: 10   total: 231
        time 5.8416
        calculated   vtb 1    fwd 13   hamming merged 3    naive hfracs 321

      --> proc 7
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 283   small lratios: 17   total: 300
        time 5.54508
        calculated   vtb 0    fwd 17   hamming merged 0    naive hfracs 300

      --> proc 0
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 181   small lratios: 9   total: 190
        time 6.08945
        calculated   vtb 3    fwd 17   hamming merged 5    naive hfracs 360

      --> proc 2
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 234   small lratios: 19   total: 253
        time 7.45468
        calculated   vtb 2    fwd 22   hamming merged 1    naive hfracs 345

      hmm run time: 9.098
    time to merge csv files: 0.018
  merged path 0 with 31 glomeration steps and 220 final clusters
        read cached glomeration time: 0.021
      partition step time: 9.625
--> 222 clusters with 7 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 370   small lratios: 8   total: 378
        time 4.19248
        calculated   vtb 3    fwd 12   hamming merged 4    naive hfracs 580

      --> proc 1
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 421   small lratios: 14   total: 435
        time 4.97565
        calculated   vtb 0    fwd 15   hamming merged 2    naive hfracs 496

      --> proc 4
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 344   small lratios: 7   total: 351
        time 4.1787
        calculated   vtb 1    fwd 13   hamming merged 5    naive hfracs 522

      --> proc 5
        read 387 cached logprobs and 280 naive seqs
        stopping after drop -13644.9 --> -13650
        time 4.32593
        calculated   vtb 4    fwd 10   hamming merged 5    naive hfracs 546

      --> proc 6
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 343   small lratios: 8   total: 351
        time 6.23629
        calculated   vtb 3    fwd 13   hamming merged 4    naive hfracs 546

      --> proc 2
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 384   small lratios: 22   total: 406
        time 7.88988
        calculated   vtb 1    fwd 24   hamming merged 3    naive hfracs 524

      --> proc 3
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 307   small lratios: 18   total: 325
        time 7.31086
        calculated   vtb 2    fwd 25   hamming merged 6    naive hfracs 547

      hmm run time: 9.074
    time to merge csv files: 0.015
  merged path 0 with 30 glomeration steps and 193 final clusters
        read cached glomeration time: 0.015
      partition step time: 9.856
--> 197 clusters with 5 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 646   small lratios: 20   total: 666
        time 6.23609
        calculated   vtb 2    fwd 19   hamming merged 3    naive hfracs 891

      --> proc 3
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 519   small lratios: 9   total: 528
        time 6.81084
        calculated   vtb 4    fwd 16   hamming merged 5    naive hfracs 875

      --> proc 4
        read 499 cached logprobs and 309 naive seqs
        stopping after drop -17720.5 --> -17744.7
        time 7.08212
        calculated   vtb 2    fwd 23   hamming merged 5    naive hfracs 775

      --> proc 2
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 562   small lratios: 33   total: 595
        time 9.60253
        calculated   vtb 2    fwd 30   hamming merged 3    naive hfracs 810

      --> proc 1
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 623   small lratios: 43   total: 666
        time 17.4386
        calculated   vtb 2    fwd 42   hamming merged 2    naive hfracs 853

      hmm run time: 19.070
    time to merge csv files: 0.016
  merged path 0 with 22 glomeration steps and 176 final clusters
        read cached glomeration time: 0.210
      partition step time: 19.647
--> 178 clusters with 3 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1295   small lratios: 31   total: 1326
        time 11.5857
        calculated   vtb 8    fwd 38   hamming merged 7    naive hfracs 2206

      --> proc 1
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1120   small lratios: 56   total: 1176
        time 22.3296
        calculated   vtb 5    fwd 68   hamming merged 10    naive hfracs 1961

      --> proc 2
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1425   small lratios: 60   total: 1485
        time 26.9486
        calculated   vtb 1    fwd 62   hamming merged 4    naive hfracs 1765

      hmm run time: 28.057
    time to merge csv files: 0.021
  merged path 0 with 23 glomeration steps and 156 final clusters
        read cached glomeration time: 0.012
      partition step time: 28.418
--> 159 clusters with 2 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 1
        read 797 cached logprobs and 351 naive seqs
        stopping after drop -45687.6 --> -45820.6
        time 26.5307
        calculated   vtb 5    fwd 77   hamming merged 7    naive hfracs 3371

      --> proc 0
        read 797 cached logprobs and 351 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 2261   small lratios: 85   total: 2346
        time 28.4967
        calculated   vtb 6    fwd 74   hamming merged 10    naive hfracs 3657

      hmm run time: 30.049
    time to merge csv files: 0.016
  merged path 0 with 20 glomeration steps and 140 final clusters
        read cached glomeration time: 0.009
      partition step time: 30.400
--> 141 clusters with 1 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
        read 948 cached logprobs and 369 naive seqs
        stopping after drop -91699.4 --> -91710.6
        time 59.4312
        calculated   vtb 12    fwd 148   hamming merged 22    naive hfracs 11234
â€˜test/_new-results/cache-ref-partition.csv.tmpâ€™ -> â€˜test/_new-results/cache-ref-partition.csvâ€™
      hmm run time: 59.573
  merged path 0 with 23 glomeration steps and 119 final clusters
        read cached glomeration time: 0.018
      partition step time: 59.873
      loop time: 157.820
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.005
      write time: 0.011
    time to merge csv files: 0.097
      total time: 234.739
TEST       point-partition-ref-simu   ./bin/partis.py --action partition --naive-hamming --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/point-partition-ref-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/768052/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/768052/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/768052/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/768052/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 13.723
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 28.6361
        calculated   vtb 250    fwd 0   hamming merged 0    naive hfracs 0
      hmm run time: 28.792
--> 250 clusters with 10 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 8
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 0.88989
        calculated   vtb 3    fwd 0   hamming merged 4    naive hfracs 363

      --> proc 1
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 1.58123
        calculated   vtb 3    fwd 0   hamming merged 4    naive hfracs 363

      --> proc 4
        read 0 cached logprobs and 250 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 1.18906
        calculated   vtb 1    fwd 0   hamming merged 2    naive hfracs 322

      --> proc 5
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0453889
        time 1.28066
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 395

      --> proc 6
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0453889
        time 1.3125
        calculated   vtb 1    fwd 0   hamming merged 3    naive hfracs 321

      --> proc 7
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0453889
        time 1.40664
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 366

      --> proc 0
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0453889
        time 2.67983
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 395

      --> proc 2
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 2.46698
        calculated   vtb 4    fwd 0   hamming merged 4    naive hfracs 386

      --> proc 3
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0453889
        time 2.07141
        calculated   vtb 3    fwd 0   hamming merged 5    naive hfracs 360

      --> proc 9
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0453889
        time 2.2427
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 382

      hmm run time: 4.085
    time to merge csv files: 0.013
  merged path 0 with 45 glomeration steps and 206 final clusters
        read cached glomeration time: 0.022
      partition step time: 4.795
--> 206 clusters with 7 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 3
        read 0 cached logprobs and 294 naive seqs
        stop with all 351 / 351 hamming distances greater than 0.0453889
        time 0.960556
        calculated   vtb 2    fwd 0   hamming merged 2    naive hfracs 459

      --> proc 6
        read 0 cached logprobs and 294 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0453889
        time 0.782518
        calculated   vtb 1    fwd 0   hamming merged 3    naive hfracs 431

      --> proc 0
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 1.30584
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 555

      --> proc 1
        read 0 cached logprobs and 294 naive seqs
        stop with all 300 / 300 hamming distances greater than 0.0453889
        time 1.67098
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 537

      --> proc 4
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 1.87287
        calculated   vtb 5    fwd 0   hamming merged 6    naive hfracs 526

      --> proc 5
        read 0 cached logprobs and 294 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0453889
        time 0.996805
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 457

      --> proc 2
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 2.32048
        calculated   vtb 7    fwd 0   hamming merged 7    naive hfracs 610

      hmm run time: 4.061
    time to merge csv files: 0.019
  merged path 0 with 34 glomeration steps and 173 final clusters
        read cached glomeration time: 0.012
      partition step time: 4.539
--> 173 clusters with 5 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 1
        read 0 cached logprobs and 327 naive seqs
        stop with all 435 / 435 hamming distances greater than 0.0453889
        time 0.8699
        calculated   vtb 1    fwd 0   hamming merged 5    naive hfracs 624

      --> proc 0
        read 0 cached logprobs and 327 naive seqs
        stop with all 465 / 465 hamming distances greater than 0.0453889
        time 1.49807
        calculated   vtb 2    fwd 0   hamming merged 4    naive hfracs 656

      --> proc 2
        read 0 cached logprobs and 327 naive seqs
        stop with all 496 / 496 hamming distances greater than 0.0453889
        time 1.2601
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 658

      --> proc 4
        read 0 cached logprobs and 327 naive seqs
        stop with all 465 / 465 hamming distances greater than 0.0453889
        time 1.49026
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 654

      --> proc 3
        read 0 cached logprobs and 327 naive seqs
        stop with all 351 / 351 hamming distances greater than 0.0453889
        time 2.36315
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 701

      hmm run time: 4.043
    time to merge csv files: 0.014
  merged path 0 with 23 glomeration steps and 151 final clusters
        read cached glomeration time: 0.147
      partition step time: 4.977
--> 151 clusters with 3 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 1
        read 0 cached logprobs and 349 naive seqs
        stop with all 1081 / 1081 hamming distances greater than 0.0453889
        time 1.92214
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 1366

      --> proc 0
        read 0 cached logprobs and 349 naive seqs
        stop with all 903 / 903 hamming distances greater than 0.0453889
        time 2.34419
        calculated   vtb 3    fwd 0   hamming merged 8    naive hfracs 1404

      --> proc 2
        read 0 cached logprobs and 349 naive seqs
        stop with all 861 / 861 hamming distances greater than 0.0453889
        time 2.92421
        calculated   vtb 7    fwd 0   hamming merged 8    naive hfracs 1533

      hmm run time: 5.029
    time to merge csv files: 0.014
  merged path 0 with 20 glomeration steps and 132 final clusters
        read cached glomeration time: 0.007
      partition step time: 5.736
--> 132 clusters with 2 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 0
        read 0 cached logprobs and 368 naive seqs
        stop with all 1431 / 1431 hamming distances greater than 0.0453889
        time 2.68063
        calculated   vtb 8    fwd 0   hamming merged 12    naive hfracs 2597

      --> proc 1
        read 0 cached logprobs and 368 naive seqs
        stop with all 1431 / 1431 hamming distances greater than 0.0453889
        time 3.21244
        calculated   vtb 6    fwd 0   hamming merged 12    naive hfracs 2478

      hmm run time: 5.022
    time to merge csv files: 0.014
  merged path 0 with 25 glomeration steps and 108 final clusters
        read cached glomeration time: 0.009
      partition step time: 5.611
--> 108 clusters with 1 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
        read 0 cached logprobs and 392 naive seqs
        stop with all 4371 / 4371 hamming distances greater than 0.0453889
        time 3.77263
        calculated   vtb 10    fwd 0   hamming merged 14    naive hfracs 6753
      hmm run time: 3.903
  merged path 0 with 15 glomeration steps and 94 final clusters
        read cached glomeration time: 0.002
      partition step time: 4.388
      loop time: 30.046
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.001
      write time: 0.009
      total time: 74.350
TEST     vsearch-partition-ref-simu   ./bin/partis.py --action partition --naive-vsearch --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/vsearch-partition-ref-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/120457/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/120457/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/120457/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/120457/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 13.689
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 57.7829
        calculated   vtb 250    fwd 250   hamming merged 0    naive hfracs 0
      hmm run time: 57.994
  auto hamming bounds:
      0.112 mutation in test/reference-results/test/parameters/simu/hmm
       naive hamming bounds: 0.032 0.032
    using hfrac bound for vsearch 0.032
  out:
    vsearch v1.1.3_linux_x86_64, 62.8GB RAM, 16 cores
    https://github.com/torognes/vsearch
    
    
  err:
    Reading file /tmp/dralph/hmms/120457/simu.fasta 0%  Reading file /tmp/dralph/hmms/120457/simu.fasta 0%  Reading file /tmp/dralph/hmms/120457/simu.fasta 1%  Reading file /tmp/dralph/hmms/120457/simu.fasta 2%  Reading file /tmp/dralph/hmms/120457/simu.fasta 3%  Reading file /tmp/dralph/hmms/120457/simu.fasta 4%  Reading file /tmp/dralph/hmms/120457/simu.fasta 4%  Reading file /tmp/dralph/hmms/120457/simu.fasta 5%  Reading file /tmp/dralph/hmms/120457/simu.fasta 6%  Reading file /tmp/dralph/hmms/120457/simu.fasta 7%  Reading file /tmp/dralph/hmms/120457/simu.fasta 8%  Reading file /tmp/dralph/hmms/120457/simu.fasta 8%  Reading file /tmp/dralph/hmms/120457/simu.fasta 9%  Reading file /tmp/dralph/hmms/120457/simu.fasta 10%  Reading file /tmp/dralph/hmms/120457/simu.fasta 11%  Reading file /tmp/dralph/hmms/120457/simu.fasta 12%  Reading file /tmp/dralph/hmms/120457/simu.fasta 12%  Reading file /tmp/dralph/hmms/120457/simu.fasta 13%  Reading file /tmp/dralph/hmms/120457/simu.fasta 14%  Reading file /tmp/dralph/hmms/120457/simu.fasta 15%  Reading file /tmp/dralph/hmms/120457/simu.fasta 16%  Reading file /tmp/dralph/hmms/120457/simu.fasta 16%  Reading file /tmp/dralph/hmms/120457/simu.fasta 17%  Reading file /tmp/dralph/hmms/120457/simu.fasta 18%  Reading file /tmp/dralph/hmms/120457/simu.fasta 19%  Reading file /tmp/dralph/hmms/120457/simu.fasta 20%  Reading file /tmp/dralph/hmms/120457/simu.fasta 20%  Reading file /tmp/dralph/hmms/120457/simu.fasta 21%  Reading file /tmp/dralph/hmms/120457/simu.fasta 22%  Reading file /tmp/dralph/hmms/120457/simu.fasta 23%  Reading file /tmp/dralph/hmms/120457/simu.fasta 24%  Reading file /tmp/dralph/hmms/120457/simu.fasta 24%  Reading file /tmp/dralph/hmms/120457/simu.fasta 25%  Reading file /tmp/dralph/hmms/120457/simu.fasta 26%  Reading file /tmp/dralph/hmms/120457/simu.fasta 27%  Reading file /tmp/dralph/hmms/120457/simu.fasta 28%  Reading file /tmp/dralph/hmms/120457/simu.fasta 28%  Reading file /tmp/dralph/hmms/120457/simu.fasta 29%  Reading file /tmp/dralph/hmms/120457/simu.fasta 30%  Reading file /tmp/dralph/hmms/120457/simu.fasta 31%  Reading file /tmp/dralph/hmms/120457/simu.fasta 32%  Reading file /tmp/dralph/hmms/120457/simu.fasta 32%  Reading file /tmp/dralph/hmms/120457/simu.fasta 33%  Reading file /tmp/dralph/hmms/120457/simu.fasta 34%  Reading file /tmp/dralph/hmms/120457/simu.fasta 35%  Reading file /tmp/dralph/hmms/120457/simu.fasta 36%  Reading file /tmp/dralph/hmms/120457/simu.fasta 36%  Reading file /tmp/dralph/hmms/120457/simu.fasta 37%  Reading file /tmp/dralph/hmms/120457/simu.fasta 38%  Reading file /tmp/dralph/hmms/120457/simu.fasta 39%  Reading file /tmp/dralph/hmms/120457/simu.fasta 40%  Reading file /tmp/dralph/hmms/120457/simu.fasta 40%  Reading file /tmp/dralph/hmms/120457/simu.fasta 41%  Reading file /tmp/dralph/hmms/120457/simu.fasta 42%  Reading file /tmp/dralph/hmms/120457/simu.fasta 43%  Reading file /tmp/dralph/hmms/120457/simu.fasta 44%  Reading file /tmp/dralph/hmms/120457/simu.fasta 44%  Reading file /tmp/dralph/hmms/120457/simu.fasta 45%  Reading file /tmp/dralph/hmms/120457/simu.fasta 46%  Reading file /tmp/dralph/hmms/120457/simu.fasta 47%  Reading file /tmp/dralph/hmms/120457/simu.fasta 48%  Reading file /tmp/dralph/hmms/120457/simu.fasta 48%  Reading file /tmp/dralph/hmms/120457/simu.fasta 49%  Reading file /tmp/dralph/hmms/120457/simu.fasta 50%  Reading file /tmp/dralph/hmms/120457/simu.fasta 51%  Reading file /tmp/dralph/hmms/120457/simu.fasta 52%  Reading file /tmp/dralph/hmms/120457/simu.fasta 52%  Reading file /tmp/dralph/hmms/120457/simu.fasta 53%  Reading file /tmp/dralph/hmms/120457/simu.fasta 54%  Reading file /tmp/dralph/hmms/120457/simu.fasta 55%  Reading file /tmp/dralph/hmms/120457/simu.fasta 56%  Reading file /tmp/dralph/hmms/120457/simu.fasta 56%  Reading file /tmp/dralph/hmms/120457/simu.fasta 57%  Reading file /tmp/dralph/hmms/120457/simu.fasta 58%  Reading file /tmp/dralph/hmms/120457/simu.fasta 59%  Reading file /tmp/dralph/hmms/120457/simu.fasta 60%  Reading file /tmp/dralph/hmms/120457/simu.fasta 60%  Reading file /tmp/dralph/hmms/120457/simu.fasta 61%  Reading file /tmp/dralph/hmms/120457/simu.fasta 62%  Reading file /tmp/dralph/hmms/120457/simu.fasta 63%  Reading file /tmp/dralph/hmms/120457/simu.fasta 64%  Reading file /tmp/dralph/hmms/120457/simu.fasta 64%  Reading file /tmp/dralph/hmms/120457/simu.fasta 65%  Reading file /tmp/dralph/hmms/120457/simu.fasta 66%  Reading file /tmp/dralph/hmms/120457/simu.fasta 67%  Reading file /tmp/dralph/hmms/120457/simu.fasta 68%  Reading file /tmp/dralph/hmms/120457/simu.fasta 68%  Reading file /tmp/dralph/hmms/120457/simu.fasta 69%  Reading file /tmp/dralph/hmms/120457/simu.fasta 70%  Reading file /tmp/dralph/hmms/120457/simu.fasta 71%  Reading file /tmp/dralph/hmms/120457/simu.fasta 72%  Reading file /tmp/dralph/hmms/120457/simu.fasta 72%  Reading file /tmp/dralph/hmms/120457/simu.fasta 73%  Reading file /tmp/dralph/hmms/120457/simu.fasta 74%  Reading file /tmp/dralph/hmms/120457/simu.fasta 75%  Reading file /tmp/dralph/hmms/120457/simu.fasta 76%  Reading file /tmp/dralph/hmms/120457/simu.fasta 76%  Reading file /tmp/dralph/hmms/120457/simu.fasta 77%  Reading file /tmp/dralph/hmms/120457/simu.fasta 78%  Reading file /tmp/dralph/hmms/120457/simu.fasta 79%  Reading file /tmp/dralph/hmms/120457/simu.fasta 80%  Reading file /tmp/dralph/hmms/120457/simu.fasta 80%  Reading file /tmp/dralph/hmms/120457/simu.fasta 81%  Reading file /tmp/dralph/hmms/120457/simu.fasta 82%  Reading file /tmp/dralph/hmms/120457/simu.fasta 83%  Reading file /tmp/dralph/hmms/120457/simu.fasta 84%  Reading file /tmp/dralph/hmms/120457/simu.fasta 84%  Reading file /tmp/dralph/hmms/120457/simu.fasta 85%  Reading file /tmp/dralph/hmms/120457/simu.fasta 86%  Reading file /tmp/dralph/hmms/120457/simu.fasta 87%  Reading file /tmp/dralph/hmms/120457/simu.fasta 88%  Reading file /tmp/dralph/hmms/120457/simu.fasta 88%  Reading file /tmp/dralph/hmms/120457/simu.fasta 89%  Reading file /tmp/dralph/hmms/120457/simu.fasta 90%  Reading file /tmp/dralph/hmms/120457/simu.fasta 91%  Reading file /tmp/dralph/hmms/120457/simu.fasta 92%  Reading file /tmp/dralph/hmms/120457/simu.fasta 92%  Reading file /tmp/dralph/hmms/120457/simu.fasta 93%  Reading file /tmp/dralph/hmms/120457/simu.fasta 94%  Reading file /tmp/dralph/hmms/120457/simu.fasta 95%  Reading file /tmp/dralph/hmms/120457/simu.fasta 96%  Reading file /tmp/dralph/hmms/120457/simu.fasta 96%  Reading file /tmp/dralph/hmms/120457/simu.fasta 97%  Reading file /tmp/dralph/hmms/120457/simu.fasta 98%  Reading file /tmp/dralph/hmms/120457/simu.fasta 99%  Reading file /tmp/dralph/hmms/120457/simu.fasta 100%  Reading file /tmp/dralph/hmms/120457/simu.fasta 100%
    100750 nt in 250 seqs, min 403, max 403, avg 403
    Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 1%  Indexing sequences 1%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 3%  Indexing sequences 3%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 5%  Indexing sequences 5%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 7%  Indexing sequences 7%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 9%  Indexing sequences 9%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 11%  Indexing sequences 11%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 13%  Indexing sequences 13%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 15%  Indexing sequences 15%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 17%  Indexing sequences 17%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 19%  Indexing sequences 19%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 21%  Indexing sequences 21%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 23%  Indexing sequences 23%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 25%  Indexing sequences 25%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 27%  Indexing sequences 27%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 29%  Indexing sequences 29%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 31%  Indexing sequences 31%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 33%  Indexing sequences 33%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 35%  Indexing sequences 35%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 37%  Indexing sequences 37%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 39%  Indexing sequences 39%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 41%  Indexing sequences 41%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 43%  Indexing sequences 43%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 45%  Indexing sequences 45%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 47%  Indexing sequences 47%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 49%  Indexing sequences 49%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 51%  Indexing sequences 51%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 53%  Indexing sequences 53%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 55%  Indexing sequences 55%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 57%  Indexing sequences 57%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 59%  Indexing sequences 59%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 61%  Indexing sequences 61%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 63%  Indexing sequences 63%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 65%  Indexing sequences 65%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 67%  Indexing sequences 67%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 69%  Indexing sequences 69%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 71%  Indexing sequences 71%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 73%  Indexing sequences 73%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 75%  Indexing sequences 75%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 77%  Indexing sequences 77%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 79%  Indexing sequences 79%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 81%  Indexing sequences 81%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 83%  Indexing sequences 83%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 85%  Indexing sequences 85%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 87%  Indexing sequences 87%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 89%  Indexing sequences 89%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 91%  Indexing sequences 91%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 93%  Indexing sequences 93%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 95%  Indexing sequences 95%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 97%  Indexing sequences 97%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 99%  Indexing sequences 99%  Indexing sequences 100%  Indexing sequences 100%
    Masking 0%  Masking 100%
    Sorting by length 0%  Sorting by length 100%
    Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 1%  Counting unique k-mers 1%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 3%  Counting unique k-mers 3%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 5%  Counting unique k-mers 5%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 7%  Counting unique k-mers 7%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 9%  Counting unique k-mers 9%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 11%  Counting unique k-mers 11%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 13%  Counting unique k-mers 13%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 15%  Counting unique k-mers 15%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 17%  Counting unique k-mers 17%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 19%  Counting unique k-mers 19%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 21%  Counting unique k-mers 21%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 23%  Counting unique k-mers 23%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 25%  Counting unique k-mers 25%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 27%  Counting unique k-mers 27%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 29%  Counting unique k-mers 29%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 31%  Counting unique k-mers 31%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 33%  Counting unique k-mers 33%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 35%  Counting unique k-mers 35%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 37%  Counting unique k-mers 37%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 39%  Counting unique k-mers 39%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 41%  Counting unique k-mers 41%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 43%  Counting unique k-mers 43%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 45%  Counting unique k-mers 45%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 47%  Counting unique k-mers 47%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 49%  Counting unique k-mers 49%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 51%  Counting unique k-mers 51%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 53%  Counting unique k-mers 53%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 55%  Counting unique k-mers 55%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 57%  Counting unique k-mers 57%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 59%  Counting unique k-mers 59%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 61%  Counting unique k-mers 61%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 63%  Counting unique k-mers 63%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 65%  Counting unique k-mers 65%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 67%  Counting unique k-mers 67%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 69%  Counting unique k-mers 69%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 71%  Counting unique k-mers 71%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 73%  Counting unique k-mers 73%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 75%  Counting unique k-mers 75%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 77%  Counting unique k-mers 77%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 79%  Counting unique k-mers 79%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 81%  Counting unique k-mers 81%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 83%  Counting unique k-mers 83%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 85%  Counting unique k-mers 85%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 87%  Counting unique k-mers 87%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 89%  Counting unique k-mers 89%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 91%  Counting unique k-mers 91%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 93%  Counting unique k-mers 93%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 95%  Counting unique k-mers 95%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 97%  Counting unique k-mers 97%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 99%  Counting unique k-mers 99%  Counting unique k-mers 100%  Counting unique k-mers 100%
    Clustering 0%  Clustering 4%  Clustering 8%  Clustering 12%  Clustering 16%  Clustering 20%  Clustering 24%  Clustering 28%  Clustering 32%  Clustering 36%  Clustering 40%  Clustering 44%  Clustering 48%  Clustering 52%  Clustering 56%  Clustering 60%  Clustering 64%  Clustering 68%  Clustering 72%  Clustering 76%  Clustering 80%  Clustering 84%  Clustering 88%  Clustering 92%  Clustering 96%  Clustering 100%  Clustering 100%
    Writing clusters 0%  Writing clusters 0%  Writing clusters 0%  Writing clusters 1%  Writing clusters 1%  Writing clusters 2%  Writing clusters 2%  Writing clusters 2%  Writing clusters 3%  Writing clusters 3%  Writing clusters 4%  Writing clusters 4%  Writing clusters 4%  Writing clusters 5%  Writing clusters 5%  Writing clusters 6%  Writing clusters 6%  Writing clusters 6%  Writing clusters 7%  Writing clusters 7%  Writing clusters 8%  Writing clusters 8%  Writing clusters 8%  Writing clusters 9%  Writing clusters 9%  Writing clusters 10%  Writing clusters 10%  Writing clusters 10%  Writing clusters 11%  Writing clusters 11%  Writing clusters 12%  Writing clusters 12%  Writing clusters 12%  Writing clusters 13%  Writing clusters 13%  Writing clusters 14%  Writing clusters 14%  Writing clusters 14%  Writing clusters 15%  Writing clusters 15%  Writing clusters 16%  Writing clusters 16%  Writing clusters 16%  Writing clusters 17%  Writing clusters 17%  Writing clusters 18%  Writing clusters 18%  Writing clusters 18%  Writing clusters 19%  Writing clusters 19%  Writing clusters 20%  Writing clusters 20%  Writing clusters 20%  Writing clusters 21%  Writing clusters 21%  Writing clusters 22%  Writing clusters 22%  Writing clusters 22%  Writing clusters 23%  Writing clusters 23%  Writing clusters 24%  Writing clusters 24%  Writing clusters 24%  Writing clusters 25%  Writing clusters 25%  Writing clusters 26%  Writing clusters 26%  Writing clusters 26%  Writing clusters 27%  Writing clusters 27%  Writing clusters 28%  Writing clusters 28%  Writing clusters 28%  Writing clusters 29%  Writing clusters 29%  Writing clusters 30%  Writing clusters 30%  Writing clusters 30%  Writing clusters 31%  Writing clusters 31%  Writing clusters 32%  Writing clusters 32%  Writing clusters 32%  Writing clusters 33%  Writing clusters 33%  Writing clusters 34%  Writing clusters 34%  Writing clusters 34%  Writing clusters 35%  Writing clusters 35%  Writing clusters 36%  Writing clusters 36%  Writing clusters 36%  Writing clusters 37%  Writing clusters 37%  Writing clusters 38%  Writing clusters 38%  Writing clusters 38%  Writing clusters 39%  Writing clusters 39%  Writing clusters 40%  Writing clusters 40%  Writing clusters 40%  Writing clusters 41%  Writing clusters 41%  Writing clusters 42%  Writing clusters 42%  Writing clusters 42%  Writing clusters 43%  Writing clusters 43%  Writing clusters 44%  Writing clusters 44%  Writing clusters 44%  Writing clusters 45%  Writing clusters 45%  Writing clusters 46%  Writing clusters 46%  Writing clusters 46%  Writing clusters 47%  Writing clusters 47%  Writing clusters 48%  Writing clusters 48%  Writing clusters 48%  Writing clusters 49%  Writing clusters 49%  Writing clusters 50%  Writing clusters 50%  Writing clusters 50%  Writing clusters 51%  Writing clusters 51%  Writing clusters 52%  Writing clusters 52%  Writing clusters 52%  Writing clusters 53%  Writing clusters 53%  Writing clusters 54%  Writing clusters 54%  Writing clusters 54%  Writing clusters 55%  Writing clusters 55%  Writing clusters 56%  Writing clusters 56%  Writing clusters 56%  Writing clusters 57%  Writing clusters 57%  Writing clusters 58%  Writing clusters 58%  Writing clusters 58%  Writing clusters 59%  Writing clusters 59%  Writing clusters 60%  Writing clusters 60%  Writing clusters 60%  Writing clusters 61%  Writing clusters 61%  Writing clusters 62%  Writing clusters 62%  Writing clusters 62%  Writing clusters 63%  Writing clusters 63%  Writing clusters 64%  Writing clusters 64%  Writing clusters 64%  Writing clusters 65%  Writing clusters 65%  Writing clusters 66%  Writing clusters 66%  Writing clusters 66%  Writing clusters 67%  Writing clusters 67%  Writing clusters 68%  Writing clusters 68%  Writing clusters 68%  Writing clusters 69%  Writing clusters 69%  Writing clusters 70%  Writing clusters 70%  Writing clusters 70%  Writing clusters 71%  Writing clusters 71%  Writing clusters 72%  Writing clusters 72%  Writing clusters 72%  Writing clusters 73%  Writing clusters 73%  Writing clusters 74%  Writing clusters 74%  Writing clusters 74%  Writing clusters 75%  Writing clusters 75%  Writing clusters 76%  Writing clusters 76%  Writing clusters 76%  Writing clusters 77%  Writing clusters 77%  Writing clusters 78%  Writing clusters 78%  Writing clusters 78%  Writing clusters 79%  Writing clusters 79%  Writing clusters 80%  Writing clusters 80%  Writing clusters 80%  Writing clusters 81%  Writing clusters 81%  Writing clusters 82%  Writing clusters 82%  Writing clusters 82%  Writing clusters 83%  Writing clusters 83%  Writing clusters 84%  Writing clusters 84%  Writing clusters 84%  Writing clusters 85%  Writing clusters 85%  Writing clusters 86%  Writing clusters 86%  Writing clusters 86%  Writing clusters 87%  Writing clusters 87%  Writing clusters 88%  Writing clusters 88%  Writing clusters 88%  Writing clusters 89%  Writing clusters 89%  Writing clusters 90%  Writing clusters 90%  Writing clusters 90%  Writing clusters 91%  Writing clusters 91%  Writing clusters 92%  Writing clusters 92%  Writing clusters 92%  Writing clusters 93%  Writing clusters 93%  Writing clusters 94%  Writing clusters 94%  Writing clusters 94%  Writing clusters 95%  Writing clusters 95%  Writing clusters 96%  Writing clusters 96%  Writing clusters 96%  Writing clusters 97%  Writing clusters 97%  Writing clusters 98%  Writing clusters 98%  Writing clusters 98%  Writing clusters 99%  Writing clusters 99%  Writing clusters 100%  Writing clusters 100%
    Clusters: 87 Size min 1, max 20, avg 2.9
    Singletons: 35, 14.0% of seqs, 40.2% of clusters
    
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.005
      vsearch/swarm time: 0.881
      total time: 74.658
TEST          cache-data-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results --action cache-data-parameters --extra-args __seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots --datafname test/mishmash.fa
RUN ./bin/partis.py --action cache-parameters --seqfile test/mishmash.fa --is-data --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data --plotdir test/_new-results/test/plots/data
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/652041/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
          1387             198              0                          98              80              20               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/652041/germline-sets (using 26 genes)
           198              35             28                           0               7               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/652041/germline-sets (using 26 genes)
            35               8              0                           0               8               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/652041/germline-sets (using 26 genes)
/usr/lib/pymodules/python2.7/matplotlib/pyplot.py:412: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_num_figures`).
  max_open_warning, RuntimeWarning)
             8               1              0                           0               1               0               0               0             increasing mismatch score (3 --> 4) and rerunning them
      info for 1386      (skipped 0 / 1387 = 0.000 unproductive    1 / 1387 = 0.001 other ) 
   [91mwarning[0m 1 missing annotations (3009114784662815033)
    writing parameters
  plotting parameters
  writing hmms with info from test/_new-results/test/parameters/data/sw
hmm
    writing input
    running
      hmm run time: 32.337
    time to merge csv files: 0.041
    read output
    writing parameters
  plotting parameters
    processed 1383 sequences in 1383 events (3 invalid events)
      1 boundary errors
  writing hmms with info from test/_new-results/test/parameters/data/hmm
      total time: 87.493
TEST                       simulate   ./bin/run-driver.py --label test --stashdir test/_new-results --action simulate --extra-args __n-sim-events:500:__n-leaves:2:__mimic-data-read-length:__seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots
RUN ./bin/partis.py --action simulate --outfname test/_new-results/test/simu.csv --n-sim-events 500 --n-leaves 2 --mimic-data-read-length --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data/hmm
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
simulating
ERROR bad conserved codons, what the hell?
try again: 1
ERROR bad conserved codons, what the hell?
try again: 1
ERROR bad conserved codons, what the hell?
try again: 1
ERROR bad conserved codons, what the hell?
try again: 1
ERROR bad conserved codons, what the hell?
try again: 1
ERROR bad conserved codons, what the hell?
try again: 1
TEST          cache-simu-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results --action cache-simu-parameters --extra-args __seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots
RUN ./bin/partis.py --action cache-parameters --seqfile test/_new-results/test/simu.csv --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/simu --plotdir test/_new-results/test/plots/simu
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/547934/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           992             129              0                          53              52              24               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/547934/germline-sets (using 26 genes)
           129               8              4                           0               4               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/547934/germline-sets (using 26 genes)
             8               4              0                           0               4               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/547934/germline-sets (using 26 genes)
/usr/lib/pymodules/python2.7/matplotlib/pyplot.py:412: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_num_figures`).
  max_open_warning, RuntimeWarning)
             4               2              0                           0               2               0               0               0             increasing mismatch score (3 --> 4) and rerunning them
      info for 990      (skipped 0 / 992 = 0.000 unproductive    2 / 992 = 0.002 other ) 
   [91mwarning[0m 2 missing annotations (-54313333789159748:-9161614439565092097)
    writing parameters
    writing parameters
  plotting parameters
  plotting parameters
  writing hmms with info from test/_new-results/test/parameters/simu/sw
hmm
    writing input
    running
      hmm run time: 16.478
    time to merge csv files: 0.048
    read output
    writing parameters
  plotting parameters
    writing parameters
  plotting parameters
    processed 989 sequences in 989 events (1 invalid events)
  writing hmms with info from test/_new-results/test/parameters/simu/hmm
      WARNING IGHV3-48*01 not found in overall gene probs, returning zero
      WARNING IGHV3-48*01 not found in overall gene probs, returning zero
      total time: 101.585
TEST              annotate-new-simu   ./bin/partis.py --action run-viterbi --seqfile test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --plotdir test/_new-results/simu-new-performance --plot-performance --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-new-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/707988/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           992             129              0                          53              52              24               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/707988/germline-sets (using 26 genes)
           129               8              4                           0               4               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/707988/germline-sets (using 26 genes)
    skipping performance evaluation of -5204308891749217752 because of indels
    skipping performance evaluation of -3307202274477556678 because of indels
    skipping performance evaluation of -679373505634261555 because of indels
    skipping performance evaluation of 1387915176058769153 because of indels
             8               4              0                           0               4               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/707988/germline-sets (using 26 genes)
/usr/lib/pymodules/python2.7/matplotlib/pyplot.py:412: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_num_figures`).
  max_open_warning, RuntimeWarning)
             4               2              0                           0               2               0               0               0             increasing mismatch score (3 --> 4) and rerunning them
  v_gene
    correct up to allele:  922 / 986  = 0.9351 (-0.927, +0.942)
  d_gene
    correct up to allele:  787 / 986  = 0.7982 (-0.785, +0.810)
  j_gene
    correct up to allele:  874 / 986  = 0.8864 (-0.876, +0.895)
      info for 990      (skipped 0 / 992 = 0.000 unproductive    2 / 992 = 0.002 other ) 
   [91mwarning[0m 2 missing annotations (-54313333789159748:-9161614439565092097)
hmm
    writing input
    running
      hmm run time: 18.165
    time to merge csv files: 0.023
    read output
    skipping performance evaluation of -679373505634261555 because of indels
    skipping performance evaluation of -5204308891749217752 because of indels
    skipping performance evaluation of 1387915176058769153 because of indels
    skipping performance evaluation of -3307202274477556678 because of indels
  v_gene
    correct up to allele:  841 / 985  = 0.8538 (-0.842, +0.864)
  d_gene
    correct up to allele:  811 / 985  = 0.8234 (-0.811, +0.834)
  j_gene
    correct up to allele:  914 / 985  = 0.9279 (-0.919, +0.935)
    processed 989 sequences in 989 events (1 invalid events)
      1 boundary errors
missing 3 input keys
      total time: 44.842
TEST             partition-new-simu   ./bin/partis.py --action partition --seqfile test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --n-max-queries 250 --persistent-cachefname test/_new-results/cache-new-partition.csv --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/partition-new-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/835863/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/835863/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/835863/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/835863/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 14.566
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 57.5533
        calculated   vtb 250    fwd 250   hamming merged 0    naive hfracs 0
      hmm run time: 57.744
--> 250 clusters with 10 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 1
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 225   small lratios: 6   total: 231
        time 3.19146
        calculated   vtb 2    fwd 10   hamming merged 3    naive hfracs 343

      --> proc 3
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 222   small lratios: 9   total: 231
        time 3.69355
        calculated   vtb 1    fwd 12   hamming merged 3    naive hfracs 321

      --> proc 5
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 203   small lratios: 7   total: 210
        time 3.39204
        calculated   vtb 2    fwd 12   hamming merged 4    naive hfracs 341

      --> proc 9
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 206   small lratios: 4   total: 210
        time 3.17122
        calculated   vtb 3    fwd 9   hamming merged 4    naive hfracs 363

      --> proc 4
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 244   small lratios: 9   total: 253
        time 4.94235
        calculated   vtb 1    fwd 13   hamming merged 2    naive hfracs 322

      --> proc 8
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 204   small lratios: 6   total: 210
        time 4.4094
        calculated   vtb 3    fwd 12   hamming merged 2    naive hfracs 363

      --> proc 6
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 221   small lratios: 10   total: 231
        time 5.59703
        calculated   vtb 1    fwd 13   hamming merged 3    naive hfracs 321

      --> proc 7
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 283   small lratios: 17   total: 300
        time 5.61555
        calculated   vtb 0    fwd 17   hamming merged 0    naive hfracs 300

      --> proc 0
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 181   small lratios: 9   total: 190
        time 6.10238
        calculated   vtb 3    fwd 17   hamming merged 5    naive hfracs 360

      --> proc 2
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 234   small lratios: 19   total: 253
        time 7.30586
        calculated   vtb 2    fwd 22   hamming merged 1    naive hfracs 345

      hmm run time: 9.076
    time to merge csv files: 0.017
  merged path 0 with 31 glomeration steps and 220 final clusters
        read cached glomeration time: 0.021
      partition step time: 9.385
--> 222 clusters with 7 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 370   small lratios: 8   total: 378
        time 3.8677
        calculated   vtb 3    fwd 12   hamming merged 4    naive hfracs 580

      --> proc 1
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 421   small lratios: 14   total: 435
        time 4.8793
        calculated   vtb 0    fwd 15   hamming merged 2    naive hfracs 496

      --> proc 4
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 344   small lratios: 7   total: 351
        time 4.06325
        calculated   vtb 1    fwd 13   hamming merged 5    naive hfracs 522

      --> proc 5
        read 387 cached logprobs and 280 naive seqs
        stopping after drop -13644.9 --> -13650
        time 4.51957
        calculated   vtb 4    fwd 10   hamming merged 5    naive hfracs 546

      --> proc 6
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 343   small lratios: 8   total: 351
        time 5.99559
        calculated   vtb 3    fwd 13   hamming merged 4    naive hfracs 546

      --> proc 2
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 384   small lratios: 22   total: 406
        time 7.84458
        calculated   vtb 1    fwd 24   hamming merged 3    naive hfracs 524

      --> proc 3
        read 387 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 307   small lratios: 18   total: 325
        time 7.19345
        calculated   vtb 2    fwd 25   hamming merged 6    naive hfracs 547

      hmm run time: 9.075
    time to merge csv files: 0.015
  merged path 0 with 30 glomeration steps and 193 final clusters
        read cached glomeration time: 0.016
      partition step time: 9.475
--> 197 clusters with 5 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 646   small lratios: 20   total: 666
        time 6.33702
        calculated   vtb 2    fwd 19   hamming merged 3    naive hfracs 891

      --> proc 3
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 519   small lratios: 9   total: 528
        time 6.90433
        calculated   vtb 4    fwd 16   hamming merged 5    naive hfracs 875

      --> proc 4
        read 499 cached logprobs and 309 naive seqs
        stopping after drop -17720.5 --> -17744.7
        time 7.1973
        calculated   vtb 2    fwd 23   hamming merged 5    naive hfracs 775

      --> proc 2
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 562   small lratios: 33   total: 595
        time 9.74682
        calculated   vtb 2    fwd 30   hamming merged 3    naive hfracs 810

      --> proc 1
        read 499 cached logprobs and 309 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 623   small lratios: 43   total: 666
        time 17.5172
        calculated   vtb 2    fwd 42   hamming merged 2    naive hfracs 853

      hmm run time: 19.066
    time to merge csv files: 0.015
  merged path 0 with 22 glomeration steps and 176 final clusters
        read cached glomeration time: 0.111
      partition step time: 19.539
--> 178 clusters with 3 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1295   small lratios: 31   total: 1326
        time 11.7109
        calculated   vtb 8    fwd 38   hamming merged 7    naive hfracs 2206

      --> proc 1
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1120   small lratios: 56   total: 1176
        time 21.7269
        calculated   vtb 5    fwd 68   hamming merged 10    naive hfracs 1961

      --> proc 2
        read 629 cached logprobs and 329 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 1425   small lratios: 60   total: 1485
        time 26.4312
        calculated   vtb 1    fwd 62   hamming merged 4    naive hfracs 1765

      hmm run time: 28.059
    time to merge csv files: 0.019
  merged path 0 with 23 glomeration steps and 156 final clusters
        read cached glomeration time: 0.009
      partition step time: 28.433
--> 159 clusters with 2 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
      --> proc 0
        read 797 cached logprobs and 351 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 2261   small lratios: 85   total: 2346
        time 27.156
        calculated   vtb 6    fwd 74   hamming merged 10    naive hfracs 3657

      --> proc 1
        read 797 cached logprobs and 351 naive seqs
        stopping after drop -45687.6 --> -45820.6
        time 27.1155
        calculated   vtb 5    fwd 77   hamming merged 7    naive hfracs 3371

      hmm run time: 29.048
    time to merge csv files: 0.023
  merged path 0 with 20 glomeration steps and 140 final clusters
        read cached glomeration time: 0.012
      partition step time: 29.421
--> 141 clusters with 1 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.015 0.109
    running
        read 948 cached logprobs and 369 naive seqs
        stopping after drop -91699.4 --> -91710.6
        time 59.8692
        calculated   vtb 12    fwd 148   hamming merged 22    naive hfracs 11234
â€˜test/_new-results/cache-new-partition.csv.tmpâ€™ -> â€˜test/_new-results/cache-new-partition.csvâ€™
      hmm run time: 60.096
  merged path 0 with 23 glomeration steps and 119 final clusters
        read cached glomeration time: 0.006
      partition step time: 60.801
      loop time: 157.054
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.002
      write time: 0.009
    time to merge csv files: 0.049
      total time: 231.056
TEST       point-partition-new-simu   ./bin/partis.py --action partition --naive-hamming --seqfile test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/point-partition-new-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/534379/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/534379/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/534379/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/534379/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 16.616
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 27.7392
        calculated   vtb 250    fwd 0   hamming merged 0    naive hfracs 0
      hmm run time: 27.985
--> 250 clusters with 10 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 4
        read 0 cached logprobs and 250 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 0.93684
        calculated   vtb 1    fwd 0   hamming merged 2    naive hfracs 322

      --> proc 6
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0453889
        time 0.986081
        calculated   vtb 1    fwd 0   hamming merged 3    naive hfracs 321

      --> proc 1
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 1.13209
        calculated   vtb 3    fwd 0   hamming merged 4    naive hfracs 363

      --> proc 2
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 1.84437
        calculated   vtb 4    fwd 0   hamming merged 4    naive hfracs 386

      --> proc 3
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0453889
        time 1.42787
        calculated   vtb 3    fwd 0   hamming merged 5    naive hfracs 360

      --> proc 5
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0453889
        time 1.43569
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 395

      --> proc 7
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0453889
        time 1.39044
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 366

      --> proc 8
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0453889
        time 1.32753
        calculated   vtb 3    fwd 0   hamming merged 4    naive hfracs 363

      --> proc 9
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0453889
        time 1.59087
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 382

      --> proc 0
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0453889
        time 2.7171
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 395

      hmm run time: 4.089
    time to merge csv files: 0.014
  merged path 0 with 45 glomeration steps and 206 final clusters
        read cached glomeration time: 0.019
      partition step time: 4.446
--> 206 clusters with 7 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 6
        read 0 cached logprobs and 294 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0453889
        time 0.892535
        calculated   vtb 1    fwd 0   hamming merged 3    naive hfracs 431

      --> proc 0
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 1.38601
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 555

      --> proc 1
        read 0 cached logprobs and 294 naive seqs
        stop with all 300 / 300 hamming distances greater than 0.0453889
        time 1.78607
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 537

      --> proc 3
        read 0 cached logprobs and 294 naive seqs
        stop with all 351 / 351 hamming distances greater than 0.0453889
        time 1.04128
        calculated   vtb 2    fwd 0   hamming merged 2    naive hfracs 459

      --> proc 5
        read 0 cached logprobs and 294 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0453889
        time 1.09228
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 457

      --> proc 2
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 2.44937
        calculated   vtb 7    fwd 0   hamming merged 7    naive hfracs 610

      --> proc 4
        read 0 cached logprobs and 294 naive seqs
        stop with all 253 / 253 hamming distances greater than 0.0453889
        time 2.41617
        calculated   vtb 5    fwd 0   hamming merged 6    naive hfracs 526

      hmm run time: 4.072
    time to merge csv files: 0.015
  merged path 0 with 34 glomeration steps and 173 final clusters
        read cached glomeration time: 0.011
      partition step time: 4.465
--> 173 clusters with 5 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 1
        read 0 cached logprobs and 327 naive seqs
        stop with all 435 / 435 hamming distances greater than 0.0453889
        time 0.840891
        calculated   vtb 1    fwd 0   hamming merged 5    naive hfracs 624

      --> proc 0
        read 0 cached logprobs and 327 naive seqs
        stop with all 465 / 465 hamming distances greater than 0.0453889
        time 1.3103
        calculated   vtb 2    fwd 0   hamming merged 4    naive hfracs 656

      --> proc 2
        read 0 cached logprobs and 327 naive seqs
        stop with all 496 / 496 hamming distances greater than 0.0453889
        time 1.0818
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 658

      --> proc 4
        read 0 cached logprobs and 327 naive seqs
        stop with all 465 / 465 hamming distances greater than 0.0453889
        time 1.37702
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 654

      --> proc 3
        read 0 cached logprobs and 327 naive seqs
        stop with all 351 / 351 hamming distances greater than 0.0453889
        time 3.08806
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 701

      hmm run time: 5.056
    time to merge csv files: 0.019
  merged path 0 with 23 glomeration steps and 151 final clusters
        read cached glomeration time: 0.211
      partition step time: 5.620
--> 151 clusters with 3 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 0
        read 0 cached logprobs and 349 naive seqs
        stop with all 903 / 903 hamming distances greater than 0.0453889
        time 1.78462
        calculated   vtb 3    fwd 0   hamming merged 8    naive hfracs 1404

      --> proc 1
        read 0 cached logprobs and 349 naive seqs
        stop with all 1081 / 1081 hamming distances greater than 0.0453889
        time 1.33873
        calculated   vtb 3    fwd 0   hamming merged 3    naive hfracs 1366

      --> proc 2
        read 0 cached logprobs and 349 naive seqs
        stop with all 861 / 861 hamming distances greater than 0.0453889
        time 2.33988
        calculated   vtb 7    fwd 0   hamming merged 8    naive hfracs 1533

      hmm run time: 4.032
    time to merge csv files: 0.015
  merged path 0 with 20 glomeration steps and 132 final clusters
        read cached glomeration time: 0.006
      partition step time: 4.373
--> 132 clusters with 2 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
      --> proc 0
        read 0 cached logprobs and 368 naive seqs
        stop with all 1431 / 1431 hamming distances greater than 0.0453889
        time 3.27935
        calculated   vtb 8    fwd 0   hamming merged 12    naive hfracs 2597

      --> proc 1
        read 0 cached logprobs and 368 naive seqs
        stop with all 1431 / 1431 hamming distances greater than 0.0453889
        time 3.26394
        calculated   vtb 6    fwd 0   hamming merged 12    naive hfracs 2478

      hmm run time: 5.023
    time to merge csv files: 0.014
  merged path 0 with 25 glomeration steps and 108 final clusters
        read cached glomeration time: 0.010
      partition step time: 5.356
--> 108 clusters with 1 procs
hmm
    writing input
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.045 0.045
    running
        read 0 cached logprobs and 392 naive seqs
        stop with all 4371 / 4371 hamming distances greater than 0.0453889
        time 3.72978
        calculated   vtb 10    fwd 0   hamming merged 14    naive hfracs 6753
      hmm run time: 3.819
  merged path 0 with 15 glomeration steps and 94 final clusters
        read cached glomeration time: 0.004
      partition step time: 4.112
      loop time: 28.373
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.005
      write time: 0.009
      total time: 74.989
TEST     vsearch-partition-new-simu   ./bin/partis.py --action partition --naive-vsearch --seqfile test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/vsearch-partition-new-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO clean up print_reco_event, and get it working with indels
    TODO holy crap stop recursively calling add_implicit_info and its ilk from itselvothers
    TODO remove all the columns and all_columns checks (and seq/seqs assertions in add_qr_seqs)
    TODO stop rewriting germlines at every sw step
    TODO make sure reset_effective_erosions_and_effective_insertions is actually modifying everything it should be
    TODO move compare.py calls into import statements so you're not importing shit so many times
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/883185/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              27              0                          12              10               5               0               0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/883185/germline-sets (using 26 genes)
            27               3              2                           0               1               0               0               0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/883185/germline-sets (using 26 genes)
             3               1              0                           0               1               0               0               0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/883185/germline-sets (using 26 genes)
             1         all done
      info for 250 
        water time: 13.719
    precache procs 1
hmm
    writing input
      caching all naive sequences
    running
        cachefile d.n.e.
        time 58.7189
        calculated   vtb 250    fwd 250   hamming merged 0    naive hfracs 0
      hmm run time: 58.833
  auto hamming bounds:
      0.112 mutation in test/_new-results/test/parameters/simu/hmm
       naive hamming bounds: 0.032 0.032
    using hfrac bound for vsearch 0.032
  out:
    vsearch v1.1.3_linux_x86_64, 62.8GB RAM, 16 cores
    https://github.com/torognes/vsearch
    
    
  err:
    Reading file /tmp/dralph/hmms/883185/simu.fasta 0%  Reading file /tmp/dralph/hmms/883185/simu.fasta 0%  Reading file /tmp/dralph/hmms/883185/simu.fasta 1%  Reading file /tmp/dralph/hmms/883185/simu.fasta 2%  Reading file /tmp/dralph/hmms/883185/simu.fasta 3%  Reading file /tmp/dralph/hmms/883185/simu.fasta 4%  Reading file /tmp/dralph/hmms/883185/simu.fasta 4%  Reading file /tmp/dralph/hmms/883185/simu.fasta 5%  Reading file /tmp/dralph/hmms/883185/simu.fasta 6%  Reading file /tmp/dralph/hmms/883185/simu.fasta 7%  Reading file /tmp/dralph/hmms/883185/simu.fasta 8%  Reading file /tmp/dralph/hmms/883185/simu.fasta 8%  Reading file /tmp/dralph/hmms/883185/simu.fasta 9%  Reading file /tmp/dralph/hmms/883185/simu.fasta 10%  Reading file /tmp/dralph/hmms/883185/simu.fasta 11%  Reading file /tmp/dralph/hmms/883185/simu.fasta 12%  Reading file /tmp/dralph/hmms/883185/simu.fasta 12%  Reading file /tmp/dralph/hmms/883185/simu.fasta 13%  Reading file /tmp/dralph/hmms/883185/simu.fasta 14%  Reading file /tmp/dralph/hmms/883185/simu.fasta 15%  Reading file /tmp/dralph/hmms/883185/simu.fasta 16%  Reading file /tmp/dralph/hmms/883185/simu.fasta 16%  Reading file /tmp/dralph/hmms/883185/simu.fasta 17%  Reading file /tmp/dralph/hmms/883185/simu.fasta 18%  Reading file /tmp/dralph/hmms/883185/simu.fasta 19%  Reading file /tmp/dralph/hmms/883185/simu.fasta 20%  Reading file /tmp/dralph/hmms/883185/simu.fasta 20%  Reading file /tmp/dralph/hmms/883185/simu.fasta 21%  Reading file /tmp/dralph/hmms/883185/simu.fasta 22%  Reading file /tmp/dralph/hmms/883185/simu.fasta 23%  Reading file /tmp/dralph/hmms/883185/simu.fasta 24%  Reading file /tmp/dralph/hmms/883185/simu.fasta 24%  Reading file /tmp/dralph/hmms/883185/simu.fasta 25%  Reading file /tmp/dralph/hmms/883185/simu.fasta 26%  Reading file /tmp/dralph/hmms/883185/simu.fasta 27%  Reading file /tmp/dralph/hmms/883185/simu.fasta 28%  Reading file /tmp/dralph/hmms/883185/simu.fasta 28%  Reading file /tmp/dralph/hmms/883185/simu.fasta 29%  Reading file /tmp/dralph/hmms/883185/simu.fasta 30%  Reading file /tmp/dralph/hmms/883185/simu.fasta 31%  Reading file /tmp/dralph/hmms/883185/simu.fasta 32%  Reading file /tmp/dralph/hmms/883185/simu.fasta 32%  Reading file /tmp/dralph/hmms/883185/simu.fasta 33%  Reading file /tmp/dralph/hmms/883185/simu.fasta 34%  Reading file /tmp/dralph/hmms/883185/simu.fasta 35%  Reading file /tmp/dralph/hmms/883185/simu.fasta 36%  Reading file /tmp/dralph/hmms/883185/simu.fasta 36%  Reading file /tmp/dralph/hmms/883185/simu.fasta 37%  Reading file /tmp/dralph/hmms/883185/simu.fasta 38%  Reading file /tmp/dralph/hmms/883185/simu.fasta 39%  Reading file /tmp/dralph/hmms/883185/simu.fasta 40%  Reading file /tmp/dralph/hmms/883185/simu.fasta 40%  Reading file /tmp/dralph/hmms/883185/simu.fasta 41%  Reading file /tmp/dralph/hmms/883185/simu.fasta 42%  Reading file /tmp/dralph/hmms/883185/simu.fasta 43%  Reading file /tmp/dralph/hmms/883185/simu.fasta 44%  Reading file /tmp/dralph/hmms/883185/simu.fasta 44%  Reading file /tmp/dralph/hmms/883185/simu.fasta 45%  Reading file /tmp/dralph/hmms/883185/simu.fasta 46%  Reading file /tmp/dralph/hmms/883185/simu.fasta 47%  Reading file /tmp/dralph/hmms/883185/simu.fasta 48%  Reading file /tmp/dralph/hmms/883185/simu.fasta 48%  Reading file /tmp/dralph/hmms/883185/simu.fasta 49%  Reading file /tmp/dralph/hmms/883185/simu.fasta 50%  Reading file /tmp/dralph/hmms/883185/simu.fasta 51%  Reading file /tmp/dralph/hmms/883185/simu.fasta 52%  Reading file /tmp/dralph/hmms/883185/simu.fasta 52%  Reading file /tmp/dralph/hmms/883185/simu.fasta 53%  Reading file /tmp/dralph/hmms/883185/simu.fasta 54%  Reading file /tmp/dralph/hmms/883185/simu.fasta 55%  Reading file /tmp/dralph/hmms/883185/simu.fasta 56%  Reading file /tmp/dralph/hmms/883185/simu.fasta 56%  Reading file /tmp/dralph/hmms/883185/simu.fasta 57%  Reading file /tmp/dralph/hmms/883185/simu.fasta 58%  Reading file /tmp/dralph/hmms/883185/simu.fasta 59%  Reading file /tmp/dralph/hmms/883185/simu.fasta 60%  Reading file /tmp/dralph/hmms/883185/simu.fasta 60%  Reading file /tmp/dralph/hmms/883185/simu.fasta 61%  Reading file /tmp/dralph/hmms/883185/simu.fasta 62%  Reading file /tmp/dralph/hmms/883185/simu.fasta 63%  Reading file /tmp/dralph/hmms/883185/simu.fasta 64%  Reading file /tmp/dralph/hmms/883185/simu.fasta 64%  Reading file /tmp/dralph/hmms/883185/simu.fasta 65%  Reading file /tmp/dralph/hmms/883185/simu.fasta 66%  Reading file /tmp/dralph/hmms/883185/simu.fasta 67%  Reading file /tmp/dralph/hmms/883185/simu.fasta 68%  Reading file /tmp/dralph/hmms/883185/simu.fasta 68%  Reading file /tmp/dralph/hmms/883185/simu.fasta 69%  Reading file /tmp/dralph/hmms/883185/simu.fasta 70%  Reading file /tmp/dralph/hmms/883185/simu.fasta 71%  Reading file /tmp/dralph/hmms/883185/simu.fasta 72%  Reading file /tmp/dralph/hmms/883185/simu.fasta 72%  Reading file /tmp/dralph/hmms/883185/simu.fasta 73%  Reading file /tmp/dralph/hmms/883185/simu.fasta 74%  Reading file /tmp/dralph/hmms/883185/simu.fasta 75%  Reading file /tmp/dralph/hmms/883185/simu.fasta 76%  Reading file /tmp/dralph/hmms/883185/simu.fasta 76%  Reading file /tmp/dralph/hmms/883185/simu.fasta 77%  Reading file /tmp/dralph/hmms/883185/simu.fasta 78%  Reading file /tmp/dralph/hmms/883185/simu.fasta 79%  Reading file /tmp/dralph/hmms/883185/simu.fasta 80%  Reading file /tmp/dralph/hmms/883185/simu.fasta 80%  Reading file /tmp/dralph/hmms/883185/simu.fasta 81%  Reading file /tmp/dralph/hmms/883185/simu.fasta 82%  Reading file /tmp/dralph/hmms/883185/simu.fasta 83%  Reading file /tmp/dralph/hmms/883185/simu.fasta 84%  Reading file /tmp/dralph/hmms/883185/simu.fasta 84%  Reading file /tmp/dralph/hmms/883185/simu.fasta 85%  Reading file /tmp/dralph/hmms/883185/simu.fasta 86%  Reading file /tmp/dralph/hmms/883185/simu.fasta 87%  Reading file /tmp/dralph/hmms/883185/simu.fasta 88%  Reading file /tmp/dralph/hmms/883185/simu.fasta 88%  Reading file /tmp/dralph/hmms/883185/simu.fasta 89%  Reading file /tmp/dralph/hmms/883185/simu.fasta 90%  Reading file /tmp/dralph/hmms/883185/simu.fasta 91%  Reading file /tmp/dralph/hmms/883185/simu.fasta 92%  Reading file /tmp/dralph/hmms/883185/simu.fasta 92%  Reading file /tmp/dralph/hmms/883185/simu.fasta 93%  Reading file /tmp/dralph/hmms/883185/simu.fasta 94%  Reading file /tmp/dralph/hmms/883185/simu.fasta 95%  Reading file /tmp/dralph/hmms/883185/simu.fasta 96%  Reading file /tmp/dralph/hmms/883185/simu.fasta 96%  Reading file /tmp/dralph/hmms/883185/simu.fasta 97%  Reading file /tmp/dralph/hmms/883185/simu.fasta 98%  Reading file /tmp/dralph/hmms/883185/simu.fasta 99%  Reading file /tmp/dralph/hmms/883185/simu.fasta 100%  Reading file /tmp/dralph/hmms/883185/simu.fasta 100%
    100750 nt in 250 seqs, min 403, max 403, avg 403
    Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 1%  Indexing sequences 1%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 3%  Indexing sequences 3%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 5%  Indexing sequences 5%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 7%  Indexing sequences 7%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 9%  Indexing sequences 9%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 11%  Indexing sequences 11%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 13%  Indexing sequences 13%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 15%  Indexing sequences 15%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 17%  Indexing sequences 17%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 19%  Indexing sequences 19%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 21%  Indexing sequences 21%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 23%  Indexing sequences 23%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 25%  Indexing sequences 25%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 27%  Indexing sequences 27%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 29%  Indexing sequences 29%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 31%  Indexing sequences 31%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 33%  Indexing sequences 33%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 35%  Indexing sequences 35%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 37%  Indexing sequences 37%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 39%  Indexing sequences 39%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 41%  Indexing sequences 41%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 43%  Indexing sequences 43%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 45%  Indexing sequences 45%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 47%  Indexing sequences 47%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 49%  Indexing sequences 49%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 51%  Indexing sequences 51%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 53%  Indexing sequences 53%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 55%  Indexing sequences 55%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 57%  Indexing sequences 57%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 59%  Indexing sequences 59%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 61%  Indexing sequences 61%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 63%  Indexing sequences 63%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 65%  Indexing sequences 65%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 67%  Indexing sequences 67%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 69%  Indexing sequences 69%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 71%  Indexing sequences 71%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 73%  Indexing sequences 73%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 75%  Indexing sequences 75%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 77%  Indexing sequences 77%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 79%  Indexing sequences 79%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 81%  Indexing sequences 81%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 83%  Indexing sequences 83%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 85%  Indexing sequences 85%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 87%  Indexing sequences 87%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 89%  Indexing sequences 89%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 91%  Indexing sequences 91%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 93%  Indexing sequences 93%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 95%  Indexing sequences 95%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 97%  Indexing sequences 97%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 99%  Indexing sequences 99%  Indexing sequences 100%  Indexing sequences 100%
    Masking 0%  Masking 100%
    Sorting by length 0%  Sorting by length 100%
    Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 1%  Counting unique k-mers 1%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 3%  Counting unique k-mers 3%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 5%  Counting unique k-mers 5%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 7%  Counting unique k-mers 7%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 9%  Counting unique k-mers 9%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 11%  Counting unique k-mers 11%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 13%  Counting unique k-mers 13%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 15%  Counting unique k-mers 15%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 17%  Counting unique k-mers 17%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 19%  Counting unique k-mers 19%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 21%  Counting unique k-mers 21%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 23%  Counting unique k-mers 23%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 25%  Counting unique k-mers 25%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 27%  Counting unique k-mers 27%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 29%  Counting unique k-mers 29%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 31%  Counting unique k-mers 31%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 33%  Counting unique k-mers 33%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 35%  Counting unique k-mers 35%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 37%  Counting unique k-mers 37%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 39%  Counting unique k-mers 39%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 41%  Counting unique k-mers 41%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 43%  Counting unique k-mers 43%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 45%  Counting unique k-mers 45%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 47%  Counting unique k-mers 47%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 49%  Counting unique k-mers 49%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 51%  Counting unique k-mers 51%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 53%  Counting unique k-mers 53%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 55%  Counting unique k-mers 55%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 57%  Counting unique k-mers 57%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 59%  Counting unique k-mers 59%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 61%  Counting unique k-mers 61%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 63%  Counting unique k-mers 63%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 65%  Counting unique k-mers 65%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 67%  Counting unique k-mers 67%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 69%  Counting unique k-mers 69%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 71%  Counting unique k-mers 71%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 73%  Counting unique k-mers 73%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 75%  Counting unique k-mers 75%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 77%  Counting unique k-mers 77%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 79%  Counting unique k-mers 79%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 81%  Counting unique k-mers 81%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 83%  Counting unique k-mers 83%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 85%  Counting unique k-mers 85%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 87%  Counting unique k-mers 87%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 89%  Counting unique k-mers 89%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 91%  Counting unique k-mers 91%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 93%  Counting unique k-mers 93%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 95%  Counting unique k-mers 95%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 97%  Counting unique k-mers 97%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 99%  Counting unique k-mers 99%  Counting unique k-mers 100%  Counting unique k-mers 100%
    Clustering 0%  Clustering 4%  Clustering 8%  Clustering 12%  Clustering 16%  Clustering 20%  Clustering 24%  Clustering 28%  Clustering 32%  Clustering 36%  Clustering 40%  Clustering 44%  Clustering 48%  Clustering 52%  Clustering 56%  Clustering 60%  Clustering 64%  Clustering 68%  Clustering 72%  Clustering 76%  Clustering 80%  Clustering 84%  Clustering 88%  Clustering 92%  Clustering 96%  Clustering 100%  Clustering 100%
    Writing clusters 0%  Writing clusters 0%  Writing clusters 0%  Writing clusters 1%  Writing clusters 1%  Writing clusters 2%  Writing clusters 2%  Writing clusters 2%  Writing clusters 3%  Writing clusters 3%  Writing clusters 4%  Writing clusters 4%  Writing clusters 4%  Writing clusters 5%  Writing clusters 5%  Writing clusters 6%  Writing clusters 6%  Writing clusters 6%  Writing clusters 7%  Writing clusters 7%  Writing clusters 8%  Writing clusters 8%  Writing clusters 8%  Writing clusters 9%  Writing clusters 9%  Writing clusters 10%  Writing clusters 10%  Writing clusters 10%  Writing clusters 11%  Writing clusters 11%  Writing clusters 12%  Writing clusters 12%  Writing clusters 12%  Writing clusters 13%  Writing clusters 13%  Writing clusters 14%  Writing clusters 14%  Writing clusters 14%  Writing clusters 15%  Writing clusters 15%  Writing clusters 16%  Writing clusters 16%  Writing clusters 16%  Writing clusters 17%  Writing clusters 17%  Writing clusters 18%  Writing clusters 18%  Writing clusters 18%  Writing clusters 19%  Writing clusters 19%  Writing clusters 20%  Writing clusters 20%  Writing clusters 20%  Writing clusters 21%  Writing clusters 21%  Writing clusters 22%  Writing clusters 22%  Writing clusters 22%  Writing clusters 23%  Writing clusters 23%  Writing clusters 24%  Writing clusters 24%  Writing clusters 24%  Writing clusters 25%  Writing clusters 25%  Writing clusters 26%  Writing clusters 26%  Writing clusters 26%  Writing clusters 27%  Writing clusters 27%  Writing clusters 28%  Writing clusters 28%  Writing clusters 28%  Writing clusters 29%  Writing clusters 29%  Writing clusters 30%  Writing clusters 30%  Writing clusters 30%  Writing clusters 31%  Writing clusters 31%  Writing clusters 32%  Writing clusters 32%  Writing clusters 32%  Writing clusters 33%  Writing clusters 33%  Writing clusters 34%  Writing clusters 34%  Writing clusters 34%  Writing clusters 35%  Writing clusters 35%  Writing clusters 36%  Writing clusters 36%  Writing clusters 36%  Writing clusters 37%  Writing clusters 37%  Writing clusters 38%  Writing clusters 38%  Writing clusters 38%  Writing clusters 39%  Writing clusters 39%  Writing clusters 40%  Writing clusters 40%  Writing clusters 40%  Writing clusters 41%  Writing clusters 41%  Writing clusters 42%  Writing clusters 42%  Writing clusters 42%  Writing clusters 43%  Writing clusters 43%  Writing clusters 44%  Writing clusters 44%  Writing clusters 44%  Writing clusters 45%  Writing clusters 45%  Writing clusters 46%  Writing clusters 46%  Writing clusters 46%  Writing clusters 47%  Writing clusters 47%  Writing clusters 48%  Writing clusters 48%  Writing clusters 48%  Writing clusters 49%  Writing clusters 49%  Writing clusters 50%  Writing clusters 50%  Writing clusters 50%  Writing clusters 51%  Writing clusters 51%  Writing clusters 52%  Writing clusters 52%  Writing clusters 52%  Writing clusters 53%  Writing clusters 53%  Writing clusters 54%  Writing clusters 54%  Writing clusters 54%  Writing clusters 55%  Writing clusters 55%  Writing clusters 56%  Writing clusters 56%  Writing clusters 56%  Writing clusters 57%  Writing clusters 57%  Writing clusters 58%  Writing clusters 58%  Writing clusters 58%  Writing clusters 59%  Writing clusters 59%  Writing clusters 60%  Writing clusters 60%  Writing clusters 60%  Writing clusters 61%  Writing clusters 61%  Writing clusters 62%  Writing clusters 62%  Writing clusters 62%  Writing clusters 63%  Writing clusters 63%  Writing clusters 64%  Writing clusters 64%  Writing clusters 64%  Writing clusters 65%  Writing clusters 65%  Writing clusters 66%  Writing clusters 66%  Writing clusters 66%  Writing clusters 67%  Writing clusters 67%  Writing clusters 68%  Writing clusters 68%  Writing clusters 68%  Writing clusters 69%  Writing clusters 69%  Writing clusters 70%  Writing clusters 70%  Writing clusters 70%  Writing clusters 71%  Writing clusters 71%  Writing clusters 72%  Writing clusters 72%  Writing clusters 72%  Writing clusters 73%  Writing clusters 73%  Writing clusters 74%  Writing clusters 74%  Writing clusters 74%  Writing clusters 75%  Writing clusters 75%  Writing clusters 76%  Writing clusters 76%  Writing clusters 76%  Writing clusters 77%  Writing clusters 77%  Writing clusters 78%  Writing clusters 78%  Writing clusters 78%  Writing clusters 79%  Writing clusters 79%  Writing clusters 80%  Writing clusters 80%  Writing clusters 80%  Writing clusters 81%  Writing clusters 81%  Writing clusters 82%  Writing clusters 82%  Writing clusters 82%  Writing clusters 83%  Writing clusters 83%  Writing clusters 84%  Writing clusters 84%  Writing clusters 84%  Writing clusters 85%  Writing clusters 85%  Writing clusters 86%  Writing clusters 86%  Writing clusters 86%  Writing clusters 87%  Writing clusters 87%  Writing clusters 88%  Writing clusters 88%  Writing clusters 88%  Writing clusters 89%  Writing clusters 89%  Writing clusters 90%  Writing clusters 90%  Writing clusters 90%  Writing clusters 91%  Writing clusters 91%  Writing clusters 92%  Writing clusters 92%  Writing clusters 92%  Writing clusters 93%  Writing clusters 93%  Writing clusters 94%  Writing clusters 94%  Writing clusters 94%  Writing clusters 95%  Writing clusters 95%  Writing clusters 96%  Writing clusters 96%  Writing clusters 96%  Writing clusters 97%  Writing clusters 97%  Writing clusters 98%  Writing clusters 98%  Writing clusters 98%  Writing clusters 99%  Writing clusters 99%  Writing clusters 100%  Writing clusters 100%
    Clusters: 87 Size min 1, max 20, avg 2.9
    Singletons: 35, 14.0% of seqs, 40.2% of clusters
    
    checking partition with 250 ids
      looking for 250 ids from input info
      check time: 0.005
      vsearch/swarm time: 1.055
      total time: 75.117
