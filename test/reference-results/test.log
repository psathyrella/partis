TEST              annotate-ref-simu   ./bin/partis run-viterbi --plotdir test/_new-results/simu-ref-performance --plot-performance --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-ref-simu.csv
26 [10, 10, 6]
running viterbi
smith-waterman
test/reference-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='run-viterbi', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f016a527f50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/reference-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/annotate-ref-simu.csv', parameter_dir='test/reference-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=True, plotdir='test/_new-results/simu-ref-performance', presto_output=False, print_cluster_annotations=None, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/346203')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           979             154              0                          59              65              27               0               3             increasing mismatch score (1 --> 2) and rerunning them
           154              12              6                           0               4               0               1               1             rerunning for indels
    skipping performance evaluation of -147090357821815167 because of indels
    skipping performance evaluation of 4101186145082612583 because of indels
    skipping performance evaluation of -2257160329299464390 because of indels
    skipping performance evaluation of 572542934422216884 because of indels
            12               8              0                           0               4               0               1               3             increasing mismatch score (2 --> 3) and rerunning them
/home/dralph/.local/lib/python2.7/site-packages/IPython/html.py:14: ShimWarning: The `IPython.html` package has been deprecated. You should import from `notebook` instead. `IPython.html.widgets` has moved to `ipywidgets`.
  "`IPython.html.widgets` has moved to `ipywidgets`.", ShimWarning)
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/pyplot.py:516: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
             8               5              0                           0               3               0               0               2             increasing mismatch score (3 --> 4) and rerunning them
  v_gene
    correct up to allele:  908 / 970  = 0.9361 (-0.928, +0.943)
  d_gene
    correct up to allele:  785 / 970  = 0.8093 (-0.796, +0.821)
  j_gene
    correct up to allele:  849 / 970  = 0.8753 (-0.864, +0.885)
      info for 974      (skipped 0 / 979 = 0.00 unproductive    5 / 979 = 0.01 other ) 
   [91mwarning[0m 5 missing annotations (988368265964906807:1775482691619026262:-6502313822175126047:-8328172869839560580:8022407927244619365)
        water time: 20.3
hmm
    writing input
    running 10 procs
      --> proc 2
        calcd:   vtb 98    fwd 0   
        time: bcrham 5.4

      --> proc 4
        calcd:   vtb 97    fwd 0   
        time: bcrham 5.7

      --> proc 8
        calcd:   vtb 97    fwd 0   
        time: bcrham 5.7

      --> proc 9
        calcd:   vtb 97    fwd 0   
        time: bcrham 5.6

      --> proc 0
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.3

      --> proc 1
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.7

      --> proc 3
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.3

      --> proc 5
        calcd:   vtb 97    fwd 0   
        time: bcrham 7.0

      --> proc 7
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.5

      --> proc 6
        calcd:   vtb 97    fwd 0   
        time: bcrham 7.7

      time waiting for bcrham: 9.1
    read output
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/axes/_axes.py:519: UserWarning: No labelled objects found. Use label='...' kwarg on individual plots.
  warnings.warn("No labelled objects found. "
    skipping performance evaluation of -147090357821815167 because of indels
    skipping performance evaluation of -2257160329299464390 because of indels
    skipping performance evaluation of 572542934422216884 because of indels
    skipping performance evaluation of 4101186145082612583 because of indels
  v_gene
    correct up to allele:  845 / 970  = 0.8711 (-0.860, +0.881)
  d_gene
    correct up to allele:  818 / 970  = 0.8433 (-0.831, +0.854)
  j_gene
    correct up to allele:  898 / 970  = 0.9258 (-0.917, +0.933)
        974 lines:  processed 974 sequences in 974 events (skipped 0 invalid events)
missing 5 input keys
      hmm step time: 17.6
      total time: 38.4
TEST              annotate-ref-data   ./bin/partis run-viterbi --n-max-queries 50 --infname test/mishmash.fa --parameter-dir test/reference-results/test/parameters/data/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-ref-data.csv
26 [10, 10, 6]
running viterbi
smith-waterman
test/reference-results/test/parameters/data/hmm
Namespace(abbreviate=False, action='run-viterbi', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f39d081cf50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/mishmash.fa', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=True, is_simu=False, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=50, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/annotate-ref-data.csv', parameter_dir='test/reference-results/test/parameters/data/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=None, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/877674')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
            50              13              0                           3               8               2               0               0             increasing mismatch score (1 --> 2) and rerunning them
            13               7              5                           0               1               0               1               0             rerunning for indels
             7               5              0                           0               1               0               2               2             increasing mismatch score (2 --> 3) and rerunning them
             5               5              0                           0               0               0               3               2             increasing mismatch score (3 --> 4) and rerunning them
      info for 45      (skipped 0 / 50 = 0.00 unproductive    5 / 50 = 0.10 other ) 
   [91mwarning[0m 5 missing annotations (crap-1:crap-3:crap-2:crap-5:crap-4)
        water time: 17.6
hmm
    writing input
    running 10 procs
      --> proc 0
        calcd:   vtb 5     fwd 0   
        time: bcrham 1.8

      --> proc 3
        calcd:   vtb 5     fwd 0   
        time: bcrham 1.7

      --> proc 5
        calcd:   vtb 4     fwd 0   
        time: bcrham 1.7

      --> proc 9
        calcd:   vtb 4     fwd 0   
        time: bcrham 1.4

      --> proc 1
        calcd:   vtb 5     fwd 0   
        time: bcrham 2.0

      --> proc 2
        calcd:   vtb 5     fwd 0   
        time: bcrham 2.0

      --> proc 4
        calcd:   vtb 5     fwd 0   
        time: bcrham 2.3

      --> proc 6
        calcd:   vtb 4     fwd 0   
        time: bcrham 2.1

      --> proc 7
        calcd:   vtb 4     fwd 0   
        time: bcrham 2.1

      --> proc 8
        calcd:   vtb 4     fwd 0   
        time: bcrham 2.2

      time waiting for bcrham: 4.1
    read output
        45 lines:  processed 45 sequences in 45 events (skipped 0 invalid events)
missing 5 input keys
      hmm step time: 4.4
      total time: 22.1
TEST             partition-ref-simu   ./bin/partis partition --n-max-queries 250 --persistent-cachefname test/_new-results/cache-ref-partition.csv --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 2 --biggest-naive-seq-cluster-to-calculate 2 --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/partition-ref-simu.csv
26 [10, 10, 6]
partitioning
smith-waterman
test/reference-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=2, biggest_naive_seq_cluster_to_calculate=2, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7ff1918c9f50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/reference-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=250, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=False, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/partition-ref-simu.csv', parameter_dir='test/reference-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname='test/_new-results/cache-ref-partition.csv', plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/228063')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              36              0                          18              13               4               0               1             increasing mismatch score (1 --> 2) and rerunning them
            36               2              1                           0               0               0               0               1             rerunning for indels
             2               1              0                           0               0               0               0               1             increasing mismatch score (2 --> 3) and rerunning them
             1         all done
      info for 250 
        water time: 18.8
hmm
    writing input
    running 10 procs
      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.3

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.9

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.0

      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.0

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.0

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.4

      time waiting for bcrham: 5.1
      hmm step time: 5.2
--> 250 clusters with 10 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 10 procs
      --> proc 0
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 225   small lratio 6   total 231
        writing partitions
        calcd:   vtb 1     fwd 15    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 2.8

      --> proc 1
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 206   small lratio 4   total 210
        writing partitions
        calcd:   vtb 2     fwd 14    hfrac 386         merged:  hfrac 3    lratio 1   
        time: bcrham 2.4

      --> proc 5
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 247   small lratio 6   total 253
        writing partitions
        calcd:   vtb 0     fwd 15    hfrac 345         merged:  hfrac 2    lratio 0   
        time: bcrham 3.3

      --> proc 3
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 263   small lratio 13   total 276
        writing partitions
        calcd:   vtb 0     fwd 28    hfrac 323         merged:  hfrac 1    lratio 0   
        time: bcrham 4.2

      --> proc 4
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 223   small lratio 8   total 231
        writing partitions
        calcd:   vtb 2     fwd 21    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 4.0

      --> proc 7
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 200   small lratio 10   total 210
        writing partitions
        calcd:   vtb 3     fwd 21    hfrac 386         merged:  hfrac 4    lratio 0   
        time: bcrham 4.5

      --> proc 9
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 183   small lratio 7   total 190
        writing partitions
        calcd:   vtb 2     fwd 24    hfrac 405         merged:  hfrac 4    lratio 1   
        time: bcrham 4.4

      --> proc 6
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 160   small lratio 11   total 171
        writing partitions
        calcd:   vtb 4     fwd 31    hfrac 423         merged:  hfrac 5    lratio 1   
        time: bcrham 5.4

      --> proc 8
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 216   small lratio 15   total 231
        writing partitions
        calcd:   vtb 2     fwd 28    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 5.0

      --> proc 2
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 215   small lratio 16   total 231
        writing partitions
        calcd:   vtb 2     fwd 33    hfrac 366         merged:  hfrac 2    lratio 1   
        time: bcrham 8.2

      time waiting for bcrham: 10.1
      hmm step time: 10.3
          n calcd: 248 (24.8 per proc)
--> 216 clusters with 7 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 7 procs
      --> proc 0
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 292   small lratio 8   total 300
        writing partitions
        calcd:   vtb 3     fwd 13    hfrac 624         merged:  hfrac 6    lratio 0   
        time: bcrham 3.6

      --> proc 3
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 391   small lratio 15   total 406
        writing partitions
        calcd:   vtb 1     fwd 21    hfrac 522         merged:  hfrac 1    lratio 1   
        time: bcrham 4.8

      --> proc 5
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 269   small lratio 7   total 276
        writing partitions
        calcd:   vtb 4     fwd 11    hfrac 647         merged:  hfrac 7    lratio 0   
        time: bcrham 4.2

      --> proc 2
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 295   small lratio 5   total 300
        writing partitions
        calcd:   vtb 3     fwd 19    hfrac 624         merged:  hfrac 3    lratio 3   
        time: bcrham 5.0

      --> proc 4
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 339   small lratio 12   total 351
        writing partitions
        calcd:   vtb 2     fwd 16    hfrac 575         merged:  hfrac 4    lratio 0   
        time: bcrham 5.7

      --> proc 6
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 357   small lratio 21   total 378
        writing partitions
        calcd:   vtb 1     fwd 24    hfrac 490         merged:  hfrac 2    lratio 0   
        time: bcrham 5.4

      --> proc 1
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 327   small lratio 24   total 351
        writing partitions
        calcd:   vtb 4     fwd 29    hfrac 575         merged:  hfrac 4    lratio 0   
        time: bcrham 6.0

      time waiting for bcrham: 8.1
      hmm step time: 8.2
          n calcd: 151 (21.6 per proc)
--> 185 clusters with 5 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 5 procs
      --> proc 3
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 419   small lratio 16   total 435
        writing partitions
        calcd:   vtb 1     fwd 23    hfrac 890         merged:  hfrac 6    lratio 1   
        time: bcrham 4.9

      --> proc 0
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 543   small lratio 18   total 561
        writing partitions
        calcd:   vtb 3     fwd 25    hfrac 768         merged:  hfrac 2    lratio 1   
        time: bcrham 5.1

      --> proc 1
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 498   small lratio 30   total 528
        writing partitions
        calcd:   vtb 3     fwd 28    hfrac 800         merged:  hfrac 3    lratio 1   
        time: bcrham 5.8

      --> proc 4
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 480   small lratio 16   total 496
        writing partitions
        calcd:   vtb 2     fwd 23    hfrac 831         merged:  hfrac 4    lratio 1   
        time: bcrham 5.5

      --> proc 2
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 413   small lratio 22   total 435
        writing partitions
        calcd:   vtb 2     fwd 30    hfrac 890         merged:  hfrac 7    lratio 0   
        time: bcrham 6.4

      time waiting for bcrham: 8.0
      hmm step time: 8.2
          n calcd: 140 (28.0 per proc)
--> 159 clusters with 3 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 3 procs
      --> proc 1
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 916   small lratio 30   total 946
        writing partitions
        calcd:   vtb 5     fwd 56    hfrac 1801        merged:  hfrac 6    lratio 3   
        time: bcrham 10.8

      --> proc 0
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 967   small lratio 23   total 990
        writing partitions
        calcd:   vtb 3     fwd 45    hfrac 1758        merged:  hfrac 5    lratio 3   
        time: bcrham 11.3

      --> proc 2
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 1034   small lratio 47   total 1081
        writing partitions
        calcd:   vtb 3     fwd 42    hfrac 1669        merged:  hfrac 6    lratio 0   
        time: bcrham 12.5

      time waiting for bcrham: 14.0
      hmm step time: 14.2
          n calcd: 154 (51.3 per proc)
--> 136 clusters with 2 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 2 procs
      --> proc 0
        read 635 cached logprobs and 385 naive seqs
        stop with:  big hfrac 1781   small lratio 49   total 1830
        writing partitions
        calcd:   vtb 6     fwd 43    hfrac 2719        merged:  hfrac 6    lratio 1   
        time: bcrham 11.3

      --> proc 1
        read 635 cached logprobs and 385 naive seqs
        stop with:  big hfrac 1650   small lratio 61   total 1711
        writing partitions
        calcd:   vtb 3     fwd 53    hfrac 2836        merged:  hfrac 7    lratio 2   
        time: bcrham 13.9

      time waiting for bcrham: 15.0
      hmm step time: 15.2
          n calcd: 105 (52.5 per proc)
--> 120 clusters with 1 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 1 procs
        read 731 cached logprobs and 406 naive seqs
        stop with:  big hfrac 5194   small lratio 162   total 5356
        writing partitions
        calcd:   vtb 7     fwd 144   hfrac 8908        merged:  hfrac 11   lratio 5   
        time: bcrham 35.0

      time waiting for bcrham: 37.1
â€˜test/_new-results/cache-ref-partition.csv.tmpâ€™ -> â€˜test/_new-results/cache-ref-partition.csvâ€™
      hmm step time: 37.1
      loop time: 93.1
      total time: 117.5
TEST        seed-partition-ref-simu   ./bin/partis partition --n-max-queries -1 --n-precache-procs 10 --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --seed-unique-id 6032302116467241209 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/seed-partition-ref-simu.csv
26 [10, 10, 6]
partitioning
smith-waterman
test/reference-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=7, biggest_naive_seq_cluster_to_calculate=7, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7faa9b502f50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/reference-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=False, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/seed-partition-ref-simu.csv', parameter_dir='test/reference-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id='6032302116467241209', seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/875933')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           979             154              0                          59              65              27               0               3             increasing mismatch score (1 --> 2) and rerunning them
           154              12              6                           0               4               0               1               1             rerunning for indels
            12               8              0                           0               4               0               1               3             increasing mismatch score (2 --> 3) and rerunning them
             8               5              0                           0               3               0               0               2             increasing mismatch score (3 --> 4) and rerunning them
      info for 974      (skipped 0 / 979 = 0.00 unproductive    5 / 979 = 0.01 other ) 
   [91mwarning[0m 5 missing annotations (988368265964906807:1775482691619026262:-6502313822175126047:-8328172869839560580:8022407927244619365)
        water time: 13.6
hmm
    writing input
    running 10 procs
      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 5.7

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 5.7

      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.6

      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.5

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.2

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.5

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.1

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.5

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.2

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.4

      time waiting for bcrham: 9.1
      hmm step time: 9.5
--> 974 clusters with 10 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 10 procs
      --> proc 5
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 94   small lratio 3   total 97
        writing partitions
        calcd:   vtb 0     fwd 7     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 1.9

      --> proc 8
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 96   small lratio 1   total 97
        writing partitions
        calcd:   vtb 0     fwd 3     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 1.2

      --> proc 9
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 93   small lratio 4   total 97
        writing partitions
        calcd:   vtb 0     fwd 9     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 1.8

      --> proc 1
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 7   total 98
        writing partitions
        calcd:   vtb 0     fwd 15    hfrac 98          merged:  hfrac 0    lratio 0   
        time: bcrham 2.4

      --> proc 2
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 94   small lratio 4   total 98
        writing partitions
        calcd:   vtb 0     fwd 9     hfrac 98          merged:  hfrac 0    lratio 0   
        time: bcrham 2.1

      --> proc 3
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 89   small lratio 8   total 97
        writing partitions
        calcd:   vtb 0     fwd 17    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 4
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 6   total 97
        writing partitions
        calcd:   vtb 0     fwd 13    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.2

      --> proc 6
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 6   total 97
        writing partitions
        calcd:   vtb 0     fwd 13    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.1

      --> proc 7
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 92   small lratio 5   total 97
        writing partitions
        calcd:   vtb 0     fwd 11    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.1

      --> proc 0
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 93   small lratio 3   total 96
        writing partitions
        calcd:   vtb 2     fwd 18    hfrac 291         merged:  hfrac 0    lratio 2   
        time: bcrham 3.2

      time waiting for bcrham: 5.1
      hmm step time: 5.6
          n calcd: 117 (11.7 per proc)
--> 981 clusters with 7 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 7 procs
      --> proc 0
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 136   small lratio 3   total 139
        writing partitions
        calcd:   vtb 0     fwd 3     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.7

      --> proc 2
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 134   small lratio 5   total 139
        writing partitions
        calcd:   vtb 0     fwd 4     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.4

      --> proc 3
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 131   small lratio 8   total 139
        writing partitions
        calcd:   vtb 0     fwd 6     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.7

      --> proc 6
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 134   small lratio 4   total 138
        writing partitions
        calcd:   vtb 0     fwd 5     hfrac 138         merged:  hfrac 0    lratio 0   
        time: bcrham 1.6

      --> proc 1
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 133   small lratio 5   total 138
        writing partitions
        calcd:   vtb 1     fwd 11    hfrac 277         merged:  hfrac 0    lratio 1   
        time: bcrham 2.9

      --> proc 5
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 130   small lratio 8   total 138
        writing partitions
        calcd:   vtb 0     fwd 8     hfrac 138         merged:  hfrac 0    lratio 0   
        time: bcrham 2.2

      --> proc 4
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 132   small lratio 6   total 138
        writing partitions
        calcd:   vtb 1     fwd 14    hfrac 277         merged:  hfrac 0    lratio 1   
        time: bcrham 3.3

      time waiting for bcrham: 5.1
      hmm step time: 5.5
          n calcd: 53 (7.6 per proc)
--> 976 clusters with 5 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 5 procs
      --> proc 2
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 188   small lratio 6   total 194
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 3
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 180   small lratio 14   total 194
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 4
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 186   small lratio 7   total 193
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 193         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 1
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 190   small lratio 4   total 194
        writing partitions
        calcd:   vtb 0     fwd 4     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 2.0

      --> proc 0
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 187   small lratio 7   total 194
        writing partitions
        calcd:   vtb 0     fwd 7     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      time waiting for bcrham: 4.1
      hmm step time: 4.5
          n calcd: 11 (2.2 per proc)
     time to remove unseeded clusters
        new n_procs 1 = 3 * 10 / 97
--> 974 clusters with 1 procs
hmm
    writing input
      removing unseeded clusters
          -21601772910329535:-5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209:7617512282763587042 -5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209
          7617512282763587042 -6284946948828536731 6032302116467241209 -21601772910329535 -5576104849726081818
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    running 1 procs
        read 168 cached logprobs and 978 naive seqs
        stop with:  big hfrac 0   small lratio 0   total 0
        writing partitions
        calcd:   vtb 2     fwd 5     hfrac 16          merged:  hfrac 2    lratio 2   
        time: bcrham 1.4

      time waiting for bcrham: 3.0
      hmm step time: 3.0
      loop time: 18.7
  [91mwarning[0m queries missing from partition: 988368265964906807 1775482691619026262 8022407927244619365 -6502313822175126047 -8328172869839560580
      total time: 42.4
TEST     vsearch-partition-ref-simu   ./bin/partis partition --naive-vsearch --n-max-queries 250 --n-precache-procs 10 --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/vsearch-partition-ref-simu.csv
26 [10, 10, 6]
partitioning
smith-waterman
test/reference-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=7, biggest_naive_seq_cluster_to_calculate=7, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7fa3396cdf50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/reference-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=250, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=True, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/vsearch-partition-ref-simu.csv', parameter_dir='test/reference-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/723239')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              36              0                          18              13               4               0               1             increasing mismatch score (1 --> 2) and rerunning them
            36               2              1                           0               0               0               0               1             rerunning for indels
             2               1              0                           0               0               0               0               1             increasing mismatch score (2 --> 3) and rerunning them
             1         all done
      info for 250 
        water time: 13.8
hmm
    writing input
    running 10 procs
      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.9

      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.6

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.6

      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.6

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.6

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.6

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.1

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.3

      time waiting for bcrham: 6.1
      hmm step time: 6.2
       naive hfrac bounds: 0.035 0.035   (0.125 mutation in test/reference-results/test/parameters/simu/hmm)
    using hfrac bound for vsearch 0.035
  stdout:
    vsearch v1.1.3_linux_x86_64, 62.8GB RAM, 16 cores
    https://github.com/torognes/vsearch
    
    
  stderr:
    Reading file /tmp/dralph/hmms/723239/simu.fasta 0%  Reading file /tmp/dralph/hmms/723239/simu.fasta 0%  Reading file /tmp/dralph/hmms/723239/simu.fasta 1%  Reading file /tmp/dralph/hmms/723239/simu.fasta 2%  Reading file /tmp/dralph/hmms/723239/simu.fasta 3%  Reading file /tmp/dralph/hmms/723239/simu.fasta 4%  Reading file /tmp/dralph/hmms/723239/simu.fasta 4%  Reading file /tmp/dralph/hmms/723239/simu.fasta 5%  Reading file /tmp/dralph/hmms/723239/simu.fasta 6%  Reading file /tmp/dralph/hmms/723239/simu.fasta 7%  Reading file /tmp/dralph/hmms/723239/simu.fasta 8%  Reading file /tmp/dralph/hmms/723239/simu.fasta 8%  Reading file /tmp/dralph/hmms/723239/simu.fasta 9%  Reading file /tmp/dralph/hmms/723239/simu.fasta 10%  Reading file /tmp/dralph/hmms/723239/simu.fasta 11%  Reading file /tmp/dralph/hmms/723239/simu.fasta 12%  Reading file /tmp/dralph/hmms/723239/simu.fasta 12%  Reading file /tmp/dralph/hmms/723239/simu.fasta 13%  Reading file /tmp/dralph/hmms/723239/simu.fasta 14%  Reading file /tmp/dralph/hmms/723239/simu.fasta 15%  Reading file /tmp/dralph/hmms/723239/simu.fasta 16%  Reading file /tmp/dralph/hmms/723239/simu.fasta 16%  Reading file /tmp/dralph/hmms/723239/simu.fasta 17%  Reading file /tmp/dralph/hmms/723239/simu.fasta 18%  Reading file /tmp/dralph/hmms/723239/simu.fasta 19%  Reading file /tmp/dralph/hmms/723239/simu.fasta 20%  Reading file /tmp/dralph/hmms/723239/simu.fasta 20%  Reading file /tmp/dralph/hmms/723239/simu.fasta 21%  Reading file /tmp/dralph/hmms/723239/simu.fasta 22%  Reading file /tmp/dralph/hmms/723239/simu.fasta 23%  Reading file /tmp/dralph/hmms/723239/simu.fasta 24%  Reading file /tmp/dralph/hmms/723239/simu.fasta 24%  Reading file /tmp/dralph/hmms/723239/simu.fasta 25%  Reading file /tmp/dralph/hmms/723239/simu.fasta 26%  Reading file /tmp/dralph/hmms/723239/simu.fasta 27%  Reading file /tmp/dralph/hmms/723239/simu.fasta 28%  Reading file /tmp/dralph/hmms/723239/simu.fasta 28%  Reading file /tmp/dralph/hmms/723239/simu.fasta 29%  Reading file /tmp/dralph/hmms/723239/simu.fasta 30%  Reading file /tmp/dralph/hmms/723239/simu.fasta 31%  Reading file /tmp/dralph/hmms/723239/simu.fasta 32%  Reading file /tmp/dralph/hmms/723239/simu.fasta 32%  Reading file /tmp/dralph/hmms/723239/simu.fasta 33%  Reading file /tmp/dralph/hmms/723239/simu.fasta 34%  Reading file /tmp/dralph/hmms/723239/simu.fasta 35%  Reading file /tmp/dralph/hmms/723239/simu.fasta 36%  Reading file /tmp/dralph/hmms/723239/simu.fasta 36%  Reading file /tmp/dralph/hmms/723239/simu.fasta 37%  Reading file /tmp/dralph/hmms/723239/simu.fasta 38%  Reading file /tmp/dralph/hmms/723239/simu.fasta 39%  Reading file /tmp/dralph/hmms/723239/simu.fasta 40%  Reading file /tmp/dralph/hmms/723239/simu.fasta 40%  Reading file /tmp/dralph/hmms/723239/simu.fasta 41%  Reading file /tmp/dralph/hmms/723239/simu.fasta 42%  Reading file /tmp/dralph/hmms/723239/simu.fasta 43%  Reading file /tmp/dralph/hmms/723239/simu.fasta 44%  Reading file /tmp/dralph/hmms/723239/simu.fasta 44%  Reading file /tmp/dralph/hmms/723239/simu.fasta 45%  Reading file /tmp/dralph/hmms/723239/simu.fasta 46%  Reading file /tmp/dralph/hmms/723239/simu.fasta 47%  Reading file /tmp/dralph/hmms/723239/simu.fasta 48%  Reading file /tmp/dralph/hmms/723239/simu.fasta 48%  Reading file /tmp/dralph/hmms/723239/simu.fasta 49%  Reading file /tmp/dralph/hmms/723239/simu.fasta 50%  Reading file /tmp/dralph/hmms/723239/simu.fasta 51%  Reading file /tmp/dralph/hmms/723239/simu.fasta 52%  Reading file /tmp/dralph/hmms/723239/simu.fasta 52%  Reading file /tmp/dralph/hmms/723239/simu.fasta 53%  Reading file /tmp/dralph/hmms/723239/simu.fasta 54%  Reading file /tmp/dralph/hmms/723239/simu.fasta 55%  Reading file /tmp/dralph/hmms/723239/simu.fasta 56%  Reading file /tmp/dralph/hmms/723239/simu.fasta 56%  Reading file /tmp/dralph/hmms/723239/simu.fasta 57%  Reading file /tmp/dralph/hmms/723239/simu.fasta 58%  Reading file /tmp/dralph/hmms/723239/simu.fasta 59%  Reading file /tmp/dralph/hmms/723239/simu.fasta 60%  Reading file /tmp/dralph/hmms/723239/simu.fasta 60%  Reading file /tmp/dralph/hmms/723239/simu.fasta 61%  Reading file /tmp/dralph/hmms/723239/simu.fasta 62%  Reading file /tmp/dralph/hmms/723239/simu.fasta 63%  Reading file /tmp/dralph/hmms/723239/simu.fasta 64%  Reading file /tmp/dralph/hmms/723239/simu.fasta 64%  Reading file /tmp/dralph/hmms/723239/simu.fasta 65%  Reading file /tmp/dralph/hmms/723239/simu.fasta 66%  Reading file /tmp/dralph/hmms/723239/simu.fasta 67%  Reading file /tmp/dralph/hmms/723239/simu.fasta 68%  Reading file /tmp/dralph/hmms/723239/simu.fasta 68%  Reading file /tmp/dralph/hmms/723239/simu.fasta 69%  Reading file /tmp/dralph/hmms/723239/simu.fasta 70%  Reading file /tmp/dralph/hmms/723239/simu.fasta 71%  Reading file /tmp/dralph/hmms/723239/simu.fasta 72%  Reading file /tmp/dralph/hmms/723239/simu.fasta 72%  Reading file /tmp/dralph/hmms/723239/simu.fasta 73%  Reading file /tmp/dralph/hmms/723239/simu.fasta 74%  Reading file /tmp/dralph/hmms/723239/simu.fasta 75%  Reading file /tmp/dralph/hmms/723239/simu.fasta 76%  Reading file /tmp/dralph/hmms/723239/simu.fasta 76%  Reading file /tmp/dralph/hmms/723239/simu.fasta 77%  Reading file /tmp/dralph/hmms/723239/simu.fasta 78%  Reading file /tmp/dralph/hmms/723239/simu.fasta 79%  Reading file /tmp/dralph/hmms/723239/simu.fasta 80%  Reading file /tmp/dralph/hmms/723239/simu.fasta 80%  Reading file /tmp/dralph/hmms/723239/simu.fasta 81%  Reading file /tmp/dralph/hmms/723239/simu.fasta 82%  Reading file /tmp/dralph/hmms/723239/simu.fasta 83%  Reading file /tmp/dralph/hmms/723239/simu.fasta 84%  Reading file /tmp/dralph/hmms/723239/simu.fasta 84%  Reading file /tmp/dralph/hmms/723239/simu.fasta 85%  Reading file /tmp/dralph/hmms/723239/simu.fasta 86%  Reading file /tmp/dralph/hmms/723239/simu.fasta 87%  Reading file /tmp/dralph/hmms/723239/simu.fasta 88%  Reading file /tmp/dralph/hmms/723239/simu.fasta 88%  Reading file /tmp/dralph/hmms/723239/simu.fasta 89%  Reading file /tmp/dralph/hmms/723239/simu.fasta 90%  Reading file /tmp/dralph/hmms/723239/simu.fasta 91%  Reading file /tmp/dralph/hmms/723239/simu.fasta 92%  Reading file /tmp/dralph/hmms/723239/simu.fasta 92%  Reading file /tmp/dralph/hmms/723239/simu.fasta 93%  Reading file /tmp/dralph/hmms/723239/simu.fasta 94%  Reading file /tmp/dralph/hmms/723239/simu.fasta 95%  Reading file /tmp/dralph/hmms/723239/simu.fasta 96%  Reading file /tmp/dralph/hmms/723239/simu.fasta 96%  Reading file /tmp/dralph/hmms/723239/simu.fasta 97%  Reading file /tmp/dralph/hmms/723239/simu.fasta 98%  Reading file /tmp/dralph/hmms/723239/simu.fasta 99%  Reading file /tmp/dralph/hmms/723239/simu.fasta 100%  Reading file /tmp/dralph/hmms/723239/simu.fasta 100%
    104000 nt in 250 seqs, min 416, max 416, avg 416
    Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 1%  Indexing sequences 1%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 3%  Indexing sequences 3%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 5%  Indexing sequences 5%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 7%  Indexing sequences 7%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 9%  Indexing sequences 9%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 11%  Indexing sequences 11%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 13%  Indexing sequences 13%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 15%  Indexing sequences 15%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 17%  Indexing sequences 17%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 19%  Indexing sequences 19%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 21%  Indexing sequences 21%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 23%  Indexing sequences 23%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 25%  Indexing sequences 25%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 27%  Indexing sequences 27%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 29%  Indexing sequences 29%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 31%  Indexing sequences 31%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 33%  Indexing sequences 33%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 35%  Indexing sequences 35%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 37%  Indexing sequences 37%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 39%  Indexing sequences 39%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 41%  Indexing sequences 41%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 43%  Indexing sequences 43%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 45%  Indexing sequences 45%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 47%  Indexing sequences 47%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 49%  Indexing sequences 49%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 51%  Indexing sequences 51%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 53%  Indexing sequences 53%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 55%  Indexing sequences 55%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 57%  Indexing sequences 57%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 59%  Indexing sequences 59%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 61%  Indexing sequences 61%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 63%  Indexing sequences 63%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 65%  Indexing sequences 65%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 67%  Indexing sequences 67%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 69%  Indexing sequences 69%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 71%  Indexing sequences 71%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 73%  Indexing sequences 73%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 75%  Indexing sequences 75%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 77%  Indexing sequences 77%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 79%  Indexing sequences 79%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 81%  Indexing sequences 81%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 83%  Indexing sequences 83%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 85%  Indexing sequences 85%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 87%  Indexing sequences 87%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 89%  Indexing sequences 89%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 91%  Indexing sequences 91%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 93%  Indexing sequences 93%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 95%  Indexing sequences 95%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 97%  Indexing sequences 97%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 99%  Indexing sequences 99%  Indexing sequences 100%  Indexing sequences 100%
    Masking 0%  Masking 100%
    Sorting by length 0%  Sorting by length 100%
    Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 1%  Counting unique k-mers 1%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 3%  Counting unique k-mers 3%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 5%  Counting unique k-mers 5%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 7%  Counting unique k-mers 7%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 9%  Counting unique k-mers 9%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 11%  Counting unique k-mers 11%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 13%  Counting unique k-mers 13%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 15%  Counting unique k-mers 15%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 17%  Counting unique k-mers 17%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 19%  Counting unique k-mers 19%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 21%  Counting unique k-mers 21%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 23%  Counting unique k-mers 23%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 25%  Counting unique k-mers 25%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 27%  Counting unique k-mers 27%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 29%  Counting unique k-mers 29%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 31%  Counting unique k-mers 31%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 33%  Counting unique k-mers 33%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 35%  Counting unique k-mers 35%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 37%  Counting unique k-mers 37%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 39%  Counting unique k-mers 39%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 41%  Counting unique k-mers 41%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 43%  Counting unique k-mers 43%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 45%  Counting unique k-mers 45%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 47%  Counting unique k-mers 47%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 49%  Counting unique k-mers 49%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 51%  Counting unique k-mers 51%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 53%  Counting unique k-mers 53%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 55%  Counting unique k-mers 55%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 57%  Counting unique k-mers 57%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 59%  Counting unique k-mers 59%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 61%  Counting unique k-mers 61%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 63%  Counting unique k-mers 63%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 65%  Counting unique k-mers 65%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 67%  Counting unique k-mers 67%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 69%  Counting unique k-mers 69%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 71%  Counting unique k-mers 71%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 73%  Counting unique k-mers 73%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 75%  Counting unique k-mers 75%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 77%  Counting unique k-mers 77%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 79%  Counting unique k-mers 79%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 81%  Counting unique k-mers 81%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 83%  Counting unique k-mers 83%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 85%  Counting unique k-mers 85%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 87%  Counting unique k-mers 87%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 89%  Counting unique k-mers 89%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 91%  Counting unique k-mers 91%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 93%  Counting unique k-mers 93%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 95%  Counting unique k-mers 95%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 97%  Counting unique k-mers 97%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 99%  Counting unique k-mers 99%  Counting unique k-mers 100%  Counting unique k-mers 100%
    Clustering 0%  Clustering 4%  Clustering 8%  Clustering 12%  Clustering 16%  Clustering 20%  Clustering 24%  Clustering 28%  Clustering 32%  Clustering 36%  Clustering 40%  Clustering 44%  Clustering 48%  Clustering 52%  Clustering 56%  Clustering 60%  Clustering 64%  Clustering 68%  Clustering 72%  Clustering 76%  Clustering 80%  Clustering 84%  Clustering 88%  Clustering 92%  Clustering 96%  Clustering 100%  Clustering 100%
    Writing clusters 0%  Writing clusters 0%  Writing clusters 0%  Writing clusters 1%  Writing clusters 1%  Writing clusters 2%  Writing clusters 2%  Writing clusters 2%  Writing clusters 3%  Writing clusters 3%  Writing clusters 4%  Writing clusters 4%  Writing clusters 4%  Writing clusters 5%  Writing clusters 5%  Writing clusters 6%  Writing clusters 6%  Writing clusters 6%  Writing clusters 7%  Writing clusters 7%  Writing clusters 8%  Writing clusters 8%  Writing clusters 8%  Writing clusters 9%  Writing clusters 9%  Writing clusters 10%  Writing clusters 10%  Writing clusters 10%  Writing clusters 11%  Writing clusters 11%  Writing clusters 12%  Writing clusters 12%  Writing clusters 12%  Writing clusters 13%  Writing clusters 13%  Writing clusters 14%  Writing clusters 14%  Writing clusters 14%  Writing clusters 15%  Writing clusters 15%  Writing clusters 16%  Writing clusters 16%  Writing clusters 16%  Writing clusters 17%  Writing clusters 17%  Writing clusters 18%  Writing clusters 18%  Writing clusters 18%  Writing clusters 19%  Writing clusters 19%  Writing clusters 20%  Writing clusters 20%  Writing clusters 20%  Writing clusters 21%  Writing clusters 21%  Writing clusters 22%  Writing clusters 22%  Writing clusters 22%  Writing clusters 23%  Writing clusters 23%  Writing clusters 24%  Writing clusters 24%  Writing clusters 24%  Writing clusters 25%  Writing clusters 25%  Writing clusters 26%  Writing clusters 26%  Writing clusters 26%  Writing clusters 27%  Writing clusters 27%  Writing clusters 28%  Writing clusters 28%  Writing clusters 28%  Writing clusters 29%  Writing clusters 29%  Writing clusters 30%  Writing clusters 30%  Writing clusters 30%  Writing clusters 31%  Writing clusters 31%  Writing clusters 32%  Writing clusters 32%  Writing clusters 32%  Writing clusters 33%  Writing clusters 33%  Writing clusters 34%  Writing clusters 34%  Writing clusters 34%  Writing clusters 35%  Writing clusters 35%  Writing clusters 36%  Writing clusters 36%  Writing clusters 36%  Writing clusters 37%  Writing clusters 37%  Writing clusters 38%  Writing clusters 38%  Writing clusters 38%  Writing clusters 39%  Writing clusters 39%  Writing clusters 40%  Writing clusters 40%  Writing clusters 40%  Writing clusters 41%  Writing clusters 41%  Writing clusters 42%  Writing clusters 42%  Writing clusters 42%  Writing clusters 43%  Writing clusters 43%  Writing clusters 44%  Writing clusters 44%  Writing clusters 44%  Writing clusters 45%  Writing clusters 45%  Writing clusters 46%  Writing clusters 46%  Writing clusters 46%  Writing clusters 47%  Writing clusters 47%  Writing clusters 48%  Writing clusters 48%  Writing clusters 48%  Writing clusters 49%  Writing clusters 49%  Writing clusters 50%  Writing clusters 50%  Writing clusters 50%  Writing clusters 51%  Writing clusters 51%  Writing clusters 52%  Writing clusters 52%  Writing clusters 52%  Writing clusters 53%  Writing clusters 53%  Writing clusters 54%  Writing clusters 54%  Writing clusters 54%  Writing clusters 55%  Writing clusters 55%  Writing clusters 56%  Writing clusters 56%  Writing clusters 56%  Writing clusters 57%  Writing clusters 57%  Writing clusters 58%  Writing clusters 58%  Writing clusters 58%  Writing clusters 59%  Writing clusters 59%  Writing clusters 60%  Writing clusters 60%  Writing clusters 60%  Writing clusters 61%  Writing clusters 61%  Writing clusters 62%  Writing clusters 62%  Writing clusters 62%  Writing clusters 63%  Writing clusters 63%  Writing clusters 64%  Writing clusters 64%  Writing clusters 64%  Writing clusters 65%  Writing clusters 65%  Writing clusters 66%  Writing clusters 66%  Writing clusters 66%  Writing clusters 67%  Writing clusters 67%  Writing clusters 68%  Writing clusters 68%  Writing clusters 68%  Writing clusters 69%  Writing clusters 69%  Writing clusters 70%  Writing clusters 70%  Writing clusters 70%  Writing clusters 71%  Writing clusters 71%  Writing clusters 72%  Writing clusters 72%  Writing clusters 72%  Writing clusters 73%  Writing clusters 73%  Writing clusters 74%  Writing clusters 74%  Writing clusters 74%  Writing clusters 75%  Writing clusters 75%  Writing clusters 76%  Writing clusters 76%  Writing clusters 76%  Writing clusters 77%  Writing clusters 77%  Writing clusters 78%  Writing clusters 78%  Writing clusters 78%  Writing clusters 79%  Writing clusters 79%  Writing clusters 80%  Writing clusters 80%  Writing clusters 80%  Writing clusters 81%  Writing clusters 81%  Writing clusters 82%  Writing clusters 82%  Writing clusters 82%  Writing clusters 83%  Writing clusters 83%  Writing clusters 84%  Writing clusters 84%  Writing clusters 84%  Writing clusters 85%  Writing clusters 85%  Writing clusters 86%  Writing clusters 86%  Writing clusters 86%  Writing clusters 87%  Writing clusters 87%  Writing clusters 88%  Writing clusters 88%  Writing clusters 88%  Writing clusters 89%  Writing clusters 89%  Writing clusters 90%  Writing clusters 90%  Writing clusters 90%  Writing clusters 91%  Writing clusters 91%  Writing clusters 92%  Writing clusters 92%  Writing clusters 92%  Writing clusters 93%  Writing clusters 93%  Writing clusters 94%  Writing clusters 94%  Writing clusters 94%  Writing clusters 95%  Writing clusters 95%  Writing clusters 96%  Writing clusters 96%  Writing clusters 96%  Writing clusters 97%  Writing clusters 97%  Writing clusters 98%  Writing clusters 98%  Writing clusters 98%  Writing clusters 99%  Writing clusters 99%  Writing clusters 100%  Writing clusters 100%
    Clusters: 79 Size min 1, max 15, avg 3.2
    Singletons: 35, 14.0% of seqs, 44.3% of clusters
    
      vsearch/swarm time: 1.0
      total time: 21.2
TEST          cache-data-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results cache-data-parameters --extra-args __seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots --datafname test/mishmash.fa
RUN ./bin/partis.py cache-parameters --seqfile test/mishmash.fa --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data --plotdir test/_new-results/test/plots/data --print-git-commit
  note: moving contents of deprecated option --seqfile into its replacement --infname
RUN ./bin/partis.py cache-parameters --seqfile test/mishmash.fa --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data --plotdir test/_new-results/test/plots/data --print-git-commit
       tag v0.4.0
    commit f09ffaeed62dcf211fc14c807ed19f759a6b0b63
26 [10, 10, 6]
caching parameters
smith-waterman
test/_new-results/test/parameters/data/sw
Namespace(abbreviate=False, action='cache-parameters', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=False, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f4f7e7a0f50>, gap_open_penalty=30, generate_germline_set=False, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/mishmash.fa', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=True, is_simu=False, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=False, outfname=None, parameter_dir='test/_new-results/test/parameters/data', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir='test/_new-results/test/plots/data', presto_output=False, print_cluster_annotations=None, print_git_commit=True, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile='test/mishmash.fa', simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/130986')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
          1394             205              0                          96              86              20               0               3             increasing mismatch score (1 --> 2) and rerunning them
           205              42             33                           0               8               0               1               0             rerunning for indels
            42              18              0                           0               9               0               2               7             increasing mismatch score (2 --> 3) and rerunning them
            18              11              0                           0               2               0               3               6             increasing mismatch score (3 --> 4) and rerunning them
      info for 1383      (skipped 0 / 1394 = 0.00 unproductive    11 / 1394 = 0.01 other ) 
   [91mwarning[0m 11 missing annotations (-7011713810090795053:-4832028181938476209:crap-1:crap-3:crap-2:crap-5:crap-4:-9214222141473325301:3650832272176427929:3009114784662815033:-1216833654156218617)
    writing parameters (1.1 sec)
  plotting parameters/home/dralph/.local/lib/python2.7/site-packages/IPython/html.py:14: ShimWarning: The `IPython.html` package has been deprecated. You should import from `notebook` instead. `IPython.html.widgets` has moved to `ipywidgets`.
  "`IPython.html.widgets` has moved to `ipywidgets`.", ShimWarning)
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/pyplot.py:516: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
 (12.6 sec)
        water time: 29.1
  writing hmms (6.0 sec)
hmm
    writing input
    running 10 procs
      --> proc 2
        calcd:   vtb 139   fwd 0   
        time: bcrham 9.0

      --> proc 6
        calcd:   vtb 138   fwd 0   
        time: bcrham 8.8

      --> proc 0
        calcd:   vtb 139   fwd 0   
        time: bcrham 9.3

      --> proc 1
        calcd:   vtb 139   fwd 0   
        time: bcrham 10.0

      --> proc 3
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.3

      --> proc 4
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.3

      --> proc 5
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.5

      --> proc 7
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.8

      --> proc 8
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.5

      --> proc 9
        calcd:   vtb 138   fwd 0   
        time: bcrham 9.7

      time waiting for bcrham: 11.2
    read output
    writing parameters (1.1 sec)
  plotting parameters (12.3 sec)
        1383 lines:  processed 1381 sequences in 1381 events (skipped 2 invalid events)
      1 boundary errors
      hmm step time: 28.1
  writing hmms (8.5 sec)
      total time: 71.9
TEST                       simulate   ./bin/run-driver.py --label test --stashdir test/_new-results simulate --extra-args __n-sim-events:500:__n-leaves:2:__mimic-data-read-length:__seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots
RUN ./bin/partis.py simulate --outfname test/_new-results/test/simu.csv --n-sim-events 500 --n-leaves 2 --mimic-data-read-length --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data/hmm --print-git-commit
RUN ./bin/partis.py simulate --outfname test/_new-results/test/simu.csv --n-sim-events 500 --n-leaves 2 --mimic-data-read-length --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/data/hmm --print-git-commit
       tag v0.4.0
    commit f09ffaeed62dcf211fc14c807ed19f759a6b0b63
simulating
      total time: 11.5
TEST          cache-simu-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results cache-simu-parameters --extra-args __seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02:__only-csv-plots
RUN ./bin/partis.py cache-parameters --seqfile test/_new-results/test/simu.csv --is-simu --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/simu --plotdir test/_new-results/test/plots/simu --print-git-commit
  note: moving contents of deprecated option --seqfile into its replacement --infname
RUN ./bin/partis.py cache-parameters --seqfile test/_new-results/test/simu.csv --is-simu --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --parameter-dir test/_new-results/test/parameters/simu --plotdir test/_new-results/test/plots/simu --print-git-commit
       tag v0.4.0
    commit f09ffaeed62dcf211fc14c807ed19f759a6b0b63
26 [10, 10, 6]
caching parameters
smith-waterman
test/_new-results/test/parameters/simu/sw
Namespace(abbreviate=False, action='cache-parameters', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=False, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f30de7cdf50>, gap_open_penalty=30, generate_germline_set=False, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/_new-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=False, outfname=None, parameter_dir='test/_new-results/test/parameters/simu', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir='test/_new-results/test/plots/simu', presto_output=False, print_cluster_annotations=None, print_git_commit=True, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile='test/_new-results/test/simu.csv', simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/235711')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           979             154              0                          59              65              27               0               3             increasing mismatch score (1 --> 2) and rerunning them
           154              12              6                           0               4               0               1               1             rerunning for indels
            12               8              0                           0               4               0               1               3             increasing mismatch score (2 --> 3) and rerunning them
             8               5              0                           0               3               0               0               2             increasing mismatch score (3 --> 4) and rerunning them
      info for 974      (skipped 0 / 979 = 0.00 unproductive    5 / 979 = 0.01 other ) 
   [91mwarning[0m 5 missing annotations (988368265964906807:1775482691619026262:-6502313822175126047:-8328172869839560580:8022407927244619365)
    writing parameters (1.1 sec)
    writing parameters (1.3 sec)
  plotting parameters/home/dralph/.local/lib/python2.7/site-packages/IPython/html.py:14: ShimWarning: The `IPython.html` package has been deprecated. You should import from `notebook` instead. `IPython.html.widgets` has moved to `ipywidgets`.
  "`IPython.html.widgets` has moved to `ipywidgets`.", ShimWarning)
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/pyplot.py:516: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
 (10.5 sec)
  plotting parameters (8.7 sec)
        water time: 37.3
  writing hmms (6.8 sec)
hmm
    writing input
    running 10 procs
      --> proc 2
        calcd:   vtb 98    fwd 0   
        time: bcrham 5.9

      --> proc 4
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.1

      --> proc 0
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.8

      --> proc 3
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.4

      --> proc 7
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.6

      --> proc 8
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.4

      --> proc 9
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.1

      --> proc 1
        calcd:   vtb 98    fwd 0   
        time: bcrham 7.5

      --> proc 6
        calcd:   vtb 97    fwd 0   
        time: bcrham 7.6

      --> proc 5
        calcd:   vtb 97    fwd 0   
        time: bcrham 8.1

      time waiting for bcrham: 10.2
    read output
    writing parameters (0.8 sec)
  plotting parameters (8.4 sec)
    writing parameters (0.8 sec)
  plotting parameters (9.0 sec)
        974 lines:  processed 973 sequences in 973 events (skipped 1 invalid events)
      1 boundary errors
      hmm step time: 32.0
  writing hmms       WARNING IGHV3-48*01 not found in overall gene probs, returning zero
      WARNING IGHV3-48*01 not found in overall gene probs, returning zero
(6.0 sec)
      total time: 82.7
TEST              annotate-new-simu   ./bin/partis run-viterbi --plotdir test/_new-results/simu-new-performance --plot-performance --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-new-simu.csv
26 [10, 10, 6]
running viterbi
smith-waterman
test/_new-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='run-viterbi', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7fa1a196ef50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/_new-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/annotate-new-simu.csv', parameter_dir='test/_new-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=True, plotdir='test/_new-results/simu-new-performance', presto_output=False, print_cluster_annotations=None, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/929784')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           979             154              0                          59              65              27               0               3             increasing mismatch score (1 --> 2) and rerunning them
           154              12              6                           0               4               0               1               1             rerunning for indels
    skipping performance evaluation of -147090357821815167 because of indels
    skipping performance evaluation of 4101186145082612583 because of indels
    skipping performance evaluation of -2257160329299464390 because of indels
    skipping performance evaluation of 572542934422216884 because of indels
            12               8              0                           0               4               0               1               3             increasing mismatch score (2 --> 3) and rerunning them
/home/dralph/.local/lib/python2.7/site-packages/IPython/html.py:14: ShimWarning: The `IPython.html` package has been deprecated. You should import from `notebook` instead. `IPython.html.widgets` has moved to `ipywidgets`.
  "`IPython.html.widgets` has moved to `ipywidgets`.", ShimWarning)
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/pyplot.py:516: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
             8               5              0                           0               3               0               0               2             increasing mismatch score (3 --> 4) and rerunning them
  v_gene
    correct up to allele:  908 / 970  = 0.9361 (-0.928, +0.943)
  d_gene
    correct up to allele:  785 / 970  = 0.8093 (-0.796, +0.821)
  j_gene
    correct up to allele:  849 / 970  = 0.8753 (-0.864, +0.885)
      info for 974      (skipped 0 / 979 = 0.00 unproductive    5 / 979 = 0.01 other ) 
   [91mwarning[0m 5 missing annotations (988368265964906807:1775482691619026262:-6502313822175126047:-8328172869839560580:8022407927244619365)
        water time: 20.7
hmm
    writing input
    running 10 procs
      --> proc 0
        calcd:   vtb 98    fwd 0   
        time: bcrham 7.1

      --> proc 2
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.4

      --> proc 3
        calcd:   vtb 98    fwd 0   
        time: bcrham 6.6

      --> proc 4
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.1

      --> proc 7
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.8

      --> proc 8
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.5

      --> proc 9
        calcd:   vtb 97    fwd 0   
        time: bcrham 6.2

      --> proc 1
        calcd:   vtb 98    fwd 0   
        time: bcrham 7.4

      --> proc 5
        calcd:   vtb 97    fwd 0   
        time: bcrham 7.4

      --> proc 6
        calcd:   vtb 97    fwd 0   
        time: bcrham 7.9

      time waiting for bcrham: 9.1
    read output
/home/dralph/.local/lib/python2.7/site-packages/matplotlib/axes/_axes.py:519: UserWarning: No labelled objects found. Use label='...' kwarg on individual plots.
  warnings.warn("No labelled objects found. "
    skipping performance evaluation of -147090357821815167 because of indels
    skipping performance evaluation of -2257160329299464390 because of indels
    skipping performance evaluation of 572542934422216884 because of indels
    skipping performance evaluation of 4101186145082612583 because of indels
  v_gene
    correct up to allele:  845 / 970  = 0.8711 (-0.860, +0.881)
  d_gene
    correct up to allele:  818 / 970  = 0.8433 (-0.831, +0.854)
  j_gene
    correct up to allele:  898 / 970  = 0.9258 (-0.917, +0.933)
        974 lines:  processed 974 sequences in 974 events (skipped 0 invalid events)
missing 5 input keys
      hmm step time: 16.7
      total time: 37.9
TEST              annotate-new-data   ./bin/partis run-viterbi --n-max-queries 50 --infname test/mishmash.fa --parameter-dir test/_new-results/test/parameters/data/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-new-data.csv
26 [10, 10, 6]
running viterbi
smith-waterman
test/_new-results/test/parameters/data/hmm
Namespace(abbreviate=False, action='run-viterbi', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=None, apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=None, biggest_naive_seq_cluster_to_calculate=None, cache_naive_hfracs=None, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f3ad7d8cf50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/mishmash.fa', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=True, is_simu=False, logprob_ratio_threshold=None, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=50, n_partitions_to_write=None, n_precache_procs=None, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=None, naive_hamming_bounds=None, naive_swarm=None, naive_vsearch=None, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/annotate-new-data.csv', parameter_dir='test/_new-results/test/parameters/data/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=None, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=None, workdir='/tmp/dralph/hmms/379670')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
            50              13              0                           3               8               2               0               0             increasing mismatch score (1 --> 2) and rerunning them
            13               7              5                           0               1               0               1               0             rerunning for indels
             7               5              0                           0               1               0               2               2             increasing mismatch score (2 --> 3) and rerunning them
             5               5              0                           0               0               0               3               2             increasing mismatch score (3 --> 4) and rerunning them
      info for 45      (skipped 0 / 50 = 0.00 unproductive    5 / 50 = 0.10 other ) 
   [91mwarning[0m 5 missing annotations (crap-1:crap-3:crap-2:crap-5:crap-4)
        water time: 13.6
hmm
    writing input
    running 10 procs
      --> proc 0
        calcd:   vtb 5     fwd 0   
        time: bcrham 1.8

      --> proc 2
        calcd:   vtb 5     fwd 0   
        time: bcrham 1.5

      --> proc 3
        calcd:   vtb 5     fwd 0   
        time: bcrham 1.7

      --> proc 5
        calcd:   vtb 4     fwd 0   
        time: bcrham 1.3

      --> proc 6
        calcd:   vtb 4     fwd 0   
        time: bcrham 1.4

      --> proc 9
        calcd:   vtb 4     fwd 0   
        time: bcrham 1.3

      --> proc 1
        calcd:   vtb 5     fwd 0   
        time: bcrham 2.2

      --> proc 4
        calcd:   vtb 5     fwd 0   
        time: bcrham 2.3

      --> proc 7
        calcd:   vtb 4     fwd 0   
        time: bcrham 2.2

      --> proc 8
        calcd:   vtb 4     fwd 0   
        time: bcrham 2.3

      time waiting for bcrham: 4.1
    read output
        45 lines:  processed 45 sequences in 45 events (skipped 0 invalid events)
missing 5 input keys
      hmm step time: 4.4
      total time: 18.1
TEST             partition-new-simu   ./bin/partis partition --n-max-queries 250 --persistent-cachefname test/_new-results/cache-new-partition.csv --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 2 --biggest-naive-seq-cluster-to-calculate 2 --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/partition-new-simu.csv
26 [10, 10, 6]
partitioning
smith-waterman
test/_new-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=2, biggest_naive_seq_cluster_to_calculate=2, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f19a7807f50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/_new-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=250, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=False, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/partition-new-simu.csv', parameter_dir='test/_new-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname='test/_new-results/cache-new-partition.csv', plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/512571')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              36              0                          18              13               4               0               1             increasing mismatch score (1 --> 2) and rerunning them
            36               2              1                           0               0               0               0               1             rerunning for indels
             2               1              0                           0               0               0               0               1             increasing mismatch score (2 --> 3) and rerunning them
             1         all done
      info for 250 
        water time: 13.8
hmm
    writing input
    running 10 procs
      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.4

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.7

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.9

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.0

      time waiting for bcrham: 6.1
      hmm step time: 6.2
--> 250 clusters with 10 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 10 procs
      --> proc 0
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 225   small lratio 6   total 231
        writing partitions
        calcd:   vtb 1     fwd 15    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 2.9

      --> proc 1
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 206   small lratio 4   total 210
        writing partitions
        calcd:   vtb 2     fwd 14    hfrac 386         merged:  hfrac 3    lratio 1   
        time: bcrham 3.0

      --> proc 4
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 223   small lratio 8   total 231
        writing partitions
        calcd:   vtb 2     fwd 21    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 3.9

      --> proc 5
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 247   small lratio 6   total 253
        writing partitions
        calcd:   vtb 0     fwd 15    hfrac 345         merged:  hfrac 2    lratio 0   
        time: bcrham 3.2

      --> proc 3
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 263   small lratio 13   total 276
        writing partitions
        calcd:   vtb 0     fwd 28    hfrac 323         merged:  hfrac 1    lratio 0   
        time: bcrham 4.3

      --> proc 7
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 200   small lratio 10   total 210
        writing partitions
        calcd:   vtb 3     fwd 21    hfrac 386         merged:  hfrac 4    lratio 0   
        time: bcrham 4.7

      --> proc 9
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 183   small lratio 7   total 190
        writing partitions
        calcd:   vtb 2     fwd 24    hfrac 405         merged:  hfrac 4    lratio 1   
        time: bcrham 4.6

      --> proc 6
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 160   small lratio 11   total 171
        writing partitions
        calcd:   vtb 4     fwd 31    hfrac 423         merged:  hfrac 5    lratio 1   
        time: bcrham 5.5

      --> proc 8
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 216   small lratio 15   total 231
        writing partitions
        calcd:   vtb 2     fwd 28    hfrac 366         merged:  hfrac 3    lratio 0   
        time: bcrham 5.1

      --> proc 2
        read 0 cached logprobs and 250 naive seqs
        stop with:  big hfrac 215   small lratio 16   total 231
        writing partitions
        calcd:   vtb 2     fwd 33    hfrac 366         merged:  hfrac 2    lratio 1   
        time: bcrham 8.1

      time waiting for bcrham: 10.1
      hmm step time: 10.3
          n calcd: 248 (24.8 per proc)
--> 216 clusters with 7 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 7 procs
      --> proc 0
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 292   small lratio 8   total 300
        writing partitions
        calcd:   vtb 3     fwd 13    hfrac 624         merged:  hfrac 6    lratio 0   
        time: bcrham 3.5

      --> proc 5
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 269   small lratio 7   total 276
        writing partitions
        calcd:   vtb 4     fwd 11    hfrac 647         merged:  hfrac 7    lratio 0   
        time: bcrham 3.9

      --> proc 2
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 295   small lratio 5   total 300
        writing partitions
        calcd:   vtb 3     fwd 19    hfrac 624         merged:  hfrac 3    lratio 3   
        time: bcrham 4.3

      --> proc 3
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 391   small lratio 15   total 406
        writing partitions
        calcd:   vtb 1     fwd 21    hfrac 522         merged:  hfrac 1    lratio 1   
        time: bcrham 4.6

      --> proc 6
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 357   small lratio 21   total 378
        writing partitions
        calcd:   vtb 1     fwd 24    hfrac 490         merged:  hfrac 2    lratio 0   
        time: bcrham 4.7

      --> proc 1
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 327   small lratio 24   total 351
        writing partitions
        calcd:   vtb 4     fwd 29    hfrac 575         merged:  hfrac 4    lratio 0   
        time: bcrham 5.6

      --> proc 4
        read 230 cached logprobs and 284 naive seqs
        stop with:  big hfrac 339   small lratio 12   total 351
        writing partitions
        calcd:   vtb 2     fwd 16    hfrac 575         merged:  hfrac 4    lratio 0   
        time: bcrham 5.2

      time waiting for bcrham: 7.1
      hmm step time: 7.3
          n calcd: 151 (21.6 per proc)
--> 185 clusters with 5 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 5 procs
      --> proc 3
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 419   small lratio 16   total 435
        writing partitions
        calcd:   vtb 1     fwd 23    hfrac 890         merged:  hfrac 6    lratio 1   
        time: bcrham 5.2

      --> proc 0
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 543   small lratio 18   total 561
        writing partitions
        calcd:   vtb 3     fwd 25    hfrac 768         merged:  hfrac 2    lratio 1   
        time: bcrham 6.1

      --> proc 1
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 498   small lratio 30   total 528
        writing partitions
        calcd:   vtb 3     fwd 28    hfrac 800         merged:  hfrac 3    lratio 1   
        time: bcrham 6.1

      --> proc 2
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 413   small lratio 22   total 435
        writing partitions
        calcd:   vtb 2     fwd 30    hfrac 890         merged:  hfrac 7    lratio 0   
        time: bcrham 6.6

      --> proc 4
        read 363 cached logprobs and 322 naive seqs
        stop with:  big hfrac 480   small lratio 16   total 496
        writing partitions
        calcd:   vtb 2     fwd 23    hfrac 831         merged:  hfrac 4    lratio 1   
        time: bcrham 6.1

      time waiting for bcrham: 8.0
      hmm step time: 8.2
          n calcd: 140 (28.0 per proc)
--> 159 clusters with 3 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 3 procs
      --> proc 0
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 967   small lratio 23   total 990
        writing partitions
        calcd:   vtb 3     fwd 45    hfrac 1758        merged:  hfrac 5    lratio 3   
        time: bcrham 11.2

      --> proc 1
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 916   small lratio 30   total 946
        writing partitions
        calcd:   vtb 5     fwd 56    hfrac 1801        merged:  hfrac 6    lratio 3   
        time: bcrham 11.0

      --> proc 2
        read 492 cached logprobs and 353 naive seqs
        stop with:  big hfrac 1034   small lratio 47   total 1081
        writing partitions
        calcd:   vtb 3     fwd 42    hfrac 1669        merged:  hfrac 6    lratio 0   
        time: bcrham 15.3

      time waiting for bcrham: 17.0
      hmm step time: 17.2
          n calcd: 154 (51.3 per proc)
--> 136 clusters with 2 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 2 procs
      --> proc 0
        read 635 cached logprobs and 385 naive seqs
        stop with:  big hfrac 1781   small lratio 49   total 1830
        writing partitions
        calcd:   vtb 6     fwd 43    hfrac 2719        merged:  hfrac 6    lratio 1   
        time: bcrham 12.4

      --> proc 1
        read 635 cached logprobs and 385 naive seqs
        stop with:  big hfrac 1650   small lratio 61   total 1711
        writing partitions
        calcd:   vtb 3     fwd 53    hfrac 2836        merged:  hfrac 7    lratio 2   
        time: bcrham 13.0

      time waiting for bcrham: 14.0
      hmm step time: 14.2
          n calcd: 105 (52.5 per proc)
--> 120 clusters with 1 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 1 procs
        read 731 cached logprobs and 406 naive seqs
        stop with:  big hfrac 5194   small lratio 162   total 5356
        writing partitions
        calcd:   vtb 7     fwd 144   hfrac 8908        merged:  hfrac 11   lratio 5   
        time: bcrham 34.5

      time waiting for bcrham: 36.0
â€˜test/_new-results/cache-new-partition.csv.tmpâ€™ -> â€˜test/_new-results/cache-new-partition.csvâ€™
      hmm step time: 36.1
      loop time: 93.3
      total time: 113.5
TEST        seed-partition-new-simu   ./bin/partis partition --n-max-queries -1 --n-precache-procs 10 --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --seed-unique-id 6032302116467241209 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/seed-partition-new-simu.csv
26 [10, 10, 6]
partitioning
smith-waterman
test/_new-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=7, biggest_naive_seq_cluster_to_calculate=7, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7f1b5e1cdf50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/_new-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=-1, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=False, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/seed-partition-new-simu.csv', parameter_dir='test/_new-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id='6032302116467241209', seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/873225')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           979             154              0                          59              65              27               0               3             increasing mismatch score (1 --> 2) and rerunning them
           154              12              6                           0               4               0               1               1             rerunning for indels
            12               8              0                           0               4               0               1               3             increasing mismatch score (2 --> 3) and rerunning them
             8               5              0                           0               3               0               0               2             increasing mismatch score (3 --> 4) and rerunning them
      info for 974      (skipped 0 / 979 = 0.00 unproductive    5 / 979 = 0.01 other ) 
   [91mwarning[0m 5 missing annotations (988368265964906807:1775482691619026262:-6502313822175126047:-8328172869839560580:8022407927244619365)
        water time: 14.6
hmm
    writing input
    running 10 procs
      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 6.8

      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 8.0

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.6

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.6

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.7

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.4

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 7.4

      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 99    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 8.3

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 8.8

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 98    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 11.7

      time waiting for bcrham: 13.1
      hmm step time: 13.5
--> 974 clusters with 10 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 10 procs
      --> proc 8
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 96   small lratio 1   total 97
        writing partitions
        calcd:   vtb 0     fwd 3     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 1.9

      --> proc 2
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 94   small lratio 4   total 98
        writing partitions
        calcd:   vtb 0     fwd 9     hfrac 98          merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 4
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 6   total 97
        writing partitions
        calcd:   vtb 0     fwd 13    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 3.0

      --> proc 5
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 94   small lratio 3   total 97
        writing partitions
        calcd:   vtb 0     fwd 7     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.4

      --> proc 7
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 92   small lratio 5   total 97
        writing partitions
        calcd:   vtb 0     fwd 11    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 9
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 93   small lratio 4   total 97
        writing partitions
        calcd:   vtb 0     fwd 9     hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 2.2

      --> proc 1
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 7   total 98
        writing partitions
        calcd:   vtb 0     fwd 15    hfrac 98          merged:  hfrac 0    lratio 0   
        time: bcrham 3.1

      --> proc 3
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 89   small lratio 8   total 97
        writing partitions
        calcd:   vtb 0     fwd 17    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 3.3

      --> proc 6
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 91   small lratio 6   total 97
        writing partitions
        calcd:   vtb 0     fwd 13    hfrac 97          merged:  hfrac 0    lratio 0   
        time: bcrham 3.2

      --> proc 0
        read 0 cached logprobs and 974 naive seqs
        stop with:  big hfrac 93   small lratio 3   total 96
        writing partitions
        calcd:   vtb 2     fwd 18    hfrac 291         merged:  hfrac 0    lratio 2   
        time: bcrham 5.8

      time waiting for bcrham: 7.1
      hmm step time: 7.6
          n calcd: 117 (11.7 per proc)
--> 981 clusters with 7 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 7 procs
      --> proc 0
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 136   small lratio 3   total 139
        writing partitions
        calcd:   vtb 0     fwd 3     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.9

      --> proc 2
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 134   small lratio 5   total 139
        writing partitions
        calcd:   vtb 0     fwd 4     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.8

      --> proc 3
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 131   small lratio 8   total 139
        writing partitions
        calcd:   vtb 0     fwd 6     hfrac 139         merged:  hfrac 0    lratio 0   
        time: bcrham 1.8

      --> proc 6
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 134   small lratio 4   total 138
        writing partitions
        calcd:   vtb 0     fwd 5     hfrac 138         merged:  hfrac 0    lratio 0   
        time: bcrham 1.6

      --> proc 5
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 130   small lratio 8   total 138
        writing partitions
        calcd:   vtb 0     fwd 8     hfrac 138         merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 1
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 133   small lratio 5   total 138
        writing partitions
        calcd:   vtb 1     fwd 11    hfrac 277         merged:  hfrac 0    lratio 1   
        time: bcrham 3.4

      --> proc 4
        read 106 cached logprobs and 976 naive seqs
        stop with:  big hfrac 132   small lratio 6   total 138
        writing partitions
        calcd:   vtb 1     fwd 14    hfrac 277         merged:  hfrac 0    lratio 1   
        time: bcrham 4.8

      time waiting for bcrham: 6.1
      hmm step time: 6.6
          n calcd: 53 (7.6 per proc)
--> 976 clusters with 5 procs
hmm
    writing input
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 5 procs
      --> proc 2
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 188   small lratio 6   total 194
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 3
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 180   small lratio 14   total 194
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 4
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 186   small lratio 7   total 193
        writing partitions
        calcd:   vtb 0     fwd 0     hfrac 193         merged:  hfrac 0    lratio 0   
        time: bcrham 0.1

      --> proc 0
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 187   small lratio 7   total 194
        writing partitions
        calcd:   vtb 0     fwd 7     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 2.2

      --> proc 1
        read 157 cached logprobs and 978 naive seqs
        stop with:  big hfrac 190   small lratio 4   total 194
        writing partitions
        calcd:   vtb 0     fwd 4     hfrac 194         merged:  hfrac 0    lratio 0   
        time: bcrham 2.4

      time waiting for bcrham: 4.1
      hmm step time: 4.5
          n calcd: 11 (2.2 per proc)
     time to remove unseeded clusters
        new n_procs 1 = 3 * 10 / 97
--> 974 clusters with 1 procs
hmm
    writing input
      removing unseeded clusters
          -21601772910329535:-5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209:7617512282763587042 -5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209 -5576104849726081818:-6284946948828536731:6032302116467241209
          7617512282763587042 -6284946948828536731 6032302116467241209 -21601772910329535 -5576104849726081818
       naive hfrac bounds: 0.015 0.115   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    running 1 procs
        read 168 cached logprobs and 978 naive seqs
        stop with:  big hfrac 0   small lratio 0   total 0
        writing partitions
        calcd:   vtb 2     fwd 5     hfrac 16          merged:  hfrac 2    lratio 2   
        time: bcrham 2.8

      time waiting for bcrham: 4.0
      hmm step time: 4.0
      loop time: 22.7
  [91mwarning[0m queries missing from partition: 988368265964906807 1775482691619026262 8022407927244619365 -6502313822175126047 -8328172869839560580
      total time: 51.4
TEST     vsearch-partition-new-simu   ./bin/partis partition --naive-vsearch --n-max-queries 250 --n-precache-procs 10 --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/vsearch-partition-new-simu.csv
TODO read through write_germline_fasta
26 [10, 10, 6]
partitioning
smith-waterman
test/_new-results/test/parameters/simu/hmm
Namespace(abbreviate=False, action='partition', alignment_dir='/home/dralph/work/partis-dev/data/fam-alignments', all_combinations=False, annotation_clustering=None, annotation_clustering_thresholds=[0.9], apply_choice_probs_in_sw=False, biggest_logprob_cluster_to_calculate=7, biggest_naive_seq_cluster_to_calculate=7, cache_naive_hfracs=False, constant_number_of_leaves=None, debug=0, debug_new_allele_finding=None, default_d_fuzz=2, default_v_fuzz=5, dont_rescale_emissions=False, func=<function run_partitiondriver at 0x7ffd23556f50>, gap_open_penalty=30, generate_germline_set=None, gtrfname=None, ighutil_dir='/home/dralph/.local', indel_frequency=None, indel_location=None, infname='test/_new-results/test/simu.csv', initial_datadir='/home/dralph/work/partis-dev/data/imgt', is_data=False, is_simu=True, logprob_ratio_threshold=18.0, match_mismatch=[5, 1], max_logprob_drop=5.0, mean_indel_length=None, mimic_data_read_length=None, min_observations_to_write=20, mutation_multiplier=None, n_fewer_procs=10, n_leaf_distribution=None, n_leaves=None, n_max_per_region=[3, 5, 2], n_max_procs=250, n_max_queries=250, n_partitions_to_write=5, n_precache_procs=10, n_procs=10, n_sets=1, n_sim_events=None, n_trees=None, naive_hamming=False, naive_hamming_bounds=None, naive_swarm=False, naive_vsearch=True, name_column='unique_id', new_allele_fname=None, no_clean=False, no_indels=False, no_random_divvy=False, only_csv_plots=True, only_genes=['IGHV4-61*08', 'IGHV3-48*01', 'IGHV5-51*02', 'IGHV3-69-1*02', 'IGHV1/OR15-1*04', 'IGHV3-66*03', 'IGHV3-23D*01', 'IGHV3-71*03', 'IGHV1-2*04', 'IGHV1-2*02', 'IGHD3-16*02', 'IGHD2-2*03', 'IGHD2-8*01', 'IGHD3-22*01', 'IGHD6-13*01', 'IGHD4-17*01', 'IGHD6-19*01', 'IGHD3-10*01', 'IGHD2-15*01', 'IGHD2-21*02', 'IGHJ5*02', 'IGHJ3*02', 'IGHJ2*01', 'IGHJ1*01', 'IGHJ6*03', 'IGHJ4*02'], only_smith_waterman=None, outfname='test/_new-results/vsearch-partition-new-simu.csv', parameter_dir='test/_new-results/test/parameters/simu/hmm', parameter_type='hmm', partis_dir='/home/dralph/work/partis-dev', persistent_cachefname=None, plot_performance=False, plotdir=None, presto_output=False, print_cluster_annotations=False, print_git_commit=False, queries=None, reco_ids=None, scratch_mute_freq_dir=None, seed=1, seed_unique_id=None, seq_column='seq', seqfile=None, simulate_partially_from_scratch=None, skip_unproductive=False, slurm=False, smc_particles=1, sw_debug=0, synthetic_distance_based_partition=False, workdir='/tmp/dralph/hmms/393785')
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           250              36              0                          18              13               4               0               1             increasing mismatch score (1 --> 2) and rerunning them
            36               2              1                           0               0               0               0               1             rerunning for indels
             2               1              0                           0               0               0               0               1             increasing mismatch score (2 --> 3) and rerunning them
             1         all done
      info for 250 
        water time: 13.8
hmm
    writing input
    running 10 procs
      --> proc 1
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.8

      --> proc 2
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 2.5

      --> proc 5
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.5

      --> proc 6
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.4

      --> proc 8
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 3.9

      --> proc 0
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.3

      --> proc 3
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.2

      --> proc 4
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.2

      --> proc 7
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.5

      --> proc 9
        cachefile d.n.e.
      caching all naive sequences
        calcd:   vtb 25    fwd 0     hfrac 0           merged:  hfrac 0    lratio 0   
        time: bcrham 4.3

      time waiting for bcrham: 6.1
      hmm step time: 6.2
       naive hfrac bounds: 0.035 0.035   (0.125 mutation in test/_new-results/test/parameters/simu/hmm)
    using hfrac bound for vsearch 0.035
  stdout:
    vsearch v1.1.3_linux_x86_64, 62.8GB RAM, 16 cores
    https://github.com/torognes/vsearch
    
    
  stderr:
    Reading file /tmp/dralph/hmms/393785/simu.fasta 0%  Reading file /tmp/dralph/hmms/393785/simu.fasta 0%  Reading file /tmp/dralph/hmms/393785/simu.fasta 1%  Reading file /tmp/dralph/hmms/393785/simu.fasta 2%  Reading file /tmp/dralph/hmms/393785/simu.fasta 3%  Reading file /tmp/dralph/hmms/393785/simu.fasta 4%  Reading file /tmp/dralph/hmms/393785/simu.fasta 4%  Reading file /tmp/dralph/hmms/393785/simu.fasta 5%  Reading file /tmp/dralph/hmms/393785/simu.fasta 6%  Reading file /tmp/dralph/hmms/393785/simu.fasta 7%  Reading file /tmp/dralph/hmms/393785/simu.fasta 8%  Reading file /tmp/dralph/hmms/393785/simu.fasta 8%  Reading file /tmp/dralph/hmms/393785/simu.fasta 9%  Reading file /tmp/dralph/hmms/393785/simu.fasta 10%  Reading file /tmp/dralph/hmms/393785/simu.fasta 11%  Reading file /tmp/dralph/hmms/393785/simu.fasta 12%  Reading file /tmp/dralph/hmms/393785/simu.fasta 12%  Reading file /tmp/dralph/hmms/393785/simu.fasta 13%  Reading file /tmp/dralph/hmms/393785/simu.fasta 14%  Reading file /tmp/dralph/hmms/393785/simu.fasta 15%  Reading file /tmp/dralph/hmms/393785/simu.fasta 16%  Reading file /tmp/dralph/hmms/393785/simu.fasta 16%  Reading file /tmp/dralph/hmms/393785/simu.fasta 17%  Reading file /tmp/dralph/hmms/393785/simu.fasta 18%  Reading file /tmp/dralph/hmms/393785/simu.fasta 19%  Reading file /tmp/dralph/hmms/393785/simu.fasta 20%  Reading file /tmp/dralph/hmms/393785/simu.fasta 20%  Reading file /tmp/dralph/hmms/393785/simu.fasta 21%  Reading file /tmp/dralph/hmms/393785/simu.fasta 22%  Reading file /tmp/dralph/hmms/393785/simu.fasta 23%  Reading file /tmp/dralph/hmms/393785/simu.fasta 24%  Reading file /tmp/dralph/hmms/393785/simu.fasta 24%  Reading file /tmp/dralph/hmms/393785/simu.fasta 25%  Reading file /tmp/dralph/hmms/393785/simu.fasta 26%  Reading file /tmp/dralph/hmms/393785/simu.fasta 27%  Reading file /tmp/dralph/hmms/393785/simu.fasta 28%  Reading file /tmp/dralph/hmms/393785/simu.fasta 28%  Reading file /tmp/dralph/hmms/393785/simu.fasta 29%  Reading file /tmp/dralph/hmms/393785/simu.fasta 30%  Reading file /tmp/dralph/hmms/393785/simu.fasta 31%  Reading file /tmp/dralph/hmms/393785/simu.fasta 32%  Reading file /tmp/dralph/hmms/393785/simu.fasta 32%  Reading file /tmp/dralph/hmms/393785/simu.fasta 33%  Reading file /tmp/dralph/hmms/393785/simu.fasta 34%  Reading file /tmp/dralph/hmms/393785/simu.fasta 35%  Reading file /tmp/dralph/hmms/393785/simu.fasta 36%  Reading file /tmp/dralph/hmms/393785/simu.fasta 36%  Reading file /tmp/dralph/hmms/393785/simu.fasta 37%  Reading file /tmp/dralph/hmms/393785/simu.fasta 38%  Reading file /tmp/dralph/hmms/393785/simu.fasta 39%  Reading file /tmp/dralph/hmms/393785/simu.fasta 40%  Reading file /tmp/dralph/hmms/393785/simu.fasta 40%  Reading file /tmp/dralph/hmms/393785/simu.fasta 41%  Reading file /tmp/dralph/hmms/393785/simu.fasta 42%  Reading file /tmp/dralph/hmms/393785/simu.fasta 43%  Reading file /tmp/dralph/hmms/393785/simu.fasta 44%  Reading file /tmp/dralph/hmms/393785/simu.fasta 44%  Reading file /tmp/dralph/hmms/393785/simu.fasta 45%  Reading file /tmp/dralph/hmms/393785/simu.fasta 46%  Reading file /tmp/dralph/hmms/393785/simu.fasta 47%  Reading file /tmp/dralph/hmms/393785/simu.fasta 48%  Reading file /tmp/dralph/hmms/393785/simu.fasta 48%  Reading file /tmp/dralph/hmms/393785/simu.fasta 49%  Reading file /tmp/dralph/hmms/393785/simu.fasta 50%  Reading file /tmp/dralph/hmms/393785/simu.fasta 51%  Reading file /tmp/dralph/hmms/393785/simu.fasta 52%  Reading file /tmp/dralph/hmms/393785/simu.fasta 52%  Reading file /tmp/dralph/hmms/393785/simu.fasta 53%  Reading file /tmp/dralph/hmms/393785/simu.fasta 54%  Reading file /tmp/dralph/hmms/393785/simu.fasta 55%  Reading file /tmp/dralph/hmms/393785/simu.fasta 56%  Reading file /tmp/dralph/hmms/393785/simu.fasta 56%  Reading file /tmp/dralph/hmms/393785/simu.fasta 57%  Reading file /tmp/dralph/hmms/393785/simu.fasta 58%  Reading file /tmp/dralph/hmms/393785/simu.fasta 59%  Reading file /tmp/dralph/hmms/393785/simu.fasta 60%  Reading file /tmp/dralph/hmms/393785/simu.fasta 60%  Reading file /tmp/dralph/hmms/393785/simu.fasta 61%  Reading file /tmp/dralph/hmms/393785/simu.fasta 62%  Reading file /tmp/dralph/hmms/393785/simu.fasta 63%  Reading file /tmp/dralph/hmms/393785/simu.fasta 64%  Reading file /tmp/dralph/hmms/393785/simu.fasta 64%  Reading file /tmp/dralph/hmms/393785/simu.fasta 65%  Reading file /tmp/dralph/hmms/393785/simu.fasta 66%  Reading file /tmp/dralph/hmms/393785/simu.fasta 67%  Reading file /tmp/dralph/hmms/393785/simu.fasta 68%  Reading file /tmp/dralph/hmms/393785/simu.fasta 68%  Reading file /tmp/dralph/hmms/393785/simu.fasta 69%  Reading file /tmp/dralph/hmms/393785/simu.fasta 70%  Reading file /tmp/dralph/hmms/393785/simu.fasta 71%  Reading file /tmp/dralph/hmms/393785/simu.fasta 72%  Reading file /tmp/dralph/hmms/393785/simu.fasta 72%  Reading file /tmp/dralph/hmms/393785/simu.fasta 73%  Reading file /tmp/dralph/hmms/393785/simu.fasta 74%  Reading file /tmp/dralph/hmms/393785/simu.fasta 75%  Reading file /tmp/dralph/hmms/393785/simu.fasta 76%  Reading file /tmp/dralph/hmms/393785/simu.fasta 76%  Reading file /tmp/dralph/hmms/393785/simu.fasta 77%  Reading file /tmp/dralph/hmms/393785/simu.fasta 78%  Reading file /tmp/dralph/hmms/393785/simu.fasta 79%  Reading file /tmp/dralph/hmms/393785/simu.fasta 80%  Reading file /tmp/dralph/hmms/393785/simu.fasta 80%  Reading file /tmp/dralph/hmms/393785/simu.fasta 81%  Reading file /tmp/dralph/hmms/393785/simu.fasta 82%  Reading file /tmp/dralph/hmms/393785/simu.fasta 83%  Reading file /tmp/dralph/hmms/393785/simu.fasta 84%  Reading file /tmp/dralph/hmms/393785/simu.fasta 84%  Reading file /tmp/dralph/hmms/393785/simu.fasta 85%  Reading file /tmp/dralph/hmms/393785/simu.fasta 86%  Reading file /tmp/dralph/hmms/393785/simu.fasta 87%  Reading file /tmp/dralph/hmms/393785/simu.fasta 88%  Reading file /tmp/dralph/hmms/393785/simu.fasta 88%  Reading file /tmp/dralph/hmms/393785/simu.fasta 89%  Reading file /tmp/dralph/hmms/393785/simu.fasta 90%  Reading file /tmp/dralph/hmms/393785/simu.fasta 91%  Reading file /tmp/dralph/hmms/393785/simu.fasta 92%  Reading file /tmp/dralph/hmms/393785/simu.fasta 92%  Reading file /tmp/dralph/hmms/393785/simu.fasta 93%  Reading file /tmp/dralph/hmms/393785/simu.fasta 94%  Reading file /tmp/dralph/hmms/393785/simu.fasta 95%  Reading file /tmp/dralph/hmms/393785/simu.fasta 96%  Reading file /tmp/dralph/hmms/393785/simu.fasta 96%  Reading file /tmp/dralph/hmms/393785/simu.fasta 97%  Reading file /tmp/dralph/hmms/393785/simu.fasta 98%  Reading file /tmp/dralph/hmms/393785/simu.fasta 99%  Reading file /tmp/dralph/hmms/393785/simu.fasta 100%  Reading file /tmp/dralph/hmms/393785/simu.fasta 100%
    104000 nt in 250 seqs, min 416, max 416, avg 416
    Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 0%  Indexing sequences 1%  Indexing sequences 1%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 2%  Indexing sequences 3%  Indexing sequences 3%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 4%  Indexing sequences 5%  Indexing sequences 5%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 6%  Indexing sequences 7%  Indexing sequences 7%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 8%  Indexing sequences 9%  Indexing sequences 9%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 10%  Indexing sequences 11%  Indexing sequences 11%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 12%  Indexing sequences 13%  Indexing sequences 13%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 14%  Indexing sequences 15%  Indexing sequences 15%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 16%  Indexing sequences 17%  Indexing sequences 17%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 18%  Indexing sequences 19%  Indexing sequences 19%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 20%  Indexing sequences 21%  Indexing sequences 21%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 22%  Indexing sequences 23%  Indexing sequences 23%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 24%  Indexing sequences 25%  Indexing sequences 25%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 26%  Indexing sequences 27%  Indexing sequences 27%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 28%  Indexing sequences 29%  Indexing sequences 29%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 30%  Indexing sequences 31%  Indexing sequences 31%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 32%  Indexing sequences 33%  Indexing sequences 33%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 34%  Indexing sequences 35%  Indexing sequences 35%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 36%  Indexing sequences 37%  Indexing sequences 37%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 38%  Indexing sequences 39%  Indexing sequences 39%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 40%  Indexing sequences 41%  Indexing sequences 41%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 42%  Indexing sequences 43%  Indexing sequences 43%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 44%  Indexing sequences 45%  Indexing sequences 45%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 46%  Indexing sequences 47%  Indexing sequences 47%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 48%  Indexing sequences 49%  Indexing sequences 49%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 50%  Indexing sequences 51%  Indexing sequences 51%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 52%  Indexing sequences 53%  Indexing sequences 53%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 54%  Indexing sequences 55%  Indexing sequences 55%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 56%  Indexing sequences 57%  Indexing sequences 57%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 58%  Indexing sequences 59%  Indexing sequences 59%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 60%  Indexing sequences 61%  Indexing sequences 61%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 62%  Indexing sequences 63%  Indexing sequences 63%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 64%  Indexing sequences 65%  Indexing sequences 65%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 66%  Indexing sequences 67%  Indexing sequences 67%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 68%  Indexing sequences 69%  Indexing sequences 69%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 70%  Indexing sequences 71%  Indexing sequences 71%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 72%  Indexing sequences 73%  Indexing sequences 73%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 74%  Indexing sequences 75%  Indexing sequences 75%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 76%  Indexing sequences 77%  Indexing sequences 77%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 78%  Indexing sequences 79%  Indexing sequences 79%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 80%  Indexing sequences 81%  Indexing sequences 81%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 82%  Indexing sequences 83%  Indexing sequences 83%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 84%  Indexing sequences 85%  Indexing sequences 85%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 86%  Indexing sequences 87%  Indexing sequences 87%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 88%  Indexing sequences 89%  Indexing sequences 89%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 90%  Indexing sequences 91%  Indexing sequences 91%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 92%  Indexing sequences 93%  Indexing sequences 93%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 94%  Indexing sequences 95%  Indexing sequences 95%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 96%  Indexing sequences 97%  Indexing sequences 97%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 98%  Indexing sequences 99%  Indexing sequences 99%  Indexing sequences 100%  Indexing sequences 100%
    Masking 0%  Masking 100%
    Sorting by length 0%  Sorting by length 100%
    Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 0%  Counting unique k-mers 1%  Counting unique k-mers 1%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 2%  Counting unique k-mers 3%  Counting unique k-mers 3%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 4%  Counting unique k-mers 5%  Counting unique k-mers 5%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 6%  Counting unique k-mers 7%  Counting unique k-mers 7%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 8%  Counting unique k-mers 9%  Counting unique k-mers 9%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 10%  Counting unique k-mers 11%  Counting unique k-mers 11%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 12%  Counting unique k-mers 13%  Counting unique k-mers 13%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 14%  Counting unique k-mers 15%  Counting unique k-mers 15%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 16%  Counting unique k-mers 17%  Counting unique k-mers 17%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 18%  Counting unique k-mers 19%  Counting unique k-mers 19%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 20%  Counting unique k-mers 21%  Counting unique k-mers 21%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 22%  Counting unique k-mers 23%  Counting unique k-mers 23%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 24%  Counting unique k-mers 25%  Counting unique k-mers 25%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 26%  Counting unique k-mers 27%  Counting unique k-mers 27%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 28%  Counting unique k-mers 29%  Counting unique k-mers 29%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 30%  Counting unique k-mers 31%  Counting unique k-mers 31%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 32%  Counting unique k-mers 33%  Counting unique k-mers 33%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 34%  Counting unique k-mers 35%  Counting unique k-mers 35%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 36%  Counting unique k-mers 37%  Counting unique k-mers 37%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 38%  Counting unique k-mers 39%  Counting unique k-mers 39%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 40%  Counting unique k-mers 41%  Counting unique k-mers 41%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 42%  Counting unique k-mers 43%  Counting unique k-mers 43%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 44%  Counting unique k-mers 45%  Counting unique k-mers 45%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 46%  Counting unique k-mers 47%  Counting unique k-mers 47%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 48%  Counting unique k-mers 49%  Counting unique k-mers 49%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 50%  Counting unique k-mers 51%  Counting unique k-mers 51%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 52%  Counting unique k-mers 53%  Counting unique k-mers 53%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 54%  Counting unique k-mers 55%  Counting unique k-mers 55%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 56%  Counting unique k-mers 57%  Counting unique k-mers 57%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 58%  Counting unique k-mers 59%  Counting unique k-mers 59%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 60%  Counting unique k-mers 61%  Counting unique k-mers 61%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 62%  Counting unique k-mers 63%  Counting unique k-mers 63%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 64%  Counting unique k-mers 65%  Counting unique k-mers 65%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 66%  Counting unique k-mers 67%  Counting unique k-mers 67%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 68%  Counting unique k-mers 69%  Counting unique k-mers 69%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 70%  Counting unique k-mers 71%  Counting unique k-mers 71%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 72%  Counting unique k-mers 73%  Counting unique k-mers 73%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 74%  Counting unique k-mers 75%  Counting unique k-mers 75%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 76%  Counting unique k-mers 77%  Counting unique k-mers 77%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 78%  Counting unique k-mers 79%  Counting unique k-mers 79%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 80%  Counting unique k-mers 81%  Counting unique k-mers 81%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 82%  Counting unique k-mers 83%  Counting unique k-mers 83%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 84%  Counting unique k-mers 85%  Counting unique k-mers 85%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 86%  Counting unique k-mers 87%  Counting unique k-mers 87%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 88%  Counting unique k-mers 89%  Counting unique k-mers 89%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 90%  Counting unique k-mers 91%  Counting unique k-mers 91%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 92%  Counting unique k-mers 93%  Counting unique k-mers 93%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 94%  Counting unique k-mers 95%  Counting unique k-mers 95%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 96%  Counting unique k-mers 97%  Counting unique k-mers 97%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 98%  Counting unique k-mers 99%  Counting unique k-mers 99%  Counting unique k-mers 100%  Counting unique k-mers 100%
    Clustering 0%  Clustering 4%  Clustering 8%  Clustering 12%  Clustering 16%  Clustering 20%  Clustering 24%  Clustering 28%  Clustering 32%  Clustering 36%  Clustering 40%  Clustering 44%  Clustering 48%  Clustering 52%  Clustering 56%  Clustering 60%  Clustering 64%  Clustering 68%  Clustering 72%  Clustering 76%  Clustering 80%  Clustering 84%  Clustering 88%  Clustering 92%  Clustering 96%  Clustering 100%  Clustering 100%
    Writing clusters 0%  Writing clusters 0%  Writing clusters 0%  Writing clusters 1%  Writing clusters 1%  Writing clusters 2%  Writing clusters 2%  Writing clusters 2%  Writing clusters 3%  Writing clusters 3%  Writing clusters 4%  Writing clusters 4%  Writing clusters 4%  Writing clusters 5%  Writing clusters 5%  Writing clusters 6%  Writing clusters 6%  Writing clusters 6%  Writing clusters 7%  Writing clusters 7%  Writing clusters 8%  Writing clusters 8%  Writing clusters 8%  Writing clusters 9%  Writing clusters 9%  Writing clusters 10%  Writing clusters 10%  Writing clusters 10%  Writing clusters 11%  Writing clusters 11%  Writing clusters 12%  Writing clusters 12%  Writing clusters 12%  Writing clusters 13%  Writing clusters 13%  Writing clusters 14%  Writing clusters 14%  Writing clusters 14%  Writing clusters 15%  Writing clusters 15%  Writing clusters 16%  Writing clusters 16%  Writing clusters 16%  Writing clusters 17%  Writing clusters 17%  Writing clusters 18%  Writing clusters 18%  Writing clusters 18%  Writing clusters 19%  Writing clusters 19%  Writing clusters 20%  Writing clusters 20%  Writing clusters 20%  Writing clusters 21%  Writing clusters 21%  Writing clusters 22%  Writing clusters 22%  Writing clusters 22%  Writing clusters 23%  Writing clusters 23%  Writing clusters 24%  Writing clusters 24%  Writing clusters 24%  Writing clusters 25%  Writing clusters 25%  Writing clusters 26%  Writing clusters 26%  Writing clusters 26%  Writing clusters 27%  Writing clusters 27%  Writing clusters 28%  Writing clusters 28%  Writing clusters 28%  Writing clusters 29%  Writing clusters 29%  Writing clusters 30%  Writing clusters 30%  Writing clusters 30%  Writing clusters 31%  Writing clusters 31%  Writing clusters 32%  Writing clusters 32%  Writing clusters 32%  Writing clusters 33%  Writing clusters 33%  Writing clusters 34%  Writing clusters 34%  Writing clusters 34%  Writing clusters 35%  Writing clusters 35%  Writing clusters 36%  Writing clusters 36%  Writing clusters 36%  Writing clusters 37%  Writing clusters 37%  Writing clusters 38%  Writing clusters 38%  Writing clusters 38%  Writing clusters 39%  Writing clusters 39%  Writing clusters 40%  Writing clusters 40%  Writing clusters 40%  Writing clusters 41%  Writing clusters 41%  Writing clusters 42%  Writing clusters 42%  Writing clusters 42%  Writing clusters 43%  Writing clusters 43%  Writing clusters 44%  Writing clusters 44%  Writing clusters 44%  Writing clusters 45%  Writing clusters 45%  Writing clusters 46%  Writing clusters 46%  Writing clusters 46%  Writing clusters 47%  Writing clusters 47%  Writing clusters 48%  Writing clusters 48%  Writing clusters 48%  Writing clusters 49%  Writing clusters 49%  Writing clusters 50%  Writing clusters 50%  Writing clusters 50%  Writing clusters 51%  Writing clusters 51%  Writing clusters 52%  Writing clusters 52%  Writing clusters 52%  Writing clusters 53%  Writing clusters 53%  Writing clusters 54%  Writing clusters 54%  Writing clusters 54%  Writing clusters 55%  Writing clusters 55%  Writing clusters 56%  Writing clusters 56%  Writing clusters 56%  Writing clusters 57%  Writing clusters 57%  Writing clusters 58%  Writing clusters 58%  Writing clusters 58%  Writing clusters 59%  Writing clusters 59%  Writing clusters 60%  Writing clusters 60%  Writing clusters 60%  Writing clusters 61%  Writing clusters 61%  Writing clusters 62%  Writing clusters 62%  Writing clusters 62%  Writing clusters 63%  Writing clusters 63%  Writing clusters 64%  Writing clusters 64%  Writing clusters 64%  Writing clusters 65%  Writing clusters 65%  Writing clusters 66%  Writing clusters 66%  Writing clusters 66%  Writing clusters 67%  Writing clusters 67%  Writing clusters 68%  Writing clusters 68%  Writing clusters 68%  Writing clusters 69%  Writing clusters 69%  Writing clusters 70%  Writing clusters 70%  Writing clusters 70%  Writing clusters 71%  Writing clusters 71%  Writing clusters 72%  Writing clusters 72%  Writing clusters 72%  Writing clusters 73%  Writing clusters 73%  Writing clusters 74%  Writing clusters 74%  Writing clusters 74%  Writing clusters 75%  Writing clusters 75%  Writing clusters 76%  Writing clusters 76%  Writing clusters 76%  Writing clusters 77%  Writing clusters 77%  Writing clusters 78%  Writing clusters 78%  Writing clusters 78%  Writing clusters 79%  Writing clusters 79%  Writing clusters 80%  Writing clusters 80%  Writing clusters 80%  Writing clusters 81%  Writing clusters 81%  Writing clusters 82%  Writing clusters 82%  Writing clusters 82%  Writing clusters 83%  Writing clusters 83%  Writing clusters 84%  Writing clusters 84%  Writing clusters 84%  Writing clusters 85%  Writing clusters 85%  Writing clusters 86%  Writing clusters 86%  Writing clusters 86%  Writing clusters 87%  Writing clusters 87%  Writing clusters 88%  Writing clusters 88%  Writing clusters 88%  Writing clusters 89%  Writing clusters 89%  Writing clusters 90%  Writing clusters 90%  Writing clusters 90%  Writing clusters 91%  Writing clusters 91%  Writing clusters 92%  Writing clusters 92%  Writing clusters 92%  Writing clusters 93%  Writing clusters 93%  Writing clusters 94%  Writing clusters 94%  Writing clusters 94%  Writing clusters 95%  Writing clusters 95%  Writing clusters 96%  Writing clusters 96%  Writing clusters 96%  Writing clusters 97%  Writing clusters 97%  Writing clusters 98%  Writing clusters 98%  Writing clusters 98%  Writing clusters 99%  Writing clusters 99%  Writing clusters 100%  Writing clusters 100%
    Clusters: 79 Size min 1, max 15, avg 3.2
    Singletons: 35, 14.0% of seqs, 44.3% of clusters
    
      vsearch/swarm time: 1.0
      total time: 21.2
