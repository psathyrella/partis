TEST              annotate-ref-simu   ./bin/partis.py --action run-viterbi --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --plotdir test/_new-results/test/plots/ref-simu-performance --plot-performance --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --outfname test/_new-results/annotate-ref-simu.csv
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/72491/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
       1001          541           0                      481           50           10            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/72491/germline-sets
        541            5           2                        0            3            0            0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/72491/germline-sets
    skipping performance evaluation of 845981336331804829 because of indels
    skipping performance evaluation of 3918988671315713566 because of indels
          5            3           0                        0            3            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/72491/germline-sets
          3         all done
  v_gene
    correct up to allele:  968 / 999  = 0.9690 (-0.963, +0.973)
  d_gene
    correct up to allele:  829 / 999  = 0.8298 (-0.818, +0.841)
  j_gene
    correct up to allele:  884 / 999  = 0.8849 (-0.874, +0.894)
      info for 1001 
hmm
    writing input
    running
      hmm run time: 19.117
    time to merge csv files: 0.021
    read output
    skipping performance evaluation of 845981336331804829 because of indels
    skipping performance evaluation of 3918988671315713566 because of indels
  v_gene
    correct up to allele:  977 / 999  = 0.9780 (-0.972, +0.982)
  d_gene
    correct up to allele:  842 / 999  = 0.8428 (-0.831, +0.853)
  j_gene
    correct up to allele:  926 / 999  = 0.9269 (-0.918, +0.934)
    processed 1001 sequences (1001 events)
      5 boundary errors
      total time: 61.870
TEST             partition-ref-simu   ./bin/partis.py --action partition --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --persistent-cachefname test/_new-results/hmm_cached_info.csv --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --outfname test/_new-results/partition-ref-simu.csv
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/66735/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
        250          135           0                      124           11            0            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/66735/germline-sets
        135            1           0                        0            1            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/66735/germline-sets
          1         all done
      info for 250 
        water time: 10.329
hmm
    writing input
      caching all naive sequences
    running
      --> proc 2
        cachefile d.n.e.
        calculated   vtb 83    fwd 83   hamming merged 0    naive hfracs 0

      --> proc 0
        cachefile d.n.e.
        calculated   vtb 84    fwd 84   hamming merged 0    naive hfracs 0

      --> proc 1
        cachefile d.n.e.
        calculated   vtb 83    fwd 83   hamming merged 0    naive hfracs 0

      hmm run time: 27.056
    time to merge csv files: 0.031
--> 250 clusters with 10 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
      --> proc 6
        read 250 cached logprobs and 250 naive seqs
        stopping after drop -9424.03 --> -9443.35
        time 1.57777
        calculated   vtb 1    fwd 2   hamming merged 2    naive hfracs 300

      --> proc 1
        read 250 cached logprobs and 250 naive seqs
        stopping after drop -8814.06 --> -8854.11
        time 3.4695
        calculated   vtb 2    fwd 12   hamming merged 2    naive hfracs 323

      --> proc 3
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 228   small lratios: 3   total: 231
        time 3.74005
        calculated   vtb 2    fwd 6   hamming merged 3    naive hfracs 343

      --> proc 8
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 248   small lratios: 5   total: 253
        time 3.32165
        calculated   vtb 1    fwd 8   hamming merged 2    naive hfracs 322

      --> proc 9
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 206   small lratios: 4   total: 210
        time 4.19752
        calculated   vtb 4    fwd 8   hamming merged 2    naive hfracs 386

      --> proc 0
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 222   small lratios: 9   total: 231
        time 5.59932
        calculated   vtb 3    fwd 14   hamming merged 1    naive hfracs 366

      --> proc 5
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 185   small lratios: 5   total: 190
        time 5.34247
        calculated   vtb 4    fwd 10   hamming merged 2    naive hfracs 382

      --> proc 7
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 225   small lratios: 6   total: 231
        time 4.97079
        calculated   vtb 3    fwd 9   hamming merged 1    naive hfracs 366

      --> proc 2
        read 250 cached logprobs and 250 naive seqs
        stopping after drop -7957.78 --> -7983.04
        time 6.80626
        calculated   vtb 3    fwd 21   hamming merged 3    naive hfracs 345

      --> proc 4
        read 250 cached logprobs and 250 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 219   small lratios: 12   total: 231
        time 6.74385
        calculated   vtb 1    fwd 25   hamming merged 3    naive hfracs 321

      hmm run time: 8.088
    time to merge csv files: 0.015
  merged path 0 with 31 glomeration steps and 220 final clusters
        read cached glomeration time: 0.020
      partition step time: 8.904
--> 227 clusters with 7 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
      --> proc 1
        read 365 cached logprobs and 280 naive seqs
        stopping after drop -13282.8 --> -13331.9
        time 1.32301
        calculated   vtb 2    fwd 2   hamming merged 2    naive hfracs 559

      --> proc 5
        read 365 cached logprobs and 280 naive seqs
        stopping after drop -11993 --> -12014.1
        time 2.27436
        calculated   vtb 1    fwd 6   hamming merged 4    naive hfracs 496

      --> proc 4
        read 365 cached logprobs and 280 naive seqs
        stopping after drop -12395.7 --> -12421
        time 3.0419
        calculated   vtb 1    fwd 9   hamming merged 3    naive hfracs 496

      --> proc 0
        read 365 cached logprobs and 280 naive seqs
        stopping after drop -12718.3 --> -12759.3
        time 4.11841
        calculated   vtb 2    fwd 13   hamming merged 4    naive hfracs 557

      --> proc 2
        read 365 cached logprobs and 280 naive seqs
        stopping after drop -14821.8 --> -14859.6
        time 5.51975
        calculated   vtb 4    fwd 10   hamming merged 7    naive hfracs 609

      --> proc 6
        read 365 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 291   small lratios: 9   total: 300
        time 6.60116
        calculated   vtb 5    fwd 23   hamming merged 3    naive hfracs 626

      --> proc 3
        read 365 cached logprobs and 280 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 360   small lratios: 18   total: 378
        time 10.7968
        calculated   vtb 3    fwd 35   hamming merged 3    naive hfracs 580

      hmm run time: 12.070
    time to merge csv files: 0.016
  merged path 0 with 32 glomeration steps and 196 final clusters
        read cached glomeration time: 0.015
      partition step time: 12.504
--> 201 clusters with 5 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
      --> proc 0
        read 463 cached logprobs and 311 naive seqs
        stopping after drop -19991 --> -20047.6
        time 2.2713
        calculated   vtb 2    fwd 2   hamming merged 2    naive hfracs 859

      --> proc 4
        read 463 cached logprobs and 311 naive seqs
        stopping after drop -18606.8 --> -18667.1
        time 3.18372
        calculated   vtb 1    fwd 7   hamming merged 3    naive hfracs 780

      --> proc 1
        read 463 cached logprobs and 311 naive seqs
        stopping after drop -17478.7 --> -17490.5
        time 5.11479
        calculated   vtb 1    fwd 15   hamming merged 4    naive hfracs 780

      --> proc 2
        read 463 cached logprobs and 311 naive seqs
        stopping after drop -16541.8 --> -16585.5
        time 6.93918
        calculated   vtb 2    fwd 22   hamming merged 3    naive hfracs 817

      --> proc 3
        read 463 cached logprobs and 311 naive seqs
        stop for some reason or other with -inf: 0   ham skip: 482   small lratios: 14   total: 496
        time 8.00936
        calculated   vtb 6    fwd 24   hamming merged 5    naive hfracs 981

      hmm run time: 10.051
    time to merge csv files: 0.027
  merged path 0 with 21 glomeration steps and 181 final clusters
        read cached glomeration time: 0.009
      partition step time: 10.552
--> 186 clusters with 3 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
      --> proc 0
        read 533 cached logprobs and 331 naive seqs
        stopping after drop -30808.2 --> -30898.3
        time 5.69143
        calculated   vtb 1    fwd 16   hamming merged 6    naive hfracs 1891

      --> proc 2
        read 533 cached logprobs and 331 naive seqs
        stopping after drop -28023.4 --> -28064.9
        time 8.93962
        calculated   vtb 2    fwd 24   hamming merged 4    naive hfracs 1949

      --> proc 1
        read 533 cached logprobs and 331 naive seqs
        stopping after drop -29564.2 --> -29586.8
        time 12.5919
        calculated   vtb 8    fwd 31   hamming merged 8    naive hfracs 2262

      hmm run time: 14.044
    time to merge csv files: 0.019
  merged path 0 with 23 glomeration steps and 164 final clusters
        read cached glomeration time: 0.012
      partition step time: 14.518
--> 168 clusters with 2 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
      --> proc 1
        read 604 cached logprobs and 353 naive seqs
        stopping after drop -43154.5 --> -43170.5
        time 4.14893
        calculated   vtb 4    fwd 6   hamming merged 6    naive hfracs 3723

      --> proc 0
        read 604 cached logprobs and 353 naive seqs
        stopping after drop -44999.9 --> -45095.2
        time 5.85944
        calculated   vtb 3    fwd 14   hamming merged 6    naive hfracs 3643

      hmm run time: 7.024
    time to merge csv files: 0.012
  merged path 0 with 13 glomeration steps and 156 final clusters
        read cached glomeration time: 0.003
      partition step time: 7.450
--> 160 clusters with 1 procs
hmm
    writing input
       naive hamming bounds: 0.010 0.061
    running
        read 624 cached logprobs and 365 naive seqs
        stopping after drop -87718.2 --> -87826.4
        time 7.67061
        calculated   vtb 3    fwd 22   hamming merged 14    naive hfracs 13013
â€˜test/_new-results/hmm_cached_info.csv.tmpâ€™ -> â€˜test/_new-results/hmm_cached_info.csvâ€™
      hmm run time: 7.823
  merged path 0 with 15 glomeration steps and 146 final clusters
        read cached glomeration time: 0.012
      partition step time: 8.435
final
               logprob   delta   clusters  n_procs  adj mi  ccf under  over 
              -88178.36             160       1      0.565      0.73  0.92      o:o  o:o  o  o  o  o:o  o:o  o  o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o  o  o:o  o  o:o  o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -88145.33   33.0      159       1      0.573      0.74  0.92      o:o:o  o:o  o  o  o  o:o  o:o  o  o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o  o  o:o  o  o:o  o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -88122.62   22.7      158       1      0.586      0.74  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o  o  o:o  o  o:o  o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -88056.67   66.0      157       1      0.594      0.75  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o  o  o:o  o  o:o  o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -88028.42   28.3      156       1      0.602      0.75  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87989.63   38.8      155       1      0.608      0.76  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o  o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87965.91   23.7      154       1      0.614      0.76  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87937.39   28.5      153       1      0.619      0.76  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87905.95   31.4      152       1      0.625      0.77  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87849.06   56.9      151       1      0.631      0.77  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87817.31   31.8      150       1      0.636      0.78  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o:o  o  o  o  o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87792.27   25.0      149       1      0.642      0.78  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o:o  o  o  o  o:o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87754.44   37.8      148       1      0.648      0.79  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o:o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o:o  o  o  o  o:o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
      [93mbest* [0m  -87718.20   36.2      147       1      0.657      0.80  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  o:o  o:o  o:o  o  o  o  [91mo:o:o:o:o:o[0m  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o:o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o:o  o  o  o  o:o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 
              -87826.40   -108.2    146       1      0.657      0.80  0.92      o:o:o  o:o  o  o  o  o:o:o:o:o  o:o  o  o:o:o  o:o:o:o  o:o:o  o  o:o  o  [91mo:o[0m  o  o:o  o  o:o:o:o:o  o  o:o:o:o  o:o  o:o:o  o  o:o  o  o:o  o:o  o  o  o:o  o  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  o  o:o:o:o  o  o  o  o:o  o  o  o:o  o:o:o  o:o  o:o  o  o  o  o  o:o  o  o  o  o:o  o:o  [91mo:o:o[0m  o  o  o:o:o  o  o:o  o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o:o:o:o  o:o:o:o  o:o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o:o  o:o:o  o  o  o  o:o  o  o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o:o  o  o  o  o  o  o  o  o  o:o  o  o  o  o:o  o  o:o:o  o  o:o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o  o 

    time to merge csv files: 0.074
      total time: 102.945
TEST       point-partition-ref-simu   ./bin/partis.py --action partition --naive-hamming --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --outfname test/_new-results/point-partition-ref-simu.csv
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/74389/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
        250          135           0                      124           11            0            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/74389/germline-sets
        135            1           0                        0            1            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/74389/germline-sets
          1         all done
      info for 250 
        water time: 13.443
hmm
    writing input
      caching all naive sequences
    running
      --> proc 2
        cachefile d.n.e.
        calculated   vtb 83    fwd 0   hamming merged 0    naive hfracs 0

      --> proc 0
        cachefile d.n.e.
        calculated   vtb 84    fwd 0   hamming merged 0    naive hfracs 0

      --> proc 1
        cachefile d.n.e.
        calculated   vtb 83    fwd 0   hamming merged 0    naive hfracs 0

      hmm run time: 16.043
    time to merge csv files: 0.021
--> 250 clusters with 10 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
      --> proc 6
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0319175
        time 1.40368
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 343

      --> proc 8
        read 0 cached logprobs and 250 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0319175
        time 1.14609
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 343

      --> proc 1
        read 0 cached logprobs and 250 naive seqs
        stop with all 171 / 171 hamming distances greater than 0.0319175
        time 2.17339
        calculated   vtb 6    fwd 0   hamming merged 6    naive hfracs 423

      --> proc 2
        read 0 cached logprobs and 250 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0319175
        time 2.27768
        calculated   vtb 4    fwd 0   hamming merged 4    naive hfracs 386

      --> proc 3
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0319175
        time 2.33136
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 382

      --> proc 4
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0319175
        time 2.11825
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 395

      --> proc 5
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0319175
        time 2.4656
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 382

      --> proc 7
        read 0 cached logprobs and 250 naive seqs
        stop with all 190 / 190 hamming distances greater than 0.0319175
        time 2.83919
        calculated   vtb 5    fwd 0   hamming merged 5    naive hfracs 405

      --> proc 9
        read 0 cached logprobs and 250 naive seqs
        stop with all 171 / 171 hamming distances greater than 0.0319175
        time 2.75285
        calculated   vtb 6    fwd 0   hamming merged 6    naive hfracs 423

      --> proc 0
        read 0 cached logprobs and 250 naive seqs
        stop with all 153 / 153 hamming distances greater than 0.0319175
        time 3.02467
        calculated   vtb 7    fwd 0   hamming merged 7    naive hfracs 440

      hmm run time: 5.092
    time to merge csv files: 0.017
  merged path 0 with 52 glomeration steps and 199 final clusters
        read cached glomeration time: 0.022
      partition step time: 5.882
--> 199 clusters with 7 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
      --> proc 4
        read 0 cached logprobs and 301 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0319175
        time 0.902344
        calculated   vtb 2    fwd 0   hamming merged 2    naive hfracs 429

      --> proc 5
        read 0 cached logprobs and 301 naive seqs
        stop with all 300 / 300 hamming distances greater than 0.0319175
        time 0.958742
        calculated   vtb 2    fwd 0   hamming merged 3    naive hfracs 427

      --> proc 6
        read 0 cached logprobs and 301 naive seqs
        stop with all 325 / 325 hamming distances greater than 0.0319175
        time 0.508703
        calculated   vtb 2    fwd 0   hamming merged 2    naive hfracs 429

      --> proc 0
        read 0 cached logprobs and 301 naive seqs
        stop with all 276 / 276 hamming distances greater than 0.0319175
        time 1.77201
        calculated   vtb 3    fwd 0   hamming merged 5    naive hfracs 478

      --> proc 3
        read 0 cached logprobs and 301 naive seqs
        stop with all 210 / 210 hamming distances greater than 0.0319175
        time 1.73629
        calculated   vtb 4    fwd 0   hamming merged 7    naive hfracs 464

      --> proc 1
        read 0 cached logprobs and 301 naive seqs
        stop with all 300 / 300 hamming distances greater than 0.0319175
        time 2.40276
        calculated   vtb 3    fwd 0   hamming merged 4    naive hfracs 481

      --> proc 2
        read 0 cached logprobs and 301 naive seqs
        stop with all 231 / 231 hamming distances greater than 0.0319175
        time 2.63998
        calculated   vtb 6    fwd 0   hamming merged 7    naive hfracs 547

      hmm run time: 4.058
    time to merge csv files: 0.021
  merged path 0 with 31 glomeration steps and 169 final clusters
        read cached glomeration time: 0.016
      partition step time: 4.804
--> 169 clusters with 5 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
      --> proc 3
        read 0 cached logprobs and 331 naive seqs
        stop with all 465 / 465 hamming distances greater than 0.0319175
        time 0.894062
        calculated   vtb 1    fwd 0   hamming merged 3    naive hfracs 591

      --> proc 0
        read 0 cached logprobs and 331 naive seqs
        stop with all 406 / 406 hamming distances greater than 0.0319175
        time 1.81946
        calculated   vtb 3    fwd 0   hamming merged 5    naive hfracs 648

      --> proc 2
        read 0 cached logprobs and 331 naive seqs
        stop with all 528 / 528 hamming distances greater than 0.0319175
        time 1.00057
        calculated   vtb 1    fwd 0   hamming merged 1    naive hfracs 593

      --> proc 1
        read 0 cached logprobs and 331 naive seqs
        stop with all 435 / 435 hamming distances greater than 0.0319175
        time 2.53075
        calculated   vtb 4    fwd 0   hamming merged 4    naive hfracs 683

      --> proc 4
        read 0 cached logprobs and 331 naive seqs
        stop with all 406 / 406 hamming distances greater than 0.0319175
        time 2.11509
        calculated   vtb 4    fwd 0   hamming merged 4    naive hfracs 646

      hmm run time: 4.055
    time to merge csv files: 0.012
  merged path 0 with 18 glomeration steps and 152 final clusters
        read cached glomeration time: 0.004
      partition step time: 4.680
--> 152 clusters with 3 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
      --> proc 0
        read 0 cached logprobs and 348 naive seqs
        stop with all 946 / 946 hamming distances greater than 0.0319175
        time 1.71811
        calculated   vtb 3    fwd 0   hamming merged 7    naive hfracs 1407

      --> proc 1
        read 0 cached logprobs and 348 naive seqs
        stop with all 1035 / 1035 hamming distances greater than 0.0319175
        time 1.96741
        calculated   vtb 4    fwd 0   hamming merged 5    naive hfracs 1461

      --> proc 2
        read 0 cached logprobs and 348 naive seqs
        stop with all 861 / 861 hamming distances greater than 0.0319175
        time 3.19389
        calculated   vtb 5    fwd 0   hamming merged 8    naive hfracs 1440

      hmm run time: 5.028
    time to merge csv files: 0.016
  merged path 0 with 21 glomeration steps and 132 final clusters
        read cached glomeration time: 0.008
      partition step time: 5.349
--> 132 clusters with 2 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
      --> proc 1
        read 0 cached logprobs and 368 naive seqs
        stop with all 1711 / 1711 hamming distances greater than 0.0319175
        time 2.99831
        calculated   vtb 5    fwd 0   hamming merged 7    naive hfracs 2445

      --> proc 0
        read 0 cached logprobs and 368 naive seqs
        stop with all 1485 / 1485 hamming distances greater than 0.0319175
        time 4.75841
        calculated   vtb 7    fwd 0   hamming merged 11    naive hfracs 2544

      hmm run time: 6.023
    time to merge csv files: 0.023
  merged path 0 with 19 glomeration steps and 114 final clusters
        read cached glomeration time: 0.006
      partition step time: 6.632
--> 114 clusters with 1 procs
hmm
    writing input
       naive hamming bounds: 0.032 0.032
    running
        read 0 cached logprobs and 386 naive seqs
        stop with all 4465 / 4465 hamming distances greater than 0.0319175
        time 4.98583
        calculated   vtb 12    fwd 0   hamming merged 19    naive hfracs 7635
      hmm run time: 5.099
  merged path 0 with 20 glomeration steps and 95 final clusters
        read cached glomeration time: 0.007
      partition step time: 5.441
final
               logprob   delta   clusters  n_procs  adj mi  ccf under  over 
              -inf                  114       1      0.582      0.81  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o  [91mo:o:o:o[0m  o  o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o  o:o:o:o:o:o:o:o  o:o  o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o  o:o  o  o:o:o  o:o  o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       113       1      0.588      0.82  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o  o:o:o:o:o:o:o:o  o:o  o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       112       1      0.591      0.83  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o  o:o:o:o:o:o:o:o  o:o  o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o  o:o  o  o:o  o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       111       1      0.594      0.84  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       110       1      0.595      0.85  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       109       1      0.597      0.86  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       108       1      0.599      0.86  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       107       1      0.601      0.87  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       106       1      0.603      0.88  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       105       1      0.583      0.88  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o  o:o  o  o  o  o  o  o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       104       1      0.586      0.89  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o:o:o  o:o  o  o  o  o  o  o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o  o  o  o  o  o  o  o  o  o  o 
              -inf        nan       103       1      0.588      0.90  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o:o:o  o:o  o  o  o  o  o  o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o  o 
              -inf        nan       102       1      0.591      0.91  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o:o:o  o:o  o  o  o  o  o  o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       101       1      0.593      0.92  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o:o:o  o:o  o  o  o  o  o  o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       100       1      0.595      0.92  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  o:o  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  [91mo:o:o[0m  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       99        1      0.597      0.93  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  [91mo:o:o:o:o[0m  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o  o:o  o  o  o  o  o  o:o  o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o  o:o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       98        1      0.599      0.94  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  [91mo:o:o:o:o[0m  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o  o:o  o  o  o  o  o  o:o  o:o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o:o  o:o  o  o  o  o  o  o:o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       97        1      0.601      0.95  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  [91mo:o:o:o:o[0m  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o:o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o  o:o  o  o  o  o  o  o:o  o:o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o:o  o:o  o  o  o  o  o  o  o:o:o:o  o  o  o  o  o  o  o  o 
              -inf        nan       96        1      0.603      0.95  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  [91mo:o:o:o:o[0m  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o  o:o  o  o  [91mo:o[0m  o  o  o:o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o:o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o  o:o  o  o  o  o  o:o  o:o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o:o  o:o  o  o  o  o  o  o  o:o:o:o  o  o  o  o  o  o  o  o 
      [93mbest* [0m  -inf        nan       95        1      0.605      0.95  0.66      [91mo:o:o:o[0m  o:o:o:o:o:o:o:o:o:o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o  o:o:o:o:o:o:o  [91mo:o:o:o[0m  o:o:o  o:o:o  o:o:o:o  o:o:o  o  [91mo:o:o:o:o:o[0m  o  o:o  o  o:o:o:o:o  o:o:o:o:o:o:o:o  [91mo:o:o:o:o[0m  o:o  o  [91mo:o:o:o:o:o:o:o:o:o:o:o:o:o:o[0m  o  o:o  o:o  [91mo:o[0m  o:o  o:o:o  o  o  [91mo:o:o:o:o:o:o:o[0m  o:o:o  o:o  o  o  [91mo:o[0m  o  o  o:o  o  o:o:o  o  o:o  o  o  o:o:o:o  o  o  o  o:o  o  o  o:o:o  o:o  o:o  o:o  o:o:o  o:o:o  o:o:o  o:o  o  o  o  o  o:o  o:o:o  o:o  o:o  o:o:o:o:o  o  o  o:o  o  o  o:o:o  o:o  o  o  o  o:o  o:o  o  o  o  o  o  o  o:o:o:o  o  o  o  o  o  o  o 

      total time: 66.264
TEST     vsearch-partition-ref-simu   ./bin/partis.py --action partition --naive-vsearch --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --n-max-queries 250 --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --outfname test/_new-results/vsearch-partition-ref-simu.csv
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/75417/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
        250          135           0                      124           11            0            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/75417/germline-sets
        135            1           0                        0            1            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/75417/germline-sets
          1         all done
      info for 250 
        water time: 10.377
hmm
    writing input
      caching all naive sequences
    running
      --> proc 2
        cachefile d.n.e.
        calculated   vtb 83    fwd 83   hamming merged 0    naive hfracs 0

      --> proc 0
        cachefile d.n.e.
        calculated   vtb 84    fwd 84   hamming merged 0    naive hfracs 0

      --> proc 1
        cachefile d.n.e.
        calculated   vtb 83    fwd 83   hamming merged 0    naive hfracs 0

vsearch v1.1.3_linux_x86_64, 62.8GB RAM, 16 cores
https://github.com/torognes/vsearch

      hmm run time: 28.056
    time to merge csv files: 0.019
      vsearch/swarm time: 2.024
      total time: 41.633
TEST          cache-data-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results --action cache-data-parameters --extra-args __skip-unproductive:__seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02 --datafname test/mishmash.csv
RUN ./bin/partis.py --action cache-parameters --seqfile test/mishmash.csv --is-data --skip-unproductive --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --parameter-dir test/_new-results/test/parameters/data --plotdir test/_new-results/test/plots/data
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/26056/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
       2359          743           0                      169          544           30            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/26056/germline-sets
        743          483         478                        0            5            0            0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/26056/germline-sets
        483            6           0                        0            6            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/26056/germline-sets
          6            2           0                        0            2            0            0             increasing mismatch score (3 --> 4) and rerunning them
      info for 2165      (skipped 192 / 2359 = 0.081 unproductive    2 / 2359 = 0.001 unknown ) 
   [91mwarning[0m 2 missing annotations
    writing parameters
  plotting parameters
  writing hmms with info from test/_new-results/test/parameters/data/sw
hmm
    writing input
    running
      hmm run time: 44.137
    time to merge csv files: 0.019
    read output
    writing parameters
  plotting parameters
    processed 2165 sequences (2165 events)
      3 boundary errors
  writing hmms with info from test/_new-results/test/parameters/data/hmm
      total time: 200.689
TEST                       simulate   ./bin/run-driver.py --label test --stashdir test/_new-results --action simulate --extra-args __n-sim-events:500:__n-leaves:2:__mimic-data-read-length:__seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02
RUN ./bin/partis.py --action simulate --outfname test/_new-results/test/simu.csv --n-sim-events 500 --n-leaves 2 --mimic-data-read-length --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --parameter-dir test/_new-results/test/parameters/data/hmm
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
simulating
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
WARNING under/overflows in Hist::normalize()
TEST          cache-simu-parameters   ./bin/run-driver.py --label test --stashdir test/_new-results --action cache-simu-parameters --extra-args __seed:1:__n-procs:10:__only-genes:IGHV4-61*08,IGHV3-48*01,IGHV5-51*02,IGHV3-69-1*02,IGHV1/OR15-1*04,IGHV3-66*03,IGHV3-23D*01,IGHV3-71*03,IGHV1-2*04,IGHV1-2*02,IGHD3-16*02,IGHD2-2*03,IGHD2-8*01,IGHD3-22*01,IGHD6-13*01,IGHD4-17*01,IGHD6-19*01,IGHD3-10*01,IGHD2-15*01,IGHD2-21*02,IGHJ5*02,IGHJ3*02,IGHJ2*01,IGHJ1*01,IGHJ6*03,IGHJ4*02
RUN ./bin/partis.py --action cache-parameters --seqfile test/_new-results/test/simu.csv --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --parameter-dir test/_new-results/test/parameters/simu --plotdir test/_new-results/test/plots/simu
TODO combine self.germlines, aligned v genes, and the conserved codon info
TODO figure out how to make distinction between line and line_with_effective_erosions
use utils.synthesize_single_seq_line() everywhere possible
smith-waterman
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/84269/germline-sets
      processed   remaining  new-indels       rerun: unproductive   no-match   weird-annot.   failed-apport.
       1001          580           0                      509           56           15            0             increasing mismatch score (1 --> 2) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/84269/germline-sets
        580            3           2                        0            1            0            0             rerunning for indels
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/84269/germline-sets
          3            1           0                        0            1            0            0             increasing mismatch score (2 --> 3) and rerunning them
rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/84269/germline-sets
          1         all done
      info for 1001 
    writing parameters
    writing parameters
  plotting parameters
  plotting parameters
  writing hmms with info from test/_new-results/test/parameters/simu/sw
hmm
    writing input
    running
      hmm run time: 19.127
    time to merge csv files: 0.029
    read output
    writing parameters
  plotting parameters
    writing parameters
  plotting parameters
    processed 1001 sequences (1001 events)
  writing hmms with info from test/_new-results/test/parameters/simu/hmm
      total time: 295.185
